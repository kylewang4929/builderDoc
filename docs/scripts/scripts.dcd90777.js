"use strict";!function(a,b,c){function d(){e=b[h](function(){f.each(function(){var b=a(this),c=b.width(),d=b.height(),e=a.data(this,j);(c!==e.w||d!==e.h)&&b.trigger(i,[e.w=c,e.h=d])}),d()},g[k])}var e,f=a([]),g=a.resize=a.extend(a.resize,{}),h="setTimeout",i="resize",j=i+"-special-event",k="delay",l="throttleWindow";g[k]=250,g[l]=!0,a.event.special[i]={setup:function(){if(!g[l]&&this[h])return!1;var b=a(this);f=f.add(b),a.data(this,j,{w:b.width(),h:b.height()}),1===f.length&&d()},teardown:function(){if(!g[l]&&this[h])return!1;var b=a(this);f=f.not(b),b.removeData(j),f.length||clearTimeout(e)},add:function(b){function d(b,d,f){var g=a(this),h=a.data(this,j);h.w=d!==c?d:g.width(),h.h=f!==c?f:g.height(),e.apply(this,arguments)}if(!g[l]&&this[h])return!1;var e;return a.isFunction(b)?(e=b,d):(e=b.handler,void(b.handler=d))}}}(jQuery,this),function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.Quill=a()}}(function(){var a;return function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};a[g][0].call(k.exports,function(b){var c=a[g][1][b];return e(c?c:b)},k,k.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(b,c,d){(function(b){(function(){function e(a,b,c){for(var d=a.length,e=c?d:-1;c?e--:++e<d;)if(b(a[e],e,a))return e;return-1}function f(a,b,c){if(b!==b)return i(a,c);for(var d=c-1,e=a.length;++d<e;)if(a[d]===b)return d;return-1}function g(a){return"function"==typeof a||!1}function h(a){return"string"==typeof a?a:null==a?"":a+""}function i(a,b,c){for(var d=a.length,e=b+(c?0:-1);c?e--:++e<d;){var f=a[e];if(f!==f)return e}return-1}function j(a){return!!a&&"object"==typeof a}function k(a,b){for(var c=-1,d=a.length,e=-1,f=[];++c<d;)a[c]===b&&(a[c]=zb,f[++e]=c);return f}function l(){}function m(){}function n(a){this.__wrapped__=a,this.__actions__=null,this.__dir__=1,this.__dropCount__=0,this.__filtered__=!1,this.__iteratees__=null,this.__takeCount__=Jc,this.__views__=null}function o(a){var b=a?a.length:0;for(this.data={hash:Dc(null),set:new zc};b--;)this.push(a[b])}function p(a,b){var c=a.data,d="string"==typeof b||Xa(b)?c.set.has(b):c.hash[b];return d?0:-1}function q(a){var b=this.data;"string"==typeof a||Xa(a)?b.set.add(a):b.hash[a]=!0}function r(a,b){var c=-1,d=a.length;for(b||(b=Array(d));++c<d;)b[c]=a[c];return b}function s(a,b){for(var c=-1,d=a.length;++c<d&&b(a[c],c,a)!==!1;);return a}function t(a,b){for(var c=-1,d=a.length;++c<d;)if(!b(a[c],c,a))return!1;return!0}function u(a,b){for(var c=-1,d=a.length,e=Array(d);++c<d;)e[c]=b(a[c],c,a);return e}function v(a,b,c,d){var e=-1,f=a.length;for(d&&f&&(c=a[++e]);++e<f;)c=b(c,a[e],e,a);return c}function w(a,b){for(var c=-1,d=a.length;++c<d;)if(b(a[c],c,a))return!0;return!1}function x(a,b){return a===lb?b:a}function y(a,b,c){for(var d=-1,e=od(b),f=e.length;++d<f;){var g=e[d],h=a[g],i=c(h,b[g],g,a,b);(i===i?i===h:h!==h)&&(h!==lb||g in a)||(a[g]=i)}return a}function z(a,b){return null==b?a:A(b,od(b),a)}function A(a,b,c){c||(c={});for(var d=-1,e=b.length;++d<e;){var f=b[d];c[f]=a[f]}return c}function B(a,b,c){var d=typeof a;return"function"==d?b===lb?a:Y(a,b,c):null==a?gb:"object"==d?P(a):b===lb?jb(a):Q(a,b)}function C(a,b,c,d,e,f,g){var h;if(c&&(h=e?c(a,d,e):c(a)),h!==lb)return h;if(!Xa(a))return a;var i=jd(a);if(i){if(h=va(a),!b)return r(a,h)}else{var j=tc.call(a),k=j==Fb;if(j!=Ib&&j!=Ab&&(!k||e))return fc[j]?xa(a,j,b):e?a:{};if(h=wa(k?{}:a),!b)return z(h,a)}f||(f=[]),g||(g=[]);for(var l=f.length;l--;)if(f[l]==a)return g[l];return f.push(a),g.push(h),(i?s:J)(a,function(d,e){h[e]=C(d,b,c,e,a,f,g)}),h}function D(a,b,c){if("function"!=typeof a)throw new TypeError(yb);return setTimeout(function(){a.apply(lb,c)},b)}function E(a,b){var c=a?a.length:0,d=[];if(!c)return d;var e=-1,g=sa(),h=g==f,i=h&&b.length>=200?Wc(b):null,j=b.length;i&&(g=p,h=!1,b=i);a:for(;++e<c;){var k=a[e];if(h&&k===k){for(var l=j;l--;)if(b[l]===k)continue a;d.push(k)}else g(b,k,0)<0&&d.push(k)}return d}function F(a,b){var c=!0;return Tc(a,function(a,d,e){return c=!!b(a,d,e)}),c}function G(a,b,c,d){var e;return c(a,function(a,c,f){return b(a,c,f)?(e=d?c:a,!1):void 0}),e}function H(a,b,c){for(var d=-1,e=a.length,f=-1,g=[];++d<e;){var h=a[d];if(j(h)&&za(h)&&(c||jd(h)||Ua(h))){b&&(h=H(h,b,c));for(var i=-1,k=h.length;++i<k;)g[++f]=h[i]}else c||(g[++f]=h)}return g}function I(a,b){return Uc(a,b,ab)}function J(a,b){return Uc(a,b,od)}function K(a,b,c){if(null!=a){c!==lb&&c in Ma(a)&&(b=[c]);for(var d=0,e=b.length;null!=a&&e>d;)a=a[b[d++]];return d&&d==e?a:lb}}function L(a,b,c,d,e,f){return a===b?!0:null==a||null==b||!Xa(a)&&!j(b)?a!==a&&b!==b:M(a,b,L,c,d,e,f)}function M(a,b,c,d,e,f,g){var h=jd(a),i=jd(b),j=Bb,k=Bb;h||(j=tc.call(a),j==Ab?j=Ib:j!=Ib&&(h=_a(a))),i||(k=tc.call(b),k==Ab?k=Ib:k!=Ib&&(i=_a(b)));var l=j==Ib,m=k==Ib,n=j==k;if(n&&!h&&!l)return oa(a,b,j);if(!e){var o=l&&rc.call(a,"__wrapped__"),p=m&&rc.call(b,"__wrapped__");if(o||p)return c(o?a.value():a,p?b.value():b,d,e,f,g)}if(!n)return!1;f||(f=[]),g||(g=[]);for(var q=f.length;q--;)if(f[q]==a)return g[q]==b;f.push(a),g.push(b);var r=(h?na:pa)(a,b,c,d,e,f,g);return f.pop(),g.pop(),r}function N(a,b,c){var d=b.length,e=d,f=!c;if(null==a)return!e;for(a=Ma(a);d--;){var g=b[d];if(f&&g[2]?g[1]!==a[g[0]]:!(g[0]in a))return!1}for(;++d<e;){g=b[d];var h=g[0],i=a[h],j=g[1];if(f&&g[2]){if(i===lb&&!(h in a))return!1}else{var k=c?c(i,j,h):lb;if(!(k===lb?L(j,i,c,!0):k))return!1}}return!0}function O(a,b){var c=-1,d=za(a)?Array(a.length):[];return Tc(a,function(a,e,f){d[++c]=b(a,e,f)}),d}function P(a){var b=ta(a);if(1==b.length&&b[0][2]){var c=b[0][0],d=b[0][1];return function(a){return null==a?!1:a[c]===d&&(d!==lb||c in Ma(a))}}return function(a){return N(a,b)}}function Q(a,b){var c=jd(a),d=Ca(a)&&Fa(b),e=a+"";return a=Na(a),function(f){if(null==f)return!1;var g=e;if(f=Ma(f),(c||!d)&&!(g in f)){if(f=1==a.length?f:K(f,U(a,0,-1)),null==f)return!1;g=Pa(a),f=Ma(f)}return f[g]===b?b!==lb||g in f:L(b,f[g],lb,!0)}}function R(a){return function(b){return null==b?lb:b[a]}}function S(a){var b=a+"";return a=Na(a),function(c){return K(c,a,b)}}function T(a,b,c,d,e){return e(a,function(a,e,f){c=d?(d=!1,a):b(c,a,e,f)}),c}function U(a,b,c){var d=-1,e=a.length;b=null==b?0:+b||0,0>b&&(b=-b>e?0:e+b),c=c===lb||c>e?e:+c||0,0>c&&(c+=e),e=b>c?0:c-b>>>0,b>>>=0;for(var f=Array(e);++d<e;)f[d]=a[d+b];return f}function V(a,b){for(var c=-1,d=b.length,e=Array(d);++c<d;)e[c]=a[b[c]];return e}function W(a,b,c){var d=0,e=a?a.length:d;if("number"==typeof b&&b===b&&Mc>=e){for(;e>d;){var f=d+e>>>1,g=a[f];(c?b>=g:b>g)&&null!==g?d=f+1:e=f}return e}return X(a,b,gb,c)}function X(a,b,c,d){b=c(b);for(var e=0,f=a?a.length:0,g=b!==b,h=null===b,i=b===lb;f>e;){var j=xc((e+f)/2),k=c(a[j]),l=k!==lb,m=k===k;if(g)var n=m||d;else n=h?m&&l&&(d||null!=k):i?m&&(d||l):null==k?!1:d?b>=k:b>k;n?e=j+1:f=j}return Hc(f,Lc)}function Y(a,b,c){if("function"!=typeof a)return gb;if(b===lb)return a;switch(c){case 1:return function(c){return a.call(b,c)};case 3:return function(c,d,e){return a.call(b,c,d,e)};case 4:return function(c,d,e,f){return a.call(b,c,d,e,f)};case 5:return function(c,d,e,f,g){return a.call(b,c,d,e,f,g)}}return function(){return a.apply(b,arguments)}}function Z(a){return wc.call(a,0)}function $(a,b,c){for(var d=c.length,e=-1,f=Gc(a.length-d,0),g=-1,h=b.length,i=Array(f+h);++g<h;)i[g]=b[g];for(;++e<d;)i[c[e]]=a[e];for(;f--;)i[g++]=a[e++];return i}function _(a,b,c){for(var d=-1,e=c.length,f=-1,g=Gc(a.length-e,0),h=-1,i=b.length,j=Array(g+i);++f<g;)j[f]=a[f];for(var k=f;++h<i;)j[k+h]=b[h];for(;++d<e;)j[k+c[d]]=a[f++];return j}function aa(a,b){return function(c,d,e){var f=b?b():{};if(d=qa(d,e,3),jd(c))for(var g=-1,h=c.length;++g<h;){var i=c[g];a(f,i,d(i,g,c),c)}else Tc(c,function(b,c,e){a(f,b,d(b,c,e),e)});return f}}function ba(a){return Sa(function(b,c){var d=-1,e=null==b?0:c.length,f=e>2?c[e-2]:lb,g=e>2?c[2]:lb,h=e>1?c[e-1]:lb;for("function"==typeof f?(f=Y(f,h,5),e-=2):(f="function"==typeof h?h:lb,e-=f?1:0),g&&Ba(c[0],c[1],g)&&(f=3>e?lb:f,e=1);++d<e;){var i=c[d];i&&a(b,i,f)}return b})}function ca(a,b){return function(c,d){var e=c?Yc(c):0;if(!Ea(e))return a(c,d);for(var f=b?e:-1,g=Ma(c);(b?f--:++f<e)&&d(g[f],f,g)!==!1;);return c}}function da(a){return function(b,c,d){for(var e=Ma(b),f=d(b),g=f.length,h=a?g:-1;a?h--:++h<g;){var i=f[h];if(c(e[i],i,e)===!1)break}return b}}function ea(a,b){function c(){var e=this&&this!==nc&&this instanceof c?d:a;return e.apply(b,arguments)}var d=fa(a);return c}function fa(a){return function(){var b=arguments;switch(b.length){case 0:return new a;case 1:return new a(b[0]);case 2:return new a(b[0],b[1]);case 3:return new a(b[0],b[1],b[2]);case 4:return new a(b[0],b[1],b[2],b[3]);case 5:return new a(b[0],b[1],b[2],b[3],b[4])}var c=Sc(a.prototype),d=a.apply(c,b);return Xa(d)?d:c}}function ga(a,b){return function(c,d,f){if(d=qa(d,f,3),jd(c)){var g=e(c,d,b);return g>-1?c[g]:lb}return G(c,d,a)}}function ha(a,b){return function(c,d,e){return"function"==typeof d&&e===lb&&jd(c)?a(c,d):b(c,Y(d,e,3))}}function ia(a){var b=Sa(function(c,d){var e=k(d,b.placeholder);return ma(c,a,null,d,e)});return b}function ja(a,b){return function(c,d,e,f){var g=arguments.length<3;return"function"==typeof d&&f===lb&&jd(c)?a(c,d,e,g):T(c,qa(d,f,4),e,g,b)}}function ka(a,b,c,d,e,f,g,h,i,j){function l(){for(var u=arguments.length,v=u,w=Array(u);v--;)w[v]=arguments[v];if(d&&(w=$(w,d,e)),f&&(w=_(w,f,g)),p||s){var x=l.placeholder,y=k(w,x);if(u-=y.length,j>u){var z=h?r(h):null,A=Gc(j-u,0),B=p?y:null,C=p?null:y,D=p?w:null,E=p?null:w;b|=p?sb:tb,b&=~(p?tb:sb),q||(b&=~(nb|ob));var F=[a,b,c,D,B,E,C,z,i,A],G=ka.apply(lb,F);return Da(a)&&Zc(G,F),G.placeholder=x,G}}var H=n?c:this,I=o?H[a]:a;return h&&(w=Ja(w,h)),m&&i<w.length&&(w.length=i),this&&this!==nc&&this instanceof l&&(I=t||fa(a)),I.apply(H,w)}var m=b&ub,n=b&nb,o=b&ob,p=b&qb,q=b&pb,s=b&rb,t=o?null:fa(a);return l}function la(a,b,c,d){function e(){for(var b=-1,h=arguments.length,i=-1,j=d.length,k=Array(h+j);++i<j;)k[i]=d[i];for(;h--;)k[i++]=arguments[++b];var l=this&&this!==nc&&this instanceof e?g:a;return l.apply(f?c:this,k)}var f=b&nb,g=fa(a);return e}function ma(a,b,c,d,e,f,g,h){var i=b&ob;if(!i&&"function"!=typeof a)throw new TypeError(yb);var j=d?d.length:0;if(j||(b&=~(sb|tb),d=e=null),j-=e?e.length:0,b&tb){var k=d,l=e;d=e=null}var m=i?null:Xc(a),n=[a,b,c,d,e,k,l,f,g,h];if(m&&(Ga(n,m),b=n[1],h=n[9]),n[9]=null==h?i?0:a.length:Gc(h-j,0)||0,b==nb)var o=ea(n[0],n[2]);else o=b!=sb&&b!=(nb|sb)||n[4].length?ka.apply(lb,n):la.apply(lb,n);var p=m?Vc:Zc;return p(o,n)}function na(a,b,c,d,e,f,g){var h=-1,i=a.length,j=b.length;if(i!=j&&!(e&&j>i))return!1;for(;++h<i;){var k=a[h],l=b[h],m=d?d(e?l:k,e?k:l,h):lb;if(m!==lb){if(m)continue;return!1}if(e){if(!w(b,function(a){return k===a||c(k,a,d,e,f,g)}))return!1}else if(k!==l&&!c(k,l,d,e,f,g))return!1}return!0}function oa(a,b,c){switch(c){case Cb:case Db:return+a==+b;case Eb:return a.name==b.name&&a.message==b.message;case Hb:return a!=+a?b!=+b:a==+b;case Jb:case Lb:return a==b+""}return!1}function pa(a,b,c,d,e,f,g){var h=od(a),i=h.length,j=od(b),k=j.length;if(i!=k&&!e)return!1;for(var l=i;l--;){var m=h[l];if(!(e?m in b:rc.call(b,m)))return!1}for(var n=e;++l<i;){m=h[l];var o=a[m],p=b[m],q=d?d(e?p:o,e?o:p,m):lb;if(!(q===lb?c(o,p,d,e,f,g):q))return!1;n||(n="constructor"==m)}if(!n){var r=a.constructor,s=b.constructor;if(r!=s&&"constructor"in a&&"constructor"in b&&!("function"==typeof r&&r instanceof r&&"function"==typeof s&&s instanceof s))return!1}return!0}function qa(a,b,c){var d=l.callback||eb;return d=d===eb?B:d,c?d(a,b,c):d}function ra(a){for(var b=a.name,c=Qc[b],d=c?c.length:0;d--;){var e=c[d],f=e.func;if(null==f||f==a)return e.name}return b}function sa(a,b,c){var d=l.indexOf||Oa;return d=d===Oa?f:d,a?d(a,b,c):d}function ta(a){for(var b=bb(a),c=b.length;c--;)b[c][2]=Fa(b[c][1]);return b}function ua(a,b){var c=null==a?lb:a[b];return Ya(c)?c:lb}function va(a){var b=a.length,c=new a.constructor(b);return b&&"string"==typeof a[0]&&rc.call(a,"index")&&(c.index=a.index,c.input=a.input),c}function wa(a){var b=a.constructor;return"function"==typeof b&&b instanceof b||(b=Object),new b}function xa(a,b,c){var d=a.constructor;switch(b){case Nb:return Z(a);case Cb:case Db:return new d(+a);case Ob:case Pb:case Qb:case Rb:case Sb:case Tb:case Ub:case Vb:case Wb:var e=a.buffer;return new d(c?Z(e):e,a.byteOffset,a.length);case Hb:case Lb:return new d(a);case Jb:var f=new d(a.source,bc.exec(a));f.lastIndex=a.lastIndex}return f}function ya(a,b,c){null==a||Ca(b,a)||(b=Na(b),a=1==b.length?a:K(a,U(b,0,-1)),b=Pa(b));var d=null==a?a:a[b];return null==d?lb:d.apply(a,c)}function za(a){return null!=a&&Ea(Yc(a))}function Aa(a,b){return a="number"==typeof a||dc.test(a)?+a:-1,b=null==b?Oc:b,a>-1&&a%1==0&&b>a}function Ba(a,b,c){if(!Xa(c))return!1;var d=typeof b;if("number"==d?za(c)&&Aa(b,c.length):"string"==d&&b in c){var e=c[b];return a===a?a===e:e!==e}return!1}function Ca(a,b){var c=typeof a;if("string"==c&&Yb.test(a)||"number"==c)return!0;if(jd(a))return!1;var d=!Xb.test(a);return d||null!=b&&a in Ma(b)}function Da(a){var b=ra(a);if(!(b in n.prototype))return!1;var c=l[b];if(a===c)return!0;var d=Xc(c);return!!d&&a===d[0]}function Ea(a){return"number"==typeof a&&a>-1&&a%1==0&&Oc>=a}function Fa(a){return a===a&&!Xa(a)}function Ga(a,b){var c=a[1],d=b[1],e=c|d,f=ub>e,g=d==ub&&c==qb||d==ub&&c==vb&&a[7].length<=b[8]||d==(ub|vb)&&c==qb;if(!f&&!g)return a;d&nb&&(a[2]=b[2],e|=c&nb?0:pb);var h=b[3];if(h){var i=a[3];a[3]=i?$(i,h,b[4]):r(h),a[4]=i?k(a[3],zb):r(b[4])}return h=b[5],h&&(i=a[5],a[5]=i?_(i,h,b[6]):r(h),a[6]=i?k(a[5],zb):r(b[6])),h=b[7],h&&(a[7]=r(h)),d&ub&&(a[8]=null==a[8]?b[8]:Hc(a[8],b[8])),null==a[9]&&(a[9]=b[9]),a[0]=b[0],a[1]=e,a}function Ha(a,b){a=Ma(a);for(var c=-1,d=b.length,e={};++c<d;){var f=b[c];f in a&&(e[f]=a[f])}return e}function Ia(a,b){var c={};return I(a,function(a,d,e){b(a,d,e)&&(c[d]=a)}),c}function Ja(a,b){for(var c=a.length,d=Hc(b.length,c),e=r(a);d--;){var f=b[d];a[d]=Aa(f,c)?e[f]:lb}return a}function Ka(a){var b;l.support;if(!j(a)||tc.call(a)!=Ib||!rc.call(a,"constructor")&&(b=a.constructor,"function"==typeof b&&!(b instanceof b)))return!1;var c;return I(a,function(a,b){c=b}),c===lb||rc.call(a,c)}function La(a){for(var b=ab(a),c=b.length,d=c&&a.length,e=!!d&&Ea(d)&&(jd(a)||Ua(a)),f=-1,g=[];++f<c;){var h=b[f];(e&&Aa(h,d)||rc.call(a,h))&&g.push(h)}return g}function Ma(a){return Xa(a)?a:Object(a)}function Na(a){if(jd(a))return a;var b=[];return h(a).replace(Zb,function(a,c,d,e){b.push(d?e.replace(ac,"$1"):c||a)}),b}function Oa(a,b,c){var d=a?a.length:0;if(!d)return-1;if("number"==typeof c)c=0>c?Gc(d+c,0):c;else if(c){var e=W(a,b),g=a[e];return(b===b?b===g:g!==g)?e:-1}return f(a,b,c||0)}function Pa(a){var b=a?a.length:0;return b?a[b-1]:lb}function Qa(a,b,c){var d=jd(a)?t:F;return c&&Ba(a,b,c)&&(b=null),("function"!=typeof b||c!==lb)&&(b=qa(b,c,3)),d(a,b)}function Ra(a,b,c){var d=jd(a)?u:O;return b=qa(b,c,3),d(a,b)}function Sa(a,b){if("function"!=typeof a)throw new TypeError(yb);return b=Gc(b===lb?a.length-1:+b||0,0),function(){for(var c=arguments,d=-1,e=Gc(c.length-b,0),f=Array(e);++d<e;)f[d]=c[b+d];switch(b){case 0:return a.call(this,f);case 1:return a.call(this,c[0],f);case 2:return a.call(this,c[0],c[1],f)}var g=Array(b+1);for(d=-1;++d<b;)g[d]=c[d];return g[b]=f,a.apply(this,g)}}function Ta(a,b,c,d){return b&&"boolean"!=typeof b&&Ba(a,b,c)?b=!1:"function"==typeof b&&(d=c,c=b,b=!1),"function"==typeof c?C(a,b,Y(c,d,1)):C(a,b)}function Ua(a){return j(a)&&za(a)&&tc.call(a)==Ab}function Va(a){return!!a&&1===a.nodeType&&j(a)&&tc.call(a).indexOf("Element")>-1}function Wa(a,b,c,d){c="function"==typeof c?Y(c,d,3):lb;var e=c?c(a,b):lb;return e===lb?L(a,b,c):!!e}function Xa(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}function Ya(a){return null==a?!1:tc.call(a)==Fb?uc.test(qc.call(a)):j(a)&&cc.test(a)}function Za(a){return"number"==typeof a||j(a)&&tc.call(a)==Hb}function $a(a){return"string"==typeof a||j(a)&&tc.call(a)==Lb}function _a(a){return j(a)&&Ea(a.length)&&!!ec[tc.call(a)]}function ab(a){if(null==a)return[];Xa(a)||(a=Object(a));var b=a.length;b=b&&Ea(b)&&(jd(a)||Ua(a))&&b||0;for(var c=a.constructor,d=-1,e="function"==typeof c&&c.prototype===a,f=Array(b),g=b>0;++d<b;)f[d]=d+"";for(var h in a)g&&Aa(h,b)||"constructor"==h&&(e||!rc.call(a,h))||f.push(h);return f}function bb(a){a=Ma(a);for(var b=-1,c=od(a),d=c.length,e=Array(d);++b<d;){var f=c[b];e[b]=[f,a[f]]}return e}function cb(a){return V(a,od(a))}function db(a){return a=h(a),a&&_b.test(a)?a.replace($b,"\\$&"):a}function eb(a,b,c){return c&&Ba(a,b,c)&&(b=null),j(a)?hb(a):B(a,b)}function fb(a){return function(){return a}}function gb(a){return a}function hb(a){return P(C(a,!0))}function ib(){}function jb(a){return Ca(a)?R(a):S(a)}function kb(a){var b=++sc;return h(a)+b}var lb,mb="3.9.3",nb=1,ob=2,pb=4,qb=8,rb=16,sb=32,tb=64,ub=128,vb=256,wb=150,xb=16,yb="Expected a function",zb="__lodash_placeholder__",Ab="[object Arguments]",Bb="[object Array]",Cb="[object Boolean]",Db="[object Date]",Eb="[object Error]",Fb="[object Function]",Gb="[object Map]",Hb="[object Number]",Ib="[object Object]",Jb="[object RegExp]",Kb="[object Set]",Lb="[object String]",Mb="[object WeakMap]",Nb="[object ArrayBuffer]",Ob="[object Float32Array]",Pb="[object Float64Array]",Qb="[object Int8Array]",Rb="[object Int16Array]",Sb="[object Int32Array]",Tb="[object Uint8Array]",Ub="[object Uint8ClampedArray]",Vb="[object Uint16Array]",Wb="[object Uint32Array]",Xb=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,Yb=/^\w*$/,Zb=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,$b=/[.*+?^${}()|[\]\/\\]/g,_b=RegExp($b.source),ac=/\\(\\)?/g,bc=/\w*$/,cc=/^\[object .+?Constructor\]$/,dc=/^\d+$/,ec={};ec[Ob]=ec[Pb]=ec[Qb]=ec[Rb]=ec[Sb]=ec[Tb]=ec[Ub]=ec[Vb]=ec[Wb]=!0,ec[Ab]=ec[Bb]=ec[Nb]=ec[Cb]=ec[Db]=ec[Eb]=ec[Fb]=ec[Gb]=ec[Hb]=ec[Ib]=ec[Jb]=ec[Kb]=ec[Lb]=ec[Mb]=!1;var fc={};fc[Ab]=fc[Bb]=fc[Nb]=fc[Cb]=fc[Db]=fc[Ob]=fc[Pb]=fc[Qb]=fc[Rb]=fc[Sb]=fc[Hb]=fc[Ib]=fc[Jb]=fc[Lb]=fc[Tb]=fc[Ub]=fc[Vb]=fc[Wb]=!0,fc[Eb]=fc[Fb]=fc[Gb]=fc[Kb]=fc[Mb]=!1;var gc={"function":!0,object:!0},hc=gc[typeof d]&&d&&!d.nodeType&&d,ic=gc[typeof c]&&c&&!c.nodeType&&c,jc=hc&&ic&&"object"==typeof b&&b&&b.Object&&b,kc=gc[typeof self]&&self&&self.Object&&self,lc=gc[typeof window]&&window&&window.Object&&window,mc=ic&&ic.exports===hc&&hc,nc=jc||lc!==(this&&this.window)&&lc||kc||this,oc=Object.prototype,pc=(pc=nc.window)?pc.document:null,qc=Function.prototype.toString,rc=oc.hasOwnProperty,sc=0,tc=oc.toString,uc=RegExp("^"+db(qc.call(rc)).replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),vc=ua(nc,"ArrayBuffer"),wc=ua(vc&&new vc(0),"slice"),xc=Math.floor,yc=ua(Object,"getPrototypeOf"),zc=ua(nc,"Set"),Ac=ua(nc,"Uint8Array"),Bc=ua(nc,"WeakMap"),Cc=function(){try{var a=ua(nc,"Float64Array"),b=new a(new vc(10),0,1)&&a}catch(c){}return b||null}(),Dc=ua(Object,"create"),Ec=ua(Array,"isArray"),Fc=ua(Object,"keys"),Gc=Math.max,Hc=Math.min,Ic=ua(Date,"now"),Jc=Number.POSITIVE_INFINITY,Kc=4294967295,Lc=Kc-1,Mc=Kc>>>1,Nc=Cc?Cc.BYTES_PER_ELEMENT:0,Oc=9007199254740991,Pc=Bc&&new Bc,Qc={},Rc=l.support={};!function(a){var b=function(){this.x=a},c=[];b.prototype={valueOf:a,y:a};for(var d in new b)c.push(d);try{Rc.dom=11===pc.createDocumentFragment().nodeType}catch(e){Rc.dom=!1}}(1,0);var Sc=function(){function a(){}return function(b){if(Xa(b)){a.prototype=b;var c=new a;a.prototype=null}return c||{}}}(),Tc=ca(J),Uc=da(),Vc=Pc?function(a,b){return Pc.set(a,b),a}:gb;wc||(Z=vc&&Ac?function(a){var b=a.byteLength,c=Cc?xc(b/Nc):0,d=c*Nc,e=new vc(b);if(c){var f=new Cc(e,0,c);f.set(new Cc(a,0,c))}return b!=d&&(f=new Ac(e,d),f.set(new Ac(a,d))),e}:fb(null));var Wc=Dc&&zc?function(a){return new o(a)}:fb(null),Xc=Pc?function(a){return Pc.get(a)}:ib,Yc=R("length"),Zc=function(){var a=0,b=0;return function(c,d){var e=fd(),f=xb-(e-b);if(b=e,f>0){if(++a>=wb)return c}else a=0;return Vc(c,d)}}(),$c=Sa(function(a,b){return za(a)?E(a,H(b,!1,!0)):[]}),_c=Sa(function(a){for(var b=a.length,c=b,d=Array(l),e=sa(),g=e==f,h=[];c--;){var i=a[c]=za(i=a[c])?i:[];d[c]=g&&i.length>=120?Wc(c&&i):null}var j=a[0],k=-1,l=j?j.length:0,m=d[0];a:for(;++k<l;)if(i=j[k],(m?p(m,i):e(h,i,0))<0){for(var c=b;--c;){var n=d[c];if((n?p(n,i):e(a[c],i,0))<0)continue a}m&&m.push(i),h.push(i)}return h}),ad=ga(Tc),bd=ha(s,Tc),cd=Sa(function(a,b,c){var d=-1,e="function"==typeof b,f=Ca(b),g=za(a)?Array(a.length):[];return Tc(a,function(a){var h=e?b:f&&null!=a?a[b]:null;g[++d]=h?h.apply(a,c):ya(a,b,c)}),g}),dd=aa(function(a,b,c){a[c?0:1].push(b)},function(){return[[],[]]}),ed=ja(v,Tc),fd=Ic||function(){return(new Date).getTime()},gd=Sa(function(a,b,c){var d=nb;if(c.length){var e=k(c,gd.placeholder);d|=sb}return ma(a,d,b,c,e)}),hd=Sa(function(a,b){return D(a,1,b)}),id=ia(sb),jd=Ec||function(a){return j(a)&&Ea(a.length)&&tc.call(a)==Bb};Rc.dom||(Va=function(a){return!!a&&1===a.nodeType&&j(a)&&!ld(a)});var kd=g(/x/)||Ac&&!g(Ac)?function(a){return tc.call(a)==Fb}:g,ld=yc?function(a){if(!a||tc.call(a)!=Ib)return!1;var b=ua(a,"valueOf"),c=b&&(c=yc(b))&&yc(c);return c?a==c||yc(a)==c:Ka(a)}:Ka,md=ba(function(a,b,c){return c?y(a,b,c):z(a,b)}),nd=Sa(function(a){var b=a[0];return null==b?b:(a.push(x),md.apply(lb,a))}),od=Fc?function(a){var b=null==a?null:a.constructor;return"function"==typeof b&&b.prototype===a||"function"!=typeof a&&za(a)?La(a):Xa(a)?Fc(a):[]}:La,pd=Sa(function(a,b){if(null==a)return{};if("function"!=typeof b[0]){var b=u(H(b),String);return Ha(a,E(ab(a),b))}var c=Y(b[0],b[1],3);return Ia(a,function(a,b,d){return!c(a,b,d)})});n.prototype=Sc(m.prototype),n.prototype.constructor=n,o.prototype.push=q,l.assign=md,l.bind=gd,l.callback=eb,l.constant=fb,l.defaults=nd,l.defer=hd,l.difference=$c,l.forEach=bd,l.intersection=_c,l.invoke=cd,l.keys=od,l.keysIn=ab,l.map=Ra,l.matches=hb,l.omit=pd,l.pairs=bb,l.partial=id,l.partition=dd,l.property=jb,l.restParam=Sa,l.values=cb,l.collect=Ra,l.each=bd,l.extend=md,l.iteratee=eb,l.clone=Ta,l.escapeRegExp=db,l.every=Qa,l.find=ad,l.identity=gb,l.indexOf=Oa,l.isArguments=Ua,l.isArray=jd,l.isElement=Va,l.isEqual=Wa,l.isFunction=kd,l.isNative=Ya,l.isNumber=Za,l.isObject=Xa,l.isPlainObject=ld,l.isString=$a,l.isTypedArray=_a,l.last=Pa,l.noop=ib,l.now=fd,l.reduce=ed,l.uniqueId=kb,l.all=Qa,l.eq=Wa,l.detect=ad,l.foldl=ed,l.inject=ed,l.VERSION=mb,s(["bind","partial"],function(a){l[a].placeholder=l}),"function"==typeof a&&"object"==typeof a.amd&&a.amd?(nc._=l,a(function(){return l})):hc&&ic?mc?(ic.exports=l)._=l:hc._=l:nc._=l}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(b,c,d){!function(b){function c(){this._events={},this._conf&&e.call(this,this._conf)}function e(a){a&&(this._conf=a,a.delimiter&&(this.delimiter=a.delimiter),a.maxListeners&&(this._events.maxListeners=a.maxListeners),a.wildcard&&(this.wildcard=a.wildcard),a.newListener&&(this.newListener=a.newListener),this.wildcard&&(this.listenerTree={}))}function f(a){this._events={},this.newListener=!1,e.call(this,a)}function g(a,b,c,d){if(!c)return[];var e,f,h,i,j,k,l,m=[],n=b.length,o=b[d],p=b[d+1];if(d===n&&c._listeners){if("function"==typeof c._listeners)return a&&a.push(c._listeners),[c];for(e=0,f=c._listeners.length;f>e;e++)a&&a.push(c._listeners[e]);return[c]}if("*"===o||"**"===o||c[o]){if("*"===o){for(h in c)"_listeners"!==h&&c.hasOwnProperty(h)&&(m=m.concat(g(a,b,c[h],d+1)));return m}if("**"===o){l=d+1===n||d+2===n&&"*"===p,l&&c._listeners&&(m=m.concat(g(a,b,c,n)));for(h in c)"_listeners"!==h&&c.hasOwnProperty(h)&&("*"===h||"**"===h?(c[h]._listeners&&!l&&(m=m.concat(g(a,b,c[h],n))),m=m.concat(g(a,b,c[h],d))):m=h===p?m.concat(g(a,b,c[h],d+2)):m.concat(g(a,b,c[h],d)));return m}m=m.concat(g(a,b,c[o],d+1))}if(i=c["*"],i&&g(a,b,i,d+1),j=c["**"])if(n>d){j._listeners&&g(a,b,j,n);for(h in j)"_listeners"!==h&&j.hasOwnProperty(h)&&(h===p?g(a,b,j[h],d+2):h===o?g(a,b,j[h],d+1):(k={},k[h]=j[h],g(a,b,{"**":k},d+1)))}else j._listeners?g(a,b,j,n):j["*"]&&j["*"]._listeners&&g(a,b,j["*"],n);return m}function h(a,b){a="string"==typeof a?a.split(this.delimiter):a.slice();for(var c=0,d=a.length;d>c+1;c++)if("**"===a[c]&&"**"===a[c+1])return;for(var e=this.listenerTree,f=a.shift();f;){if(e[f]||(e[f]={}),e=e[f],0===a.length){if(e._listeners){if("function"==typeof e._listeners)e._listeners=[e._listeners,b];else if(i(e._listeners)&&(e._listeners.push(b),!e._listeners.warned)){var g=j;"undefined"!=typeof this._events.maxListeners&&(g=this._events.maxListeners),g>0&&e._listeners.length>g&&(e._listeners.warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",e._listeners.length),console.trace())}}else e._listeners=b;return!0}f=a.shift()}return!0}var i=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)},j=10;f.prototype.delimiter=".",f.prototype.setMaxListeners=function(a){this._events||c.call(this),this._events.maxListeners=a,this._conf||(this._conf={}),this._conf.maxListeners=a},f.prototype.event="",f.prototype.once=function(a,b){return this.many(a,1,b),this},f.prototype.many=function(a,b,c){function d(){0===--b&&e.off(a,d),c.apply(this,arguments)}var e=this;if("function"!=typeof c)throw new Error("many only accepts instances of Function");return d._origin=c,this.on(a,d),e},f.prototype.emit=function(){this._events||c.call(this);var a=arguments[0];if("newListener"===a&&!this.newListener&&!this._events.newListener)return!1;if(this._all){for(var b=arguments.length,d=new Array(b-1),e=1;b>e;e++)d[e-1]=arguments[e];for(e=0,b=this._all.length;b>e;e++)this.event=a,this._all[e].apply(this,d)}if("error"===a&&!(this._all||this._events.error||this.wildcard&&this.listenerTree.error))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");var f;if(this.wildcard){f=[];var h="string"==typeof a?a.split(this.delimiter):a.slice();g.call(this,f,h,this.listenerTree,0)}else f=this._events[a];if("function"==typeof f){if(this.event=a,1===arguments.length)f.call(this);else if(arguments.length>1)switch(arguments.length){case 2:f.call(this,arguments[1]);break;case 3:f.call(this,arguments[1],arguments[2]);break;default:for(var b=arguments.length,d=new Array(b-1),e=1;b>e;e++)d[e-1]=arguments[e];f.apply(this,d)}return!0}if(f){for(var b=arguments.length,d=new Array(b-1),e=1;b>e;e++)d[e-1]=arguments[e];for(var i=f.slice(),e=0,b=i.length;b>e;e++)this.event=a,i[e].apply(this,d);return i.length>0||!!this._all}return!!this._all},f.prototype.on=function(a,b){if("function"==typeof a)return this.onAny(a),this;if("function"!=typeof b)throw new Error("on only accepts instances of Function");if(this._events||c.call(this),this.emit("newListener",a,b),this.wildcard)return h.call(this,a,b),this;if(this._events[a]){if("function"==typeof this._events[a])this._events[a]=[this._events[a],b];else if(i(this._events[a])&&(this._events[a].push(b),!this._events[a].warned)){var d=j;"undefined"!=typeof this._events.maxListeners&&(d=this._events.maxListeners),d>0&&this._events[a].length>d&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),console.trace())}}else this._events[a]=b;return this},f.prototype.onAny=function(a){if("function"!=typeof a)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),this._all.push(a),this},f.prototype.addListener=f.prototype.on,f.prototype.off=function(a,b){if("function"!=typeof b)throw new Error("removeListener only takes instances of Function");var c,d=[];if(this.wildcard){var e="string"==typeof a?a.split(this.delimiter):a.slice();d=g.call(this,null,e,this.listenerTree,0)}else{if(!this._events[a])return this;c=this._events[a],d.push({_listeners:c})}for(var f=0;f<d.length;f++){var h=d[f];if(c=h._listeners,i(c)){for(var j=-1,k=0,l=c.length;l>k;k++)if(c[k]===b||c[k].listener&&c[k].listener===b||c[k]._origin&&c[k]._origin===b){j=k;break}if(0>j)continue;return this.wildcard?h._listeners.splice(j,1):this._events[a].splice(j,1),0===c.length&&(this.wildcard?delete h._listeners:delete this._events[a]),this}(c===b||c.listener&&c.listener===b||c._origin&&c._origin===b)&&(this.wildcard?delete h._listeners:delete this._events[a])}return this},f.prototype.offAny=function(a){var b,c=0,d=0;if(a&&this._all&&this._all.length>0){for(b=this._all,c=0,d=b.length;d>c;c++)if(a===b[c])return b.splice(c,1),this}else this._all=[];return this},f.prototype.removeListener=f.prototype.off,f.prototype.removeAllListeners=function(a){if(0===arguments.length)return!this._events||c.call(this),this;if(this.wildcard)for(var b="string"==typeof a?a.split(this.delimiter):a.slice(),d=g.call(this,null,b,this.listenerTree,0),e=0;e<d.length;e++){var f=d[e];f._listeners=null}else{if(!this._events[a])return this;this._events[a]=null}return this},f.prototype.listeners=function(a){if(this.wildcard){var b=[],d="string"==typeof a?a.split(this.delimiter):a.slice();return g.call(this,b,d,this.listenerTree,0),b}return this._events||c.call(this),this._events[a]||(this._events[a]=[]),i(this._events[a])||(this._events[a]=[this._events[a]]),this._events[a]},f.prototype.listenersAny=function(){return this._all?this._all:[]},"function"==typeof a&&a.amd?a(function(){return f}):"object"==typeof d?d.EventEmitter2=f:window.EventEmitter2=f}()},{}],3:[function(a,b,c){var d=a("fast-diff"),e=a("./is"),f=a("./op"),g=String.fromCharCode(0),h=function(a){e.array(a)?this.ops=a:e.object(a)&&e.array(a.ops)?this.ops=a.ops:this.ops=[]};h.prototype.insert=function(a,b){var c={};return 0===a.length?this:(c.insert=a,e.object(b)&&Object.keys(b).length>0&&(c.attributes=b),this.push(c))},h.prototype["delete"]=function(a){return 0>=a?this:this.push({"delete":a})},h.prototype.retain=function(a,b){if(0>=a)return this;var c={retain:a};return e.object(b)&&Object.keys(b).length>0&&(c.attributes=b),this.push(c)},h.prototype.push=function(a){var b=this.ops.length,c=this.ops[b-1];if(a=f.clone(a),e.object(c)){if(e.number(a["delete"])&&e.number(c["delete"]))return this.ops[b-1]={"delete":c["delete"]+a["delete"]},this;if(e.number(c["delete"])&&null!=a.insert&&(b-=1,c=this.ops[b-1],!e.object(c)))return this.ops.unshift(a),this;if(e.equal(a.attributes,c.attributes)){if(e.string(a.insert)&&e.string(c.insert))return this.ops[b-1]={insert:c.insert+a.insert},e.object(a.attributes)&&(this.ops[b-1].attributes=a.attributes),this;if(e.number(a.retain)&&e.number(c.retain))return this.ops[b-1]={retain:c.retain+a.retain},e.object(a.attributes)&&(this.ops[b-1].attributes=a.attributes),this}}return b===this.ops.length?this.ops.push(a):this.ops.splice(b,0,a),this},h.prototype.chop=function(){var a=this.ops[this.ops.length-1];return a&&a.retain&&!a.attributes&&this.ops.pop(),this},h.prototype.length=function(){return this.ops.reduce(function(a,b){return a+f.length(b)},0)},h.prototype.slice=function(a,b){a=a||0,e.number(b)||(b=1/0);for(var c=new h,d=f.iterator(this.ops),g=0;b>g&&d.hasNext();){var i;a>g?i=d.next(a-g):(i=d.next(b-g),c.push(i)),g+=f.length(i)}return c},h.prototype.compose=function(a){for(var b=f.iterator(this.ops),c=f.iterator(a.ops),d=new h;b.hasNext()||c.hasNext();)if("insert"===c.peekType())d.push(c.next());else if("delete"===b.peekType())d.push(b.next());else{var g=Math.min(b.peekLength(),c.peekLength()),i=b.next(g),j=c.next(g);if(e.number(j.retain)){var k={};e.number(i.retain)?k.retain=g:k.insert=i.insert;var l=f.attributes.compose(i.attributes,j.attributes,e.number(i.retain));l&&(k.attributes=l),d.push(k)}else e.number(j["delete"])&&e.number(i.retain)&&d.push(j)}return d.chop()},h.prototype.concat=function(a){
var b=this.slice();return a.ops.length>0&&(b.push(a.ops[0]),b.ops=b.ops.concat(a.ops.slice(1))),b},h.prototype.diff=function(a){var b=new h;if(this.ops===a.ops)return b;var c=[this.ops,a.ops].map(function(b){return b.map(function(c){if(null!=c.insert)return e.string(c.insert)?c.insert:g;var d=b===a.ops?"on":"with";throw new Error("diff() called "+d+" non-document")}).join("")}),i=d(c[0],c[1]),j=f.iterator(this.ops),k=f.iterator(a.ops);return i.forEach(function(a){for(var c=a[1].length;c>0;){var g=0;switch(a[0]){case d.INSERT:g=Math.min(k.peekLength(),c),b.push(k.next(g));break;case d.DELETE:g=Math.min(c,j.peekLength()),j.next(g),b["delete"](g);break;case d.EQUAL:g=Math.min(j.peekLength(),k.peekLength(),c);var h=j.next(g),i=k.next(g);e.equal(h.insert,i.insert)?b.retain(g,f.attributes.diff(h.attributes,i.attributes)):b.push(i)["delete"](g)}c-=g}}),b.chop()},h.prototype.transform=function(a,b){if(b=!!b,e.number(a))return this.transformPosition(a,b);for(var c=f.iterator(this.ops),d=f.iterator(a.ops),g=new h;c.hasNext()||d.hasNext();)if("insert"!==c.peekType()||!b&&"insert"===d.peekType())if("insert"===d.peekType())g.push(d.next());else{var i=Math.min(c.peekLength(),d.peekLength()),j=c.next(i),k=d.next(i);if(j["delete"])continue;k["delete"]?g.push(k):g.retain(i,f.attributes.transform(j.attributes,k.attributes,b))}else g.retain(f.length(c.next()));return g.chop()},h.prototype.transformPosition=function(a,b){b=!!b;for(var c=f.iterator(this.ops),d=0;c.hasNext()&&a>=d;){var e=c.peekLength(),g=c.peekType();c.next(),"delete"!==g?("insert"===g&&(a>d||!b)&&(a+=e),d+=e):a-=Math.min(e,a-d)}return a},b.exports=h},{"./is":4,"./op":5,"fast-diff":6}],4:[function(a,b,c){b.exports={equal:function(a,b){if(a===b)return!0;if(null==a&&null==b)return!0;if(null==a||null==b)return!1;if(!this.object(a)||!this.object(b))return!1;if(Object.keys(a).length!=Object.keys(b).length)return!1;for(var c in a)if(a[c]!==b[c])return!1;return!0},array:function(a){return Array.isArray(a)},number:function(a){return"number"==typeof a?!0:"object"==typeof a&&"[object Number]"===Object.prototype.toString.call(a)?!0:!1},object:function(a){return a?"function"==typeof a||"object"==typeof a:!1},string:function(a){return"string"==typeof a?!0:"object"==typeof a&&"[object String]"===Object.prototype.toString.call(a)?!0:!1}}},{}],5:[function(a,b,c){function d(a){this.ops=a,this.index=0,this.offset=0}var e=a("./is"),f={attributes:{clone:function(a,b){return e.object(a)?Object.keys(a).reduce(function(c,d){return void 0===a[d]||null===a[d]&&!b||(c[d]=a[d]),c},{}):{}},compose:function(a,b,c){e.object(a)||(a={}),e.object(b)||(b={});var d=this.clone(b,c);for(var f in a)void 0!==a[f]&&void 0===b[f]&&(d[f]=a[f]);return Object.keys(d).length>0?d:void 0},diff:function(a,b){e.object(a)||(a={}),e.object(b)||(b={});var c=Object.keys(a).concat(Object.keys(b)).reduce(function(c,d){return a[d]!==b[d]&&(c[d]=void 0===b[d]?null:b[d]),c},{});return Object.keys(c).length>0?c:void 0},transform:function(a,b,c){if(!e.object(a))return b;if(!e.object(b))return void 0;if(!c)return b;var d=Object.keys(b).reduce(function(c,d){return void 0===a[d]&&(c[d]=b[d]),c},{});return Object.keys(d).length>0?d:void 0}},clone:function(a){var b=this.attributes.clone(a);return e.object(b.attributes)&&(b.attributes=this.attributes.clone(b.attributes,!0)),b},iterator:function(a){return new d(a)},length:function(a){return e.number(a["delete"])?a["delete"]:e.number(a.retain)?a.retain:e.string(a.insert)?a.insert.length:1}};d.prototype.hasNext=function(){return this.peekLength()<1/0},d.prototype.next=function(a){a||(a=1/0);var b=this.ops[this.index];if(b){var c=this.offset,d=f.length(b);if(a>=d-c?(a=d-c,this.index+=1,this.offset=0):this.offset+=a,e.number(b["delete"]))return{"delete":a};var g={};return b.attributes&&(g.attributes=b.attributes),e.number(b.retain)?g.retain=a:e.string(b.insert)?g.insert=b.insert.substr(c,a):g.insert=b.insert,g}return{retain:1/0}},d.prototype.peekLength=function(){return this.ops[this.index]?f.length(this.ops[this.index])-this.offset:1/0},d.prototype.peekType=function(){return this.ops[this.index]?e.number(this.ops[this.index]["delete"])?"delete":e.number(this.ops[this.index].retain)?"retain":"insert":"retain"},b.exports=f},{"./is":4}],6:[function(a,b,c){function d(a,b){if(a==b)return a?[[n,a]]:[];var c=h(a,b),d=a.substring(0,c);a=a.substring(c),b=b.substring(c),c=i(a,b);var f=a.substring(a.length-c);a=a.substring(0,a.length-c),b=b.substring(0,b.length-c);var g=e(a,b);return d&&g.unshift([n,d]),f&&g.push([n,f]),k(g),g}function e(a,b){var c;if(!a)return[[m,b]];if(!b)return[[l,a]];var e=a.length>b.length?a:b,g=a.length>b.length?b:a,h=e.indexOf(g);if(-1!=h)return c=[[m,e.substring(0,h)],[n,g],[m,e.substring(h+g.length)]],a.length>b.length&&(c[0][0]=c[2][0]=l),c;if(1==g.length)return[[l,a],[m,b]];var i=j(a,b);if(i){var k=i[0],o=i[1],p=i[2],q=i[3],r=i[4],s=d(k,p),t=d(o,q);return s.concat([[n,r]],t)}return f(a,b)}function f(a,b){for(var c=a.length,d=b.length,e=Math.ceil((c+d)/2),f=e,h=2*e,i=new Array(h),j=new Array(h),k=0;h>k;k++)i[k]=-1,j[k]=-1;i[f+1]=0,j[f+1]=0;for(var n=c-d,o=n%2!=0,p=0,q=0,r=0,s=0,t=0;e>t;t++){for(var u=-t+p;t-q>=u;u+=2){var v,w=f+u;v=u==-t||u!=t&&i[w-1]<i[w+1]?i[w+1]:i[w-1]+1;for(var x=v-u;c>v&&d>x&&a.charAt(v)==b.charAt(x);)v++,x++;if(i[w]=v,v>c)q+=2;else if(x>d)p+=2;else if(o){var y=f+n-u;if(y>=0&&h>y&&-1!=j[y]){var z=c-j[y];if(v>=z)return g(a,b,v,x)}}}for(var A=-t+r;t-s>=A;A+=2){var z,y=f+A;z=A==-t||A!=t&&j[y-1]<j[y+1]?j[y+1]:j[y-1]+1;for(var B=z-A;c>z&&d>B&&a.charAt(c-z-1)==b.charAt(d-B-1);)z++,B++;if(j[y]=z,z>c)s+=2;else if(B>d)r+=2;else if(!o){var w=f+n-A;if(w>=0&&h>w&&-1!=i[w]){var v=i[w],x=f+v-w;if(z=c-z,v>=z)return g(a,b,v,x)}}}}return[[l,a],[m,b]]}function g(a,b,c,e){var f=a.substring(0,c),g=b.substring(0,e),h=a.substring(c),i=b.substring(e),j=d(f,g),k=d(h,i);return j.concat(k)}function h(a,b){if(!a||!b||a.charAt(0)!=b.charAt(0))return 0;for(var c=0,d=Math.min(a.length,b.length),e=d,f=0;e>c;)a.substring(f,e)==b.substring(f,e)?(c=e,f=c):d=e,e=Math.floor((d-c)/2+c);return e}function i(a,b){if(!a||!b||a.charAt(a.length-1)!=b.charAt(b.length-1))return 0;for(var c=0,d=Math.min(a.length,b.length),e=d,f=0;e>c;)a.substring(a.length-e,a.length-f)==b.substring(b.length-e,b.length-f)?(c=e,f=c):d=e,e=Math.floor((d-c)/2+c);return e}function j(a,b){function c(a,b,c){for(var d,e,f,g,j=a.substring(c,c+Math.floor(a.length/4)),k=-1,l="";-1!=(k=b.indexOf(j,k+1));){var m=h(a.substring(c),b.substring(k)),n=i(a.substring(0,c),b.substring(0,k));l.length<n+m&&(l=b.substring(k-n,k)+b.substring(k,k+m),d=a.substring(0,c-n),e=a.substring(c+m),f=b.substring(0,k-n),g=b.substring(k+m))}return 2*l.length>=a.length?[d,e,f,g,l]:null}var d=a.length>b.length?a:b,e=a.length>b.length?b:a;if(d.length<4||2*e.length<d.length)return null;var f,g=c(d,e,Math.ceil(d.length/4)),j=c(d,e,Math.ceil(d.length/2));if(!g&&!j)return null;f=j?g&&g[4].length>j[4].length?g:j:g;var k,l,m,n;a.length>b.length?(k=f[0],l=f[1],m=f[2],n=f[3]):(m=f[0],n=f[1],k=f[2],l=f[3]);var o=f[4];return[k,l,m,n,o]}function k(a){a.push([n,""]);for(var b,c=0,d=0,e=0,f="",g="";c<a.length;)switch(a[c][0]){case m:e++,g+=a[c][1],c++;break;case l:d++,f+=a[c][1],c++;break;case n:d+e>1?(0!==d&&0!==e&&(b=h(g,f),0!==b&&(c-d-e>0&&a[c-d-e-1][0]==n?a[c-d-e-1][1]+=g.substring(0,b):(a.splice(0,0,[n,g.substring(0,b)]),c++),g=g.substring(b),f=f.substring(b)),b=i(g,f),0!==b&&(a[c][1]=g.substring(g.length-b)+a[c][1],g=g.substring(0,g.length-b),f=f.substring(0,f.length-b))),0===d?a.splice(c-e,d+e,[m,g]):0===e?a.splice(c-d,d+e,[l,f]):a.splice(c-d-e,d+e,[l,f],[m,g]),c=c-d-e+(d?1:0)+(e?1:0)+1):0!==c&&a[c-1][0]==n?(a[c-1][1]+=a[c][1],a.splice(c,1)):c++,e=0,d=0,f="",g=""}""===a[a.length-1][1]&&a.pop();var j=!1;for(c=1;c<a.length-1;)a[c-1][0]==n&&a[c+1][0]==n&&(a[c][1].substring(a[c][1].length-a[c-1][1].length)==a[c-1][1]?(a[c][1]=a[c-1][1]+a[c][1].substring(0,a[c][1].length-a[c-1][1].length),a[c+1][1]=a[c-1][1]+a[c+1][1],a.splice(c-1,1),j=!0):a[c][1].substring(0,a[c+1][1].length)==a[c+1][1]&&(a[c-1][1]+=a[c+1][1],a[c][1]=a[c][1].substring(a[c+1][1].length)+a[c+1][1],a.splice(c+1,1),j=!0)),c++;j&&k(a)}var l=-1,m=1,n=0,o=d;o.INSERT=m,o.DELETE=l,o.EQUAL=n,b.exports=o},{}],7:[function(a,b,c){b.exports={version:"0.20.1"}},{}],8:[function(a,b,c){var d,e,f,g,h,i,j,k;j=a("lodash"),d=a("rich-text/lib/delta"),k=a("../lib/dom"),f=a("./format"),g=a("./line"),h=a("../lib/linked-list"),i=a("./normalizer"),e=function(){function a(a,b){this.root=a,null==b&&(b={}),this.normalizer=new i,this.formats={},j.each(b.formats,j.bind(this.addFormat,this)),this.setHTML(this.root.innerHTML)}return a.prototype.addFormat=function(a,b){return j.isObject(b)||(b=f.FORMATS[a]),null!=this.formats[a]&&console.warn("Overwriting format",a,this.formats[a]),this.formats[a]=new f(b),this.normalizer.addFormat(b)},a.prototype.appendLine=function(a){return this.insertLineBefore(a,null)},a.prototype.findLeafAt=function(a,b){var c,d,e;return e=this.findLineAt(a),c=e[0],d=e[1],null!=c?c.findLeafAt(d,b):[void 0,d]},a.prototype.findLine=function(a){for(var b;null!=a&&null==k.BLOCK_TAGS[a.tagName];)a=a.parentNode;return b=null!=a?k(a).data(g.DATA_KEY):void 0,(null!=b?b.node:void 0)===a?b:void 0},a.prototype.findLineAt=function(a){var b,c;if(!(this.lines.length>0))return[void 0,a];if(c=this.toDelta().length(),a===c)return[this.lines.last,this.lines.last.length];if(a>c)return[void 0,a-c];for(b=this.lines.first;null!=b;){if(a<b.length)return[b,a];a-=b.length,b=b.next}return[void 0,a]},a.prototype.getHTML=function(){return this.root.innerHTML.replace(/\>\s+\</g,">&nbsp;<")},a.prototype.insertLineBefore=function(a,b){var c;return c=new g(this,a),null!=b?(k(a.parentNode).isElement()||this.root.insertBefore(a,b.node),this.lines.insertAfter(b.prev,c)):(k(a.parentNode).isElement()||this.root.appendChild(a),this.lines.append(c)),c},a.prototype.mergeLines=function(a,b){return b.length>1&&(1===a.length&&k(a.leaves.last.node).remove(),j.each(k(b.node).childNodes(),function(b){return b.tagName!==k.DEFAULT_BREAK_TAG?a.node.appendChild(b):void 0})),this.removeLine(b),a.rebuild()},a.prototype.optimizeLines=function(){return j.each(this.lines.toArray(),function(a,b){return a.optimize(),!0})},a.prototype.rebuild=function(){var a,b,c;for(b=this.lines.toArray(),a=this.root.firstChild,null!=a&&null!=k.LIST_TAGS[a.tagName]&&(a=a.firstChild),j.each(b,function(b){return function(c,d){for(var e,f;c.node!==a;){if(c.node.parentNode!==b.root&&(null!=(f=c.node.parentNode)?f.parentNode:void 0)!==b.root)return b.removeLine(c);a=b.normalizer.normalizeLine(a),e=b.insertLineBefore(a,c),a=k(a).nextLineNode(b.root)}return c.outerHTML!==a.outerHTML&&(c.node=b.normalizer.normalizeLine(c.node),c.rebuild()),a=k(a).nextLineNode(b.root)}}(this)),c=[];null!=a;)a=this.normalizer.normalizeLine(a),this.appendLine(a),c.push(a=k(a).nextLineNode(this.root));return c},a.prototype.removeLine=function(a){return null!=a.node.parentNode&&(k.LIST_TAGS[a.node.parentNode.tagName]&&1===a.node.parentNode.childNodes.length?k(a.node.parentNode).remove():k(a.node).remove()),this.lines.remove(a)},a.prototype.setHTML=function(a){return a=i.stripComments(a),a=i.stripWhitespace(a),this.root.innerHTML=a,this.lines=new h,this.rebuild()},a.prototype.splitLine=function(a,b){var c,d,e,f;return b=Math.min(b,a.length-1),f=k(a.node).split(b,!0),c=f[0],d=f[1],a.node=c,a.rebuild(),e=this.insertLineBefore(d,a.next),e.formats=j.clone(a.formats),e.resetContent(),e},a.prototype.toDelta=function(){var a,b;return b=this.lines.toArray(),a=new d,j.each(b,function(b){return j.each(b.delta.ops,function(b){return a.push(b)})}),a},a}(),b.exports=e},{"../lib/dom":17,"../lib/linked-list":18,"./format":10,"./line":12,"./normalizer":13,lodash:1,"rich-text/lib/delta":3}],9:[function(a,b,c){var d,e,f,g,h,i,j;i=a("lodash"),d=a("rich-text/lib/delta"),j=a("../lib/dom"),e=a("./document"),g=a("./line"),h=a("./selection"),f=function(){function a(a,b,c){this.root=a,this.quill=b,this.options=null!=c?c:{},this.root.setAttribute("id",this.options.id),this.doc=new e(this.root,this.options),this.delta=this.doc.toDelta(),this.length=this.delta.length(),this.selection=new h(this.doc,this.quill),this.timer=setInterval(i.bind(this.checkUpdate,this),this.options.pollInterval),this.savedRange=null,this.quill.on("selection-change",function(a){return function(b){return a.savedRange=b}}(this)),this.options.readOnly||this.enable()}return a.sources={API:"api",SILENT:"silent",USER:"user"},a.prototype.destroy=function(){return clearInterval(this.timer)},a.prototype.disable=function(){return this.enable(!1)},a.prototype.enable=function(a){null==a&&(a=!0)},a.prototype.applyDelta=function(b,c){var d;return d=this._update(),d&&(b=d.transform(b,!0),d=b.transform(d,!1)),b.ops.length>0&&(b=this._trackDelta(function(a){return function(){var c;return c=0,i.each(b.ops,function(b){return i.isString(b.insert)?(a._insertAt(c,b.insert,b.attributes),c+=b.insert.length):i.isNumber(b.insert)?(a._insertEmbed(c,b.attributes),c+=1):i.isNumber(b["delete"])?a._deleteAt(c,b["delete"]):i.isNumber(b.retain)?(i.each(b.attributes,function(d,e){return a._formatAt(c,b.retain,e,d)}),c+=b.retain):void 0}),a.selection.shiftAfter(0,0,i.bind(a.doc.optimizeLines,a.doc))}}(this)),this.delta=this.doc.toDelta(),this.length=this.delta.length(),this.innerHTML=this.root.innerHTML,b&&c!==a.sources.SILENT&&this.quill.emit(this.quill.constructor.events.TEXT_CHANGE,b,c)),d&&d.ops.length>0&&c!==a.sources.SILENT?this.quill.emit(this.quill.constructor.events.TEXT_CHANGE,d,a.sources.USER):void 0},a.prototype.checkUpdate=function(b){var c;return null==b&&(b="user"),null==this.root.parentNode?clearInterval(this.timer):(c=this._update(),c&&(this.delta=this.delta.compose(c),this.length=this.delta.length(),this.quill.emit(this.quill.constructor.events.TEXT_CHANGE,c,b)),c&&(b=a.sources.SILENT),this.selection.update(b))},a.prototype.focus=function(){return null!=this.selection.range?this.selection.setRange(this.selection.range):this.root.focus()},a.prototype.getBounds=function(a){var b,c,d,e,f,g,h;return this.checkUpdate(),g=this.doc.findLeafAt(a,!0),d=g[0],e=g[1],null==d?null:(c=this.root.parentNode.getBoundingClientRect(),h="left",0===d.length?b=d.node.parentNode.getBoundingClientRect():j.VOID_TAGS[d.node.tagName]?(b=d.node.getBoundingClientRect(),1===e&&(h="right")):(f=document.createRange(),e<d.length?(f.setStart(d.node,e),f.setEnd(d.node,e+1)):(f.setStart(d.node,e-1),f.setEnd(d.node,e),h="right"),b=f.getBoundingClientRect()),{height:b.height,left:b[h]-c.left,top:b.top-c.top})},a.prototype._deleteAt=function(a,b){return 0>=b?void 0:this.selection.shiftAfter(a,-1*b,function(c){return function(){var d,e,f,g,h,i,j;for(j=c.doc.findLineAt(a),f=j[0],i=j[1],d=f,g=f.length-i<=b&&i>0;null!=d&&b>0;)h=d.next,e=Math.min(d.length-i,b),0===i&&b>=d.length?c.doc.removeLine(d):d.deleteText(i,e),b-=e,d=h,i=0;return g&&f.next?c.doc.mergeLines(f,f.next):void 0}}(this))},a.prototype._formatAt=function(a,b,c,d){return this.selection.shiftAfter(a,0,function(e){return function(){var f,g,h,i,j;for(i=e.doc.findLineAt(a),g=i[0],h=i[1],j=[];null!=g&&b>0;)f=Math.min(b,g.length-h-1),g.formatText(h,f,c,d),b-=f,b>0&&g.format(c,d),b-=1,h=0,j.push(g=g.next);return j}}(this))},a.prototype._insertEmbed=function(a,b){return this.selection.shiftAfter(a,1,function(c){return function(){var d,e,f;return f=c.doc.findLineAt(a),d=f[0],e=f[1],d.insertEmbed(e,b)}}(this))},a.prototype._insertAt=function(a,b,c){return null==c&&(c={}),this.selection.shiftAfter(a,b.length,function(d){return function(){var e,f,g,h;return b=b.replace(/\r\n?/g,"\n"),f=b.split("\n"),h=d.doc.findLineAt(a),e=h[0],g=h[1],i.each(f,function(a,b){var h;return null==e||e.length<=g?(b<f.length-1||a.length>0)&&(e=d.doc.appendLine(document.createElement(j.DEFAULT_BLOCK_TAG)),g=0,e.insertText(g,a,c),e.format(c),h=null):(e.insertText(g,a,c),b<f.length-1&&(h=d.doc.splitLine(e,g+a.length),i.each(i.defaults({},c,e.formats),function(a,b){return e.format(b,c[b])}),g=0)),e=h})}}(this))},a.prototype._trackDelta=function(a){var b,c,d,e,f,g,h,j,k,l;g=null!=(k=this.savedRange)?k.start:void 0,a(),c=this.doc.toDelta(),this.savedRange=this.selection.getRange(),d=null!=(l=this.savedRange)?l.start:void 0;try{if(null!=g&&null!=d&&g<=this.delta.length()&&d<=c.length()&&(j=this.delta.slice(g),f=c.slice(d),i.isEqual(j.ops,f.ops)))return h=this.delta.slice(0,g),e=c.slice(0,d),h.diff(e)}catch(m){b=m}return this.delta.diff(c)},a.prototype._update=function(){var a;return this.innerHTML===this.root.innerHTML?!1:(a=this._trackDelta(function(a){return function(){return a.selection.preserve(i.bind(a.doc.rebuild,a.doc)),a.selection.shiftAfter(0,0,i.bind(a.doc.optimizeLines,a.doc))}}(this)),this.innerHTML=this.root.innerHTML,a.ops.length>0?a:!1)},a}(),b.exports=f},{"../lib/dom":17,"./document":8,"./line":12,"./selection":14,lodash:1,"rich-text/lib/delta":3}],10:[function(a,b,c){var d,e,f;e=a("lodash"),f=a("../lib/dom"),d=function(){function a(a){this.config=a}return a.types={LINE:"line",EMBED:"embed"},a.FORMATS={bold:{tag:"B",prepare:"bold"},italic:{tag:"I",prepare:"italic"},underline:{tag:"U",prepare:"underline"},strike:{tag:"S",prepare:"strikeThrough"},color:{style:"color","default":"rgb(0, 0, 0)",prepare:"foreColor"},background:{style:"backgroundColor","default":"rgb(255, 255, 255)",prepare:"backColor"},font:{style:"fontFamily","default":"'Helvetica', 'Arial', sans-serif",prepare:"fontName"},size:{style:"fontSize","default":"13px",prepare:function(a){return document.execCommand("fontSize",!1,f.convertFontSize(a))}},link:{tag:"A",add:function(a,b){return a.setAttribute("href",b),a},remove:function(a){return a.removeAttribute("href"),a},value:function(a){return a.getAttribute("href")}},image:{type:a.types.EMBED,tag:"IMG",attribute:"src"},align:{type:a.types.LINE,style:"textAlign","default":"left"},bullet:{type:a.types.LINE,exclude:"list",parentTag:"UL",tag:"LI"},list:{type:a.types.LINE,exclude:"bullet",parentTag:"OL",tag:"LI"}},a.prototype.add=function(b,c){var d,g,h,i,j;return c?this.value(b)===c?b:(e.isString(this.config.parentTag)&&(h=b.parentNode,h.tagName!==this.config.parentTag&&(h=document.createElement(this.config.parentTag),f(b).wrap(h)),b.parentNode.tagName===(null!=(i=b.parentNode.previousSibling)?i.tagName:void 0)&&f(b.parentNode.previousSibling).merge(b.parentNode),b.parentNode.tagName===(null!=(j=b.parentNode.nextSibling)?j.tagName:void 0)&&f(b.parentNode).merge(b.parentNode.nextSibling)),e.isString(this.config.tag)&&b.tagName!==this.config.tag&&(d=document.createElement(this.config.tag),null!=f.VOID_TAGS[d.tagName]?(null!=b.parentNode&&f(b).replace(d),b=d):this.isType(a.types.LINE)?b=f(b).switchTag(this.config.tag).get():(f(b).wrap(d),b=d)),(e.isString(this.config.style)||e.isString(this.config.attribute)||e.isString(this.config["class"]))&&(e.isString(this.config["class"])&&(b=this.remove(b)),f(b).isTextNode()&&(g=document.createElement(f.DEFAULT_INLINE_TAG),f(b).wrap(g),b=g),e.isString(this.config.style)&&c!==this.config["default"]&&(b.style[this.config.style]=c),e.isString(this.config.attribute)&&b.setAttribute(this.config.attribute,c),e.isString(this.config["class"])&&f(b).addClass(this.config["class"]+c)),e.isFunction(this.config.add)&&(b=this.config.add(b,c)),b):this.remove(b)},a.prototype.isType=function(a){return a===this.config.type},a.prototype.match=function(a){var b,c,d,g,h;if(!f(a).isElement())return!1;if(e.isString(this.config.parentTag)&&(null!=(g=a.parentNode)?g.tagName:void 0)!==this.config.parentTag)return!1;if(e.isString(this.config.tag)&&a.tagName!==this.config.tag)return!1;if(e.isString(this.config.style)&&(!a.style[this.config.style]||a.style[this.config.style]===this.config["default"]))return!1;if(e.isString(this.config.attribute)&&!a.hasAttribute(this.config.attribute))return!1;if(e.isString(this.config["class"])){for(h=f(a).classes(),c=0,d=h.length;d>c;c++)if(b=h[c],0===b.indexOf(this.config["class"]))return!0;return!1}return!0},a.prototype.prepare=function(a){return e.isString(this.config.prepare)?document.execCommand(this.config.prepare,!1,a):e.isFunction(this.config.prepare)?this.config.prepare(a):void 0},a.prototype.remove=function(b){var c,d,g,h;if(!this.match(b))return b;if(e.isString(this.config.style)&&(b.style[this.config.style]="",b.getAttribute("style")||b.removeAttribute("style")),e.isString(this.config.attribute)&&b.removeAttribute(this.config.attribute),e.isString(this.config["class"]))for(h=f(b).classes(),d=0,g=h.length;g>d;d++)c=h[d],0===c.indexOf(this.config["class"])&&f(b).removeClass(c);if(e.isString(this.config.tag))if(this.isType(a.types.LINE))e.isString(this.config.parentTag)&&(null!=b.previousSibling&&f(b).splitBefore(b.parentNode.parentNode),null!=b.nextSibling&&f(b.nextSibling).splitBefore(b.parentNode.parentNode)),b=f(b).switchTag(f.DEFAULT_BLOCK_TAG).get();else{if(this.isType(a.types.EMBED))return void f(b).remove();b=f(b).switchTag(f.DEFAULT_INLINE_TAG).get()}return e.isString(this.config.parentTag)&&f(b.parentNode).unwrap(),e.isFunction(this.config.remove)&&(b=this.config.remove(b)),b.tagName!==f.DEFAULT_INLINE_TAG||b.hasAttributes()||(b=f(b).unwrap()),b},a.prototype.value=function(a){var b,c,d,g;if(!this.match(a))return void 0;if(this.config.value)return this.config.value(a);if(e.isString(this.config.attribute))return a.getAttribute(this.config.attribute)||void 0;if(e.isString(this.config.style))return a.style[this.config.style]||void 0;if(e.isString(this.config["class"])){for(g=f(a).classes(),c=0,d=g.length;d>c;c++)if(b=g[c],0===b.indexOf(this.config["class"]))return b.slice(this.config["class"].length)}else if(e.isString(this.config.tag))return!0;return void 0},a}(),b.exports=d},{"../lib/dom":17,lodash:1}],11:[function(a,b,c){var d,e,f,g,h,i=function(a,b){function c(){this.constructor=a}for(var d in b)j.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},j={}.hasOwnProperty;g=a("lodash"),h=a("../lib/dom"),d=a("./format"),f=a("../lib/linked-list"),e=function(a){function b(a,c){this.node=a,this.formats=g.clone(c),this.text=h(this.node).text(),this.length=this.text.length,h(this.node).data(b.DATA_KEY,this)}return i(b,a),b.DATA_KEY="leaf",b.isLeafNode=function(a){return h(a).isTextNode()||null==a.firstChild},b.prototype.deleteText=function(a,c){var d;if(c>0)return this.text=this.text.slice(0,a)+this.text.slice(a+c),this.length=this.text.length,null!=h.EMBED_TAGS[this.node.tagName]?(d=document.createTextNode(this.text),h(d).data(b.DATA_KEY,this),this.node=h(this.node).replace(d).get()):h(this.node).text(this.text)},b.prototype.insertText=function(a,c){var d;return this.text=this.text.slice(0,a)+c+this.text.slice(a),h(this.node).isTextNode()?h(this.node).text(this.text):(d=document.createTextNode(c),h(d).data(b.DATA_KEY,this),this.node.tagName===h.DEFAULT_BREAK_TAG?this.node=h(this.node).replace(d).get():(this.node.appendChild(d),this.node=d)),this.length=this.text.length},b}(f.Node),b.exports=e},{"../lib/dom":17,"../lib/linked-list":18,"./format":10,lodash:1}],12:[function(a,b,c){var d,e,f,g,h,i,j,k,l=function(a,b){function c(){this.constructor=a}for(var d in b)m.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},m={}.hasOwnProperty;j=a("lodash"),d=a("rich-text/lib/delta"),k=a("../lib/dom"),e=a("./format"),f=a("./leaf"),g=a("./line"),h=a("../lib/linked-list"),i=a("./normalizer"),g=function(a){function b(a,c){this.doc=a,this.node=c,this.formats={},this.rebuild(),b.__super__.constructor.call(this,this.node)}return l(b,a),b.DATA_KEY="line",b.prototype.buildLeaves=function(a,b){return j.each(k(a).childNodes(),function(a){return function(c){var d;return c=a.doc.normalizer.normalizeNode(c),d=j.clone(b),j.each(a.doc.formats,function(a,b){return!a.isType(e.types.LINE)&&a.match(c)?d[b]=a.value(c):void 0}),f.isLeafNode(c)?a.leaves.append(new f(c,d)):a.buildLeaves(c,d)}}(this))},b.prototype.deleteText=function(a,b){var c,d,e;if(b>0){for(e=this.findLeafAt(a),d=e[0],a=e[1];null!=d&&b>0;)c=Math.min(b,d.length-a),d.deleteText(a,c),b-=c,d=d.next,a=0;return this.rebuild()}},b.prototype.findLeaf=function(a){return null!=a?k(a).data(f.DATA_KEY):void 0},b.prototype.findLeafAt=function(a,b){var c;if(null==b&&(b=!1),a>=this.length-1)return[this.leaves.last,this.leaves.last.length];for(c=this.leaves.first;null!=c;){if(a<c.length||a===c.length&&b)return[c,a];a-=c.length,c=c.next}return[this.leaves.last,a-this.leaves.last.length]},b.prototype.format=function(a,b){var c;return j.isObject(a)?c=a:(c={},c[a]=b),j.each(c,function(a){return function(b,c){var d,f;return f=a.doc.formats[c],null!=f?(f.isType(e.types.LINE)&&(f.config.exclude&&a.formats[f.config.exclude]&&(d=a.doc.formats[f.config.exclude],null!=d&&(a.node=d.remove(a.node),delete a.formats[f.config.exclude])),a.node=f.add(a.node,b)),b?a.formats[c]=b:delete a.formats[c]):void 0}}(this)),this.resetContent()},b.prototype.formatText=function(a,b,c,d){var f,g,h,i,j,l,m,n,o,p;if(l=this.findLeafAt(a),g=l[0],h=l[1],f=this.doc.formats[c],null!=f&&f.config.type!==e.types.LINE){for(;null!=g&&b>0;){if(j=g.next,d&&g.formats[c]!==d||!d&&null!=g.formats[c]){if(p=g.node,null!=g.formats[c]){for(k(p).splitBefore(this.node);!f.match(p);)p=p.parentNode;k(p).split(g.length)}h>0&&(m=k(p).split(h),i=m[0],p=m[1]),g.length>h+b&&(n=k(p).split(b),p=n[0],o=n[1]),f.add(p,d)}b-=g.length-h,h=0,g=j}return this.rebuild()}},b.prototype._insert=function(a,b,c){var d,f,g,h,i,l;return i=this.findLeafAt(a),d=i[0],f=i[1],b=j.reduce(c,function(a){return function(b,c,d){var f;return f=a.doc.formats[d],null==f||f.isType(e.types.LINE)||(b=f.add(b,c)),b}}(this),b),l=k(d.node).split(f),h=l[0],g=l[1],g&&(g=k(g).splitBefore(this.node).get()),this.node.insertBefore(b,g),this.rebuild()},b.prototype.insertEmbed=function(a,b){var c,d,f,g,h,i,l,m;return l=this.findLeafAt(a),d=l[0],f=l[1],m=k(d.node).split(f),i=m[0],g=m[1],c=j.find(Object.keys(b),function(a){return function(b){return a.doc.formats[b].isType(e.types.EMBED)}}(this)),h=this.doc.formats[c].add({},b[c]),b=j.clone(b),delete b[c],this._insert(a,h,b)},b.prototype.insertText=function(a,b,c){var d,e,f;return null==c&&(c={}),b.length>0?(f=this.findLeafAt(a),d=f[0],e=f[1],j.isEqual(d.formats,c)?(d.insertText(e,b),this.resetContent()):this._insert(a,document.createTextNode(b),c)):void 0},b.prototype.optimize=function(){return i.optimizeLine(this.node),this.rebuild()},b.prototype.rebuild=function(a){return null==a&&(a=!1),!a&&null!=this.outerHTML&&this.outerHTML===this.node.outerHTML&&j.all(this.leaves.toArray(),function(a){return function(b){return k(b.node).isAncestor(a.node)}}(this))?!1:(this.node=this.doc.normalizer.normalizeNode(this.node),0!==k(this.node).length()||this.node.querySelector(k.DEFAULT_BREAK_TAG)||this.node.appendChild(document.createElement(k.DEFAULT_BREAK_TAG)),this.leaves=new h,this.formats=j.reduce(this.doc.formats,function(a){return function(b,c,d){return c.isType(e.types.LINE)&&(c.match(a.node)?b[d]=c.value(a.node):delete b[d]),b}}(this),this.formats),this.buildLeaves(this.node,{}),this.resetContent(),!0)},b.prototype.resetContent=function(){return k(this.node).data(b.DATA_KEY,this),this.outerHTML=this.node.outerHTML,this.length=1,this.delta=new d,j.each(this.leaves.toArray(),function(a){return function(b){return a.length+=b.length,null!=k.EMBED_TAGS[b.node.tagName]?a.delta.insert(1,b.formats):a.delta.insert(b.text,b.formats)}}(this)),this.delta.insert("\n",this.formats)},b}(h.Node),b.exports=g},{"../lib/dom":17,"../lib/linked-list":18,"./format":10,"./leaf":11,"./line":12,"./normalizer":13,lodash:1,"rich-text/lib/delta":3}],13:[function(a,b,c){var d,e,f,g;e=a("lodash"),g=a("../lib/dom"),f=function(a){return a=a.replace(/(?:^|[-_])(\w)/g,function(a,b){return b?b.toUpperCase():""}),a.charAt(0).toLowerCase()+a.slice(1)},d=function(){function a(){this.whitelist={styles:{},tags:{}},this.whitelist.tags[g.DEFAULT_BREAK_TAG]=!0,this.whitelist.tags[g.DEFAULT_BLOCK_TAG]=!0,this.whitelist.tags[g.DEFAULT_INLINE_TAG]=!0}return a.ALIASES={STRONG:"B",EM:"I",DEL:"S",STRIKE:"S"},a.ATTRIBUTES={color:"color",face:"fontFamily",size:"fontSize"},a.prototype.addFormat=function(a){return null!=a.tag&&(this.whitelist.tags[a.tag]=!0),null!=a.parentTag&&(this.whitelist.tags[a.parentTag]=!0),null!=a.style?this.whitelist.styles[a.style]=!0:void 0},a.prototype.normalizeLine=function(b){return b=a.wrapInline(b),b=a.handleBreaks(b),"LI"===b.tagName&&a.flattenList(b),b=a.pullBlocks(b),b=this.normalizeNode(b),a.unwrapText(b),null!=b&&null!=g.LIST_TAGS[b.tagName]&&(b=b.firstChild),b},a.prototype.normalizeNode=function(b){return g(b).isTextNode()?b:(e.each(a.ATTRIBUTES,function(a,c){var d;return b.hasAttribute(c)?(d=b.getAttribute(c),"size"===c&&(d=g.convertFontSize(d)),b.style[a]=d,b.removeAttribute(c)):void 0}),("bold"===b.style.fontWeight||b.style.fontWeight>500)&&(b.style.fontWeight="",g(b).wrap(document.createElement("b")),b=b.parentNode),this.whitelistStyles(b),this.whitelistTags(b))},a.prototype.whitelistStyles=function(a){var b,c;return b=g(a).styles(),c=e.omit(b,function(a){return function(b,c){return null==a.whitelist.styles[f(c)]}}(this)),Object.keys(c).length<Object.keys(b).length?Object.keys(c).length>0?g(a).styles(c,!0):a.removeAttribute("style"):void 0},a.prototype.whitelistTags=function(b){return g(b).isElement()?(null!=a.ALIASES[b.tagName]?b=g(b).switchTag(a.ALIASES[b.tagName]).get():null==this.whitelist.tags[b.tagName]&&(b=null!=g.BLOCK_TAGS[b.tagName]?g(b).switchTag(g.DEFAULT_BLOCK_TAG).get():b.hasAttributes()||null==b.firstChild?g(b).switchTag(g.DEFAULT_INLINE_TAG).get():g(b).unwrap()),b):b},a.flattenList=function(a){var b,c,d;return d=a.nextSibling,b=e.map(a.querySelectorAll("li")),b.forEach(function(b){return a.parentNode.insertBefore(b,d),d=b.nextSibling}),c=e.map(a.querySelectorAll(Object.keys(g.LIST_TAGS).join(","))),c.forEach(function(a){return g(a).remove()})},a.handleBreaks=function(a){var b;return b=e.map(a.querySelectorAll(g.DEFAULT_BREAK_TAG)),e.each(b,function(b){return function(b){return null==b.nextSibling||g.isIE(10)&&null==b.previousSibling?void 0:g(b.nextSibling).splitBefore(a.parentNode)}}(this)),a},a.optimizeLine=function(a){var b,c,d,f;for(a.normalize(),b=g(a).length(),d=g(a).descendants(),f=[];d.length>0;)c=d.pop(),null!=(null!=c?c.parentNode:void 0)&&null==g.EMBED_TAGS[c.tagName]&&(c.tagName===g.DEFAULT_BREAK_TAG?0!==b?f.push(g(c).remove()):f.push(void 0):0===g(c).length()?(d.push(c.nextSibling),f.push(g(c).unwrap())):null!=c.previousSibling&&c.tagName===c.previousSibling.tagName&&e.isEqual(g(c).attributes(),g(c.previousSibling).attributes())?(d.push(c.firstChild),f.push(g(c.previousSibling).merge(c))):f.push(void 0));return f},a.pullBlocks=function(b){var c;for(c=b.firstChild;null!=c;){if(null!=g.BLOCK_TAGS[c.tagName]&&"LI"!==c.tagName){g(c).isolate(b.parentNode),null!=g.LIST_TAGS[c.tagName]&&c.firstChild?(g(c.parentNode).unwrap(),null==b.parentNode&&(b=c)):(g(c).unwrap(),a.pullBlocks(b));break}c=c.nextSibling}return b},a.stripComments=function(a){return a.replace(/<!--[\s\S]*?-->/g,"")},a.stripWhitespace=function(a){return a=a.trim(),a=a.replace(/(\r?\n|\r)+/g," "),a=a.replace(/\>\s+\</g,"><")},a.wrapInline=function(a){var b,c;if(null!=g.BLOCK_TAGS[a.tagName])return a;for(b=document.createElement(g.DEFAULT_BLOCK_TAG),a.parentNode.insertBefore(b,a);null!=a&&null==g.BLOCK_TAGS[a.tagName];)c=a.nextSibling,b.appendChild(a),a=c;return b},a.unwrapText=function(a){var b;return b=e.map(a.querySelectorAll(g.DEFAULT_INLINE_TAG)),e.each(b,function(a){return a.hasAttributes()?void 0:g(a).unwrap()})},a}(),b.exports=d},{"../lib/dom":17,lodash:1}],14:[function(a,b,c){var d,e,f,g,h,i;h=a("lodash"),i=a("../lib/dom"),d=a("./leaf"),e=a("./normalizer"),f=a("../lib/range"),g=function(){function a(a,b){this.doc=a,this.emitter=b,this.focus=!1,this.range=new f(0,0),this.nullDelay=!1,this.update("silent")}return a.prototype.checkFocus=function(){return document.activeElement===this.doc.root},a.prototype.getRange=function(a){var b,c,d;return null==a&&(a=!1),this.checkFocus()?(c=this._getNativeRange(),null==c?null:(d=this._positionToIndex(c.startContainer,c.startOffset),
b=c.startContainer===c.endContainer&&c.startOffset===c.endOffset?d:this._positionToIndex(c.endContainer,c.endOffset),new f(Math.min(d,b),Math.max(d,b)))):a?this.range:null},a.prototype.preserve=function(a){var b,c,d,e,f,g,h,i,j;return d=this._getNativeRange(),null!=d&&this.checkFocus()?(e=this._encodePosition(d.startContainer,d.startOffset),i=e[0],j=e[1],f=this._encodePosition(d.endContainer,d.endOffset),b=f[0],c=f[1],a(),g=this._decodePosition(i,j),i=g[0],j=g[1],h=this._decodePosition(b,c),b=h[0],c=h[1],this._setNativeRange(i,j,b,c)):a()},a.prototype.scrollIntoView=function(){var a,b,c,d,e,f,g,h,i;if(this.range)return c=this.emitter.editor,i=c.getBounds(this.range.start),d=this.range.isCollapsed()?i:c.getBounds(this.range.end),a=c.root.parentNode.getBoundingClientRect(),b=a.bottom-a.top,b<d.top+d.height?(g=c.doc.findLineAt(this.range.end),e=g[0],f=g[1],e.node.scrollIntoView(!1)):i.top<0?(h=c.doc.findLineAt(this.range.start),e=h[0],f=h[1],e.node.scrollIntoView()):void 0},a.prototype.setRange=function(a,b){var c,d,e,f,g,h,i;return null!=a?(e=this._indexToPosition(a.start),h=e[0],i=e[1],a.isCollapsed()?(f=[h,i],c=f[0],d=f[1]):(g=this._indexToPosition(a.end),c=g[0],d=g[1]),this._setNativeRange(h,i,c,d)):this._setNativeRange(null),this.update(b)},a.prototype.shiftAfter=function(a,b,c){var d;return d=this.getRange(),c(),null!=d?(d.shift(a,b),this.setRange(d,"silent")):void 0},a.prototype.update=function(a){var b,c,d,e;return c=this.checkFocus(),d=this.getRange(!0),b="silent"!==a&&(!f.compare(d,this.range)||c!==this.focus),e=c?d:null,null!==e||"user"!==a||this.nullDelay?(this.nullDelay=!1,this.range=d,this.focus=c,b?this.emitter.emit(this.emitter.constructor.events.SELECTION_CHANGE,e,a):void 0):this.nullDelay=!0},a.prototype._decodePosition=function(a,b){var c;return i(a).isElement()&&(c=i(a.parentNode).childNodes().indexOf(a),b+=c,a=a.parentNode),[a,b]},a.prototype._encodePosition=function(a,b){for(var c;;){if(i(a).isTextNode()||a.tagName===i.DEFAULT_BREAK_TAG||null!=i.EMBED_TAGS[a.tagName])return[a,b];if(b<a.childNodes.length)a=a.childNodes[b],b=0;else{if(0===a.childNodes.length)return null==this.doc.normalizer.whitelist.tags[a.tagName]&&(c=document.createTextNode(""),a.appendChild(c),a=c),[a,0];if(a=a.lastChild,!i(a).isElement())return[a,i(a).length()];if(a.tagName===i.DEFAULT_BREAK_TAG||null!=i.EMBED_TAGS[a.tagName])return[a,1];b=a.childNodes.length}}},a.prototype._getNativeRange=function(){var a,b;return b=document.getSelection(),(null!=b?b.rangeCount:void 0)>0&&(a=b.getRangeAt(0),i(a.startContainer).isAncestor(this.doc.root,!0)&&(a.startContainer===a.endContainer||i(a.endContainer).isAncestor(this.doc.root,!0)))?a:null},a.prototype._indexToPosition=function(a){var b,c,d;return 0===this.doc.lines.length?[this.doc.root,0]:(d=this.doc.findLeafAt(a,!0),b=d[0],c=d[1],this._decodePosition(b.node,c))},a.prototype._positionToIndex=function(a,b){var c,d,e,f,g,h;if(i.isIE(10)&&"BR"===a.tagName&&1===b&&(b=0),h=this._encodePosition(a,b),d=h[0],b=h[1],f=this.doc.findLine(d),null==f)return 0;for(c=f.findLeaf(d),g=0;null!=f.prev;)f=f.prev,g+=f.length;if(null==c)return g;for(e=0;null!=c.prev;)c=c.prev,e+=c.length;return g+e+b},a.prototype._setNativeRange=function(a,b,c,d){var e,f;if(f=document.getSelection())if(null!=a){if(this.checkFocus()||this.doc.root.focus(),e=this._getNativeRange(),null==e||a!==e.startContainer||b!==e.startOffset||c!==e.endContainer||d!==e.endOffset)return f.removeAllRanges(),e=document.createRange(),e.setStart(a,b),e.setEnd(c,d),f.addRange(e)}else if(f.removeAllRanges(),this.doc.root.blur(),i.isIE(11)&&!i.isIE(9))return document.body.focus()},a}(),b.exports=g},{"../lib/dom":17,"../lib/range":20,"./leaf":11,"./normalizer":13,lodash:1}],15:[function(a,b,c){a("./modules/authorship"),a("./modules/image-tooltip"),a("./modules/keyboard"),a("./modules/link-tooltip"),a("./modules/multi-cursor"),a("./modules/paste-manager"),a("./modules/toolbar"),a("./modules/tooltip"),a("./modules/undo-manager"),b.exports=a("./quill")},{"./modules/authorship":21,"./modules/image-tooltip":22,"./modules/keyboard":23,"./modules/link-tooltip":24,"./modules/multi-cursor":25,"./modules/paste-manager":26,"./modules/toolbar":27,"./modules/tooltip":28,"./modules/undo-manager":29,"./quill":30}],16:[function(a,b,c){var d,e,f,g=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},h={}.hasOwnProperty;f=a("./dom"),e=a("./picker"),d=function(a){function b(){b.__super__.constructor.apply(this,arguments),f(this.container).addClass("ql-color-picker")}return g(b,a),b.prototype.buildItem=function(a,c,d){var e;return e=b.__super__.buildItem.call(this,a,c,d),e.style.backgroundColor=c.value,e},b}(e),b.exports=d},{"./dom":17,"./picker":19}],17:[function(a,b,c){var d,e,f,g,h,i=function(a,b){return function(){return a.apply(b,arguments)}},j=function(a,b){function c(){this.constructor=a}for(var d in b)k.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},k={}.hasOwnProperty;f=a("lodash"),h=null,e=function(){function a(a){this.node=a,this.trigger=i(this.trigger,this)}return a.prototype.addClass=function(a){return this.hasClass(a)?void 0:(null!=this.node.classList?this.node.classList.add(a):null!=this.node.className&&(this.node.className=(this.node.className+" "+a).trim()),this)},a.prototype.attributes=function(a){var b,c,d,e,g,h;if(a)return f.each(a,function(a){return function(b,c){return a.node.setAttribute(c,b)}}(this)),this;if(null==this.node.attributes)return{};for(a={},g=this.node.attributes,c=d=0,e=g.length;e>d;c=++d)h=g[c],b=this.node.attributes[c],a[b.name]=b.value;return a},a.prototype.child=function(a){var b,c;for(b=this.node.firstChild,c=g(b).length();null!=b&&!(c>a);)a-=c,b=b.nextSibling,c=g(b).length();return null==b&&(b=this.node.lastChild,a=g(b).length()),[b,a]},a.prototype.childNodes=function(){return f.map(this.node.childNodes)},a.prototype.classes=function(){return this.node.className.split(/\s+/)},a.prototype.data=function(a,b){var c;return null!=b?(null==this.node["ql-data"]&&(this.node["ql-data"]={}),this.node["ql-data"][a]=b,this):null!=(c=this.node["ql-data"])?c[a]:void 0},a.prototype.descendants=function(){return f.map(this.node.getElementsByTagName("*"))},a.prototype.get=function(){return this.node},a.prototype.hasClass=function(a){return null!=this.node.classList?this.node.classList.contains(a):null!=this.node.className?this.classes().indexOf(a)>-1:!1},a.prototype.isAncestor=function(a,b){var c;if(null==b&&(b=!1),a===this.node)return b;for(c=this.node;c;){if(c===a)return!0;c=c.parentNode}return!1},a.prototype.isElement=function(){var a;return(null!=(a=this.node)?a.nodeType:void 0)===g.ELEMENT_NODE},a.prototype.isTextNode=function(){var a;return(null!=(a=this.node)?a.nodeType:void 0)===g.TEXT_NODE},a.prototype.isolate=function(a){return null!=this.node.nextSibling&&g(this.node.nextSibling).splitBefore(a),this.splitBefore(a),this},a.prototype.length=function(){var a;return null==this.node?0:(a=this.text().length,this.isElement()&&(a+=this.node.querySelectorAll(Object.keys(g.EMBED_TAGS).join(",")).length),a)},a.prototype.merge=function(a){var b;return b=g(a),this.isElement()?(b.moveChildren(this.node),this.normalize()):this.text(this.text()+b.text()),b.remove(),this},a.prototype.moveChildren=function(a){return f.each(this.childNodes(),function(b){return a.appendChild(b)}),this},a.prototype.nextLineNode=function(a){var b;return b=this.node.nextSibling,null==b&&this.node.parentNode!==a&&(b=this.node.parentNode.nextSibling),null!=b&&null!=g.LIST_TAGS[b.tagName]&&(b=b.firstChild),b},a.prototype.normalize=function(){var a,b,c,d;for(b=this.node.firstChild;null!=b;)d=b.nextSibling,a=g(b),null!=d&&g(d).isTextNode()&&(0===a.text().length?a.remove():a.isTextNode()&&(c=d.nextSibling,a.merge(d),d=c)),b=d;return this},a.prototype.on=function(a,b){return this.node.addEventListener(a,function(c){return function(d){var e,f;return e=!h||"keydown"!==a&&"keyup"!==a?d:h,f=b.call(c.node,e),f||(d.preventDefault(),d.stopPropagation()),f}}(this)),this},a.prototype.remove=function(){var a;return null!=(a=this.node.parentNode)&&a.removeChild(this.node),this.node=null,null},a.prototype.removeClass=function(a){var b;if(this.hasClass(a))return null!=this.node.classList?this.node.classList.remove(a):null!=this.node.className&&(b=this.classes(),b.splice(b.indexOf(a),1),this.node.className=b.join(" ")),this.node.getAttribute("class")||this.node.removeAttribute("class"),this},a.prototype.replace=function(a){return this.node.parentNode.replaceChild(a,this.node),this.node=a,this},a.prototype.splitBefore=function(a,b){var c,d,e,f;if(null==b&&(b=!1),this.node===a||this.node.parentNode===a)return this;if(null!=this.node.previousSibling||b){for(e=this.node.parentNode,d=e.cloneNode(!1),e.parentNode.insertBefore(d,e.nextSibling),f=this.node;null!=f;)c=f.nextSibling,d.appendChild(f),f=c;return g(d).splitBefore(a)}return g(this.node.parentNode).splitBefore(a)},a.prototype.split=function(a,b){var c,d,e,f,h,i,j,k,l,m;if(null==b&&(b=!1),j=this.length(),a=Math.max(0,a),a=Math.min(a,j),!b&&0===a)return[this.node.previousSibling,this.node,!1];if(!b&&a===j)return[this.node,this.node.nextSibling,!1];if(this.node.nodeType===g.TEXT_NODE)return c=this.node.splitText(a),[this.node,c,!0];for(h=this.node,m=this.node.cloneNode(!1),this.node.parentNode.insertBefore(m,h.nextSibling),k=this.child(a),d=k[0],a=k[1],l=g(d).split(a),e=l[0],f=l[1];null!==f;)i=f.nextSibling,m.appendChild(f),f=i;return[h,m,!0]},a.prototype.styles=function(a,b){var c,d;return null==b&&(b=!1),a?(b||(a=f.defaults(a,this.styles())),d=f.map(a,function(a,b){return b+": "+a}).join("; ")+";",this.node.setAttribute("style",d),this):(d=this.node.getAttribute("style")||"",c=f.reduce(d.split(";"),function(a,b){var c,d,e;return d=b.split(":"),c=d[0],e=d[1],c&&e&&(c=c.trim(),e=e.trim(),a[c.toLowerCase()]=e),a},{}))},a.prototype.switchTag=function(a){var b,c;return a=a.toUpperCase(),this.node.tagName===a?this:(c=document.createElement(a),b=this.attributes(),null==g.VOID_TAGS[a]&&this.moveChildren(c),this.replace(c),this.node=c,this.attributes(b))},a.prototype.text=function(a){if(null!=a){switch(this.node.nodeType){case g.ELEMENT_NODE:this.node.textContent=a;break;case g.TEXT_NODE:this.node.data=a}return this}switch(this.node.nodeType){case g.ELEMENT_NODE:return this.node.tagName===g.DEFAULT_BREAK_TAG?"":null!=g.EMBED_TAGS[this.node.tagName]?g.EMBED_TEXT:null!=this.node.textContent?this.node.textContent:"";case g.TEXT_NODE:return this.node.data||"";default:return""}},a.prototype.textNodes=function(){var a,b,c;for(c=document.createTreeWalker(this.node,NodeFilter.SHOW_TEXT,null,!1),b=[];a=c.nextNode();)b.push(a);return b},a.prototype.toggleClass=function(a,b){return null==b&&(b=!this.hasClass(a)),b?this.addClass(a):this.removeClass(a),this},a.prototype.trigger=function(a,b){var c,d,e;return null==b&&(b={}),["keypress","keydown","keyup"].indexOf(a)<0?(c=document.createEvent("Event"),c.initEvent(a,b.bubbles,b.cancelable)):(c=document.createEvent("KeyboardEvent"),h=f.clone(b),f.isNumber(b.key)?h.which=b.key:f.isString(b.key)?h.which=b.key.toUpperCase().charCodeAt(0):h.which=0,g.isIE(10)?(e=[],b.altKey&&e.push("Alt"),b.ctrlKey&&e.push("Control"),b.metaKey&&e.push("Meta"),b.shiftKey&&e.push("Shift"),c.initKeyboardEvent(a,b.bubbles,b.cancelable,window,0,0,e.join(" "),null,null)):(d=f.isFunction(c.initKeyboardEvent)?"initKeyboardEvent":"initKeyEvent",c[d](a,b.bubbles,b.cancelable,window,b.ctrlKey,b.altKey,b.shiftKey,b.metaKey,0,0))),this.node.dispatchEvent(c),h=null,this},a.prototype.unwrap=function(){var a,b;return b=this.node.firstChild,a=this.node.nextSibling,f.each(this.childNodes(),function(b){return function(c){return b.node.parentNode.insertBefore(c,a)}}(this)),this.remove(),b},a.prototype.wrap=function(a){var b;for(null!=this.node.parentNode&&this.node.parentNode.insertBefore(a,this.node),b=a;null!=b.firstChild;)b=a.firstChild;return b.appendChild(this.node),this},a}(),d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return j(b,a),b.prototype["default"]=function(){return this.node.querySelector("option[selected]")},b.prototype.option=function(a,b){var c,d,e,g,h,i;if(null==b&&(b=!0),i=f.isElement(a)?a.value:a){for(i=i.replace(/[^\w]+/g,""),h=this.node.children,d=e=0,g=h.length;g>e;d=++e)if(c=h[d],c.value.replace(/[^\w]+/g,"")===i){this.node.selectedIndex=d;break}}else this.node.selectedIndex=-1;return b&&this.trigger("change"),this},b.prototype.reset=function(a){var b;return null==a&&(a=!0),b=this["default"](),null!=b?b.selected=!0:this.node.selectedIndex=0,a&&this.trigger("change"),this},b.prototype.value=function(){return this.node.selectedIndex>-1?this.node.options[this.node.selectedIndex].value:""},b}(e),g=function(a){return"SELECT"===(null!=a?a.tagName:void 0)?new d(a):new e(a)},g=f.extend(g,{ELEMENT_NODE:1,NOBREAK_SPACE:"&nbsp;",TEXT_NODE:3,ZERO_WIDTH_NOBREAK_SPACE:"\ufeff",DEFAULT_BLOCK_TAG:"DIV",DEFAULT_BREAK_TAG:"BR",DEFAULT_INLINE_TAG:"SPAN",EMBED_TEXT:"!",FONT_SIZES:{"10px":1,"13px":2,"16px":3,"18px":4,"24px":5,"32px":6,"48px":7},KEYS:{BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46},BLOCK_TAGS:{ADDRESS:"ADDRESS",ARTICLE:"ARTICLE",ASIDE:"ASIDE",AUDIO:"AUDIO",BLOCKQUOTE:"BLOCKQUOTE",CANVAS:"CANVAS",DD:"DD",DIV:"DIV",DL:"DL",FIGCAPTION:"FIGCAPTION",FIGURE:"FIGURE",FOOTER:"FOOTER",FORM:"FORM",H1:"H1",H2:"H2",H3:"H3",H4:"H4",H5:"H5",H6:"H6",HEADER:"HEADER",HGROUP:"HGROUP",LI:"LI",OL:"OL",OUTPUT:"OUTPUT",P:"P",PRE:"PRE",SECTION:"SECTION",TABLE:"TABLE",TBODY:"TBODY",TD:"TD",TFOOT:"TFOOT",TH:"TH",THEAD:"THEAD",TR:"TR",UL:"UL",VIDEO:"VIDEO"},EMBED_TAGS:{IMG:"IMG"},LINE_TAGS:{DIV:"DIV",LI:"LI"},LIST_TAGS:{OL:"OL",UL:"UL"},VOID_TAGS:{AREA:"AREA",BASE:"BASE",BR:"BR",COL:"COL",COMMAND:"COMMAND",EMBED:"EMBED",HR:"HR",IMG:"IMG",INPUT:"INPUT",KEYGEN:"KEYGEN",LINK:"LINK",META:"META",PARAM:"PARAM",SOURCE:"SOURCE",TRACK:"TRACK",WBR:"WBR"},convertFontSize:function(a){var b,c,d,e;f.isString(a)&&a.indexOf("px")>-1?(d=Object.keys(g.FONT_SIZES),e=f.values(g.FONT_SIZES)):(e=Object.keys(g.FONT_SIZES),d=f.values(g.FONT_SIZES));for(b in d)if(c=d[b],parseInt(a)<=parseInt(c))return e[b];return f.last(e)},isIE:function(a){var b;return b=document.documentMode,b&&a>=b},isIOS:function(){return/iPhone|iPad/i.test(navigator.userAgent)},isMac:function(){return/Mac/i.test(navigator.platform)}}),b.exports=g},{lodash:1}],18:[function(a,b,c){var d,e;e=function(){function a(a){this.data=a,this.prev=this.next=null}return a}(),d=function(){function a(){this.length=0,this.first=this.last=null}return a.Node=e,a.prototype.append=function(a){return null!=this.first?(a.next=null,this.last.next=a):this.first=a,a.prev=this.last,this.last=a,this.length+=1},a.prototype.insertAfter=function(a,b){return b.prev=a,null!=a?(b.next=a.next,null!=a.next&&(a.next.prev=b),a.next=b,a===this.last&&(this.last=b)):(b.next=this.first,this.first.prev=b,this.first=b),this.length+=1},a.prototype.remove=function(a){return this.length>1?(null!=a.prev&&(a.prev.next=a.next),null!=a.next&&(a.next.prev=a.prev),a===this.first&&(this.first=a.next),a===this.last&&(this.last=a.prev)):this.first=this.last=null,a.prev=a.next=null,this.length-=1},a.prototype.toArray=function(){var a,b;for(a=[],b=this.first;null!=b;)a.push(b),b=b.next;return a},a}(),b.exports=d},{}],19:[function(a,b,c){var d,e,f;e=a("lodash"),f=a("./dom"),d=function(){function a(a){this.select=a,this.container=document.createElement("span"),this.buildPicker(),f(this.container).addClass("ql-picker"),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),f(document).on("click",function(a){return function(){return a.close(),!0}}(this)),f(this.label).on("click",function(a){return function(){return e.defer(function(){return f(a.container).toggleClass("ql-expanded")}),!1}}(this)),f(this.select).on("change",function(a){return function(){var b,c;return a.select.selectedIndex>-1&&(b=a.container.querySelectorAll(".ql-picker-item")[a.select.selectedIndex],c=a.select.options[a.select.selectedIndex]),a.selectItem(b,!1),f(a.label).toggleClass("ql-active",c!==f(a.select)["default"]())}}(this))}return a.TEMPLATE='<span class="ql-picker-label"></span><span class="ql-picker-options"></span>',a.prototype.buildItem=function(a,b,c){var d;return d=document.createElement("span"),d.setAttribute("data-value",b.getAttribute("value")),f(d).addClass("ql-picker-item").text(f(b).text()).on("click",function(a){return function(){return a.selectItem(d,!0),a.close()}}(this)),this.select.selectedIndex===c&&this.selectItem(d,!1),d},a.prototype.buildPicker=function(){var b;return e.each(f(this.select).attributes(),function(a){return function(b,c){return a.container.setAttribute(c,b)}}(this)),this.container.innerHTML=a.TEMPLATE,this.label=this.container.querySelector(".ql-picker-label"),b=this.container.querySelector(".ql-picker-options"),e.each(this.select.options,function(a){return function(c,d){var e;return e=a.buildItem(b,c,d),b.appendChild(e)}}(this))},a.prototype.close=function(){return f(this.container).removeClass("ql-expanded")},a.prototype.selectItem=function(a,b){var c,d;return c=this.container.querySelector(".ql-selected"),null!=c&&f(c).removeClass("ql-selected"),null!=a?(d=a.getAttribute("data-value"),f(a).addClass("ql-selected"),f(this.label).text(f(a).text()),f(this.select).option(d,b),this.label.setAttribute("data-value",d)):(this.label.innerHTML="&nbsp;",this.label.removeAttribute("data-value"))},a}(),b.exports=d},{"./dom":17,lodash:1}],20:[function(a,b,c){var d,e;e=a("lodash"),d=function(){function a(a,b){this.start=a,this.end=b}return a.compare=function(a,b){return a===b?!0:null==a||null==b?!1:a.equals(b)},a.prototype.equals=function(a){return null==a?!1:this.start===a.start&&this.end===a.end},a.prototype.shift=function(a,b){var c;return c=e.map([this.start,this.end],function(c){return a>c?c:b>=0?c+b:Math.max(a,c+b)}),this.start=c[0],this.end=c[1],c},a.prototype.isCollapsed=function(){return this.start===this.end},a}(),b.exports=d},{lodash:1}],21:[function(a,b,c){var d,e,f,g,h;f=a("../quill"),g=f.require("lodash"),h=f.require("dom"),e=f.require("delta"),d=function(){function a(a,b){this.quill=a,this.options=b,null!=this.options.button&&this.attachButton(this.options.button),this.options.enabled&&this.enable(),this.quill.addFormat("author",{"class":"author-"}),null!=this.options.authorId&&(this.quill.on(this.quill.constructor.events.PRE_EVENT,function(a){return function(b,c,d){var h,i;return b===a.quill.constructor.events.TEXT_CHANGE&&"user"===d?(h=new e,i={author:a.options.authorId},g.each(c.ops,function(b){return null==b["delete"]?null!=b.insert||null!=b.retain&&null!=b.attributes?(b.attributes||(b.attributes={}),b.attributes.author=a.options.authorId,h.retain(b.retain||b.insert.length||1,i)):h.retain(b.retain):void 0}),a.quill.updateContents(h,f.sources.SILENT)):void 0}}(this)),this.addAuthor(this.options.authorId,this.options.color))}return a.DEFAULTS={authorId:null,color:"transparent",enabled:!1},a.prototype.addAuthor=function(a,b){var c;return c={},c[".authorship .author-"+a]={"background-color":""+b},this.quill.theme.addStyles(c)},a.prototype.attachButton=function(a){var b;return b=h(a),b.on("click",function(a){return function(){return b.toggleClass("ql-on"),a.enable($dom.hasClass("ql-on"))}}(this))},a.prototype.enable=function(a){return null==a&&(a=!0),h(this.quill.root).toggleClass("authorship",a)},a.prototype.disable=function(){return this.enable(!1)},a}(),f.registerModule("authorship",d),b.exports=d},{"../quill":30}],22:[function(a,b,c){var d,e,f,g,h,i,j,k=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},l={}.hasOwnProperty;f=a("../quill"),h=a("./tooltip"),i=f.require("lodash"),j=f.require("dom"),d=f.require("delta"),g=f.require("range"),e=function(a){function b(a,c){this.quill=a,this.options=c,this.options=i.defaults(this.options,h.DEFAULTS),b.__super__.constructor.call(this,this.quill,this.options),this.preview=this.container.querySelector(".preview"),this.textbox=this.container.querySelector(".input"),j(this.container).addClass("ql-image-tooltip"),this.initListeners()}return k(b,a),b.DEFAULTS={template:'<input class="input" type="textbox"> <div class="preview"> <span>Preview</span> </div> <a href="javascript:;" class="cancel">Cancel</a> <a href="javascript:;" class="insert">Insert</a>'},b.prototype.initListeners=function(){return j(this.quill.root).on("focus",i.bind(this.hide,this)),j(this.container.querySelector(".insert")).on("click",i.bind(this.insertImage,this)),j(this.container.querySelector(".cancel")).on("click",i.bind(this.hide,this)),j(this.textbox).on("input",i.bind(this._preview,this)),this.initTextbox(this.textbox,this.insertImage,this.hide),this.quill.onModuleLoad("toolbar",function(a){return function(b){return a.toolbar=b,b.initFormat("image",i.bind(a._onToolbar,a))}}(this))},b.prototype.insertImage=function(){var a,b;return b=this._normalizeURL(this.textbox.value),null==this.range&&(this.range=new g(0,0)),this.range&&(this.preview.innerHTML="<span>Preview</span>",this.textbox.value="",a=this.range.end,this.quill.insertEmbed(a,"image",b,"user"),this.quill.setSelection(a+1,a+1)),this.hide()},b.prototype._onToolbar=function(a,b){return b?(this.textbox.value||(this.textbox.value="http://"),this.show(),this.textbox.focus(),i.defer(function(a){return function(){return a.textbox.setSelectionRange(a.textbox.value.length,a.textbox.value.length)}}(this))):(this.quill.deleteText(a,"user"),this.toolbar.setActive("image",!1))},b.prototype._preview=function(){var a;if(this._matchImageURL(this.textbox.value))return"IMG"===this.preview.firstChild.tagName?this.preview.firstChild.setAttribute("src",this.textbox.value):(a=document.createElement("img"),a.setAttribute("src",this.textbox.value),this.preview.replaceChild(a,this.preview.firstChild))},b.prototype._matchImageURL=function(a){return/^https?:\/\/.+\.(jpe?g|gif|png)$/.test(a)},b.prototype._normalizeURL=function(a){return/^https?:\/\//.test(a)||(a="http://"+a),a},b}(h),f.registerModule("image-tooltip",e),b.exports=e},{"../quill":30,"./tooltip":28}],23:[function(a,b,c){var d,e,f,g,h;f=a("../quill"),g=f.require("lodash"),h=f.require("dom"),d=f.require("delta"),e=function(){function a(a,b){this.quill=a,this.hotkeys={},this._initListeners(),this._initHotkeys(),this.quill.onModuleLoad("toolbar",function(a){return function(b){return a.toolbar=b}}(this))}return a.hotkeys={BOLD:{key:"B",metaKey:!0},INDENT:{key:h.KEYS.TAB},ITALIC:{key:"I",metaKey:!0},OUTDENT:{key:h.KEYS.TAB,shiftKey:!0},UNDERLINE:{key:"U",metaKey:!0}},a.prototype.addHotkey=function(a,b){return Array.isArray(a)||(a=[a]),g.each(a,function(a){return function(c){var d,e;return c=g.isObject(c)?g.clone(c):{key:c},c.callback=b,e=g.isNumber(c.key)?c.key:c.key.toUpperCase().charCodeAt(0),null==(d=a.hotkeys)[e]&&(d[e]=[]),a.hotkeys[e].push(c)}}(this))},a.prototype.removeHotkeys=function(b,c){var d,e,f,h,i;return b=g.isString(b)?b.toUpperCase():b,b=a.hotkeys[b]?a.hotkeys[b]:b,b=g.isObject(b)?b:{key:b},i=g.isNumber(b.key)?b.key:b.key.charCodeAt(0),null==(d=this.hotkeys)[i]&&(d[i]=[]),f=g.partition(this.hotkeys[i],function(a){return g.isEqual(b,g.omit(a,"callback"))&&(!c||c===a.callback)}),h=f[0],e=f[1],this.hotkeys[i]=e,g.map(h,"callback")},a.prototype.toggleFormat=function(a,b){var c,d;return c=a.isCollapsed()?this.quill.getContents(Math.max(0,a.start-1),a.end):this.quill.getContents(a),d=0===c.ops.length||!g.all(c.ops,function(a){var c;return null!=(c=a.attributes)?c[b]:void 0}),a.isCollapsed()?this.quill.prepareFormat(b,d,f.sources.USER):this.quill.formatText(a,b,d,f.sources.USER),null!=this.toolbar?this.toolbar.setActive(b,d):void 0},a.prototype._initEnter=function(){var a;return a=[{key:h.KEYS.ENTER},{key:h.KEYS.ENTER,shiftKey:!0}],this.addHotkey(a,function(a){return function(b,c){var e,h,i,j,k,l;return null==b?!0:(k=a.quill.editor.doc.findLineAt(b.start),i=k[0],j=k[1],l=i.findLeafAt(j),h=l[0],j=l[1],e=(new d).retain(b.start).insert("\n",i.formats)["delete"](b.end-b.start),a.quill.updateContents(e,f.sources.USER),g.each(h.formats,function(b,c){a.quill.prepareFormat(c,b),null!=a.toolbar&&a.toolbar.setActive(c,b)}),a.quill.editor.selection.scrollIntoView(),!1)}}(this))},a.prototype._initDeletes=function(){return this.addHotkey([h.KEYS.DELETE,h.KEYS.BACKSPACE],function(a){return function(b,c){var d,e,g,i;return null!=b&&a.quill.getLength()>0&&(b.start!==b.end?a.quill.deleteText(b.start,b.end,f.sources.USER):c.key===h.KEYS.BACKSPACE?(i=a.quill.editor.doc.findLineAt(b.start),e=i[0],g=i[1],0===g&&(e.formats.bullet||e.formats.list)?(d=e.formats.bullet?"bullet":"list",a.quill.formatLine(b.start,b.start,d,!1,f.sources.USER)):b.start>0&&a.quill.deleteText(b.start-1,b.start,f.sources.USER)):b.start<a.quill.getLength()-1&&a.quill.deleteText(b.start,b.start+1,f.sources.USER)),a.quill.editor.selection.scrollIntoView(),!1}}(this))},a.prototype._initHotkeys=function(){return this.addHotkey(a.hotkeys.INDENT,function(a){return function(b){return a._onTab(b,!1),!1}}(this)),this.addHotkey(a.hotkeys.OUTDENT,function(a){return function(a){return!1}}(this)),g.each(["bold","italic","underline"],function(b){return function(c){return b.addHotkey(a.hotkeys[c.toUpperCase()],function(a){return b.quill.editor.doc.formats[c]&&b.toggleFormat(a,c),!1})}}(this)),this._initDeletes(),this._initEnter()},a.prototype._initListeners=function(){return h(this.quill.root).on("keydown",function(a){return function(b){var c;return c=!1,g.each(a.hotkeys[b.which],function(d){var e;return e=h.isMac()?b.metaKey:b.metaKey||b.ctrlKey,!!d.metaKey==!!e&&!!d.shiftKey==!!b.shiftKey&&!!d.altKey==!!b.altKey?(c=d.callback(a.quill.getSelection(),d,b)===!1||c,!0):void 0}),!c}}(this))},a.prototype._onTab=function(a,b){var c;return null==b&&(b=!1),c=(new d).retain(a.start).insert("	")["delete"](a.end-a.start).retain(this.quill.getLength()-a.end),this.quill.updateContents(c,f.sources.USER),this.quill.setSelection(a.start+1,a.start+1)},a}(),f.registerModule("keyboard",e),b.exports=e},{"../quill":30}],24:[function(a,b,c){var d,e,f,g,h,i=function(a,b){function c(){this.constructor=a}for(var d in b)j.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},j={}.hasOwnProperty;e=a("../quill"),f=a("./tooltip"),g=e.require("lodash"),h=e.require("dom"),d=function(a){function b(a,c){this.quill=a,this.options=c,this.options=g.defaults(this.options,f.DEFAULTS),b.__super__.constructor.call(this,this.quill,this.options),h(this.container).addClass("ql-link-tooltip"),this.textbox=this.container.querySelector(".input"),this.link=this.container.querySelector(".url"),this.initListeners()}return i(b,a),b.DEFAULTS={maxLength:50,template:'<span class="title">Visit URL:&nbsp;</span> <a href="#" class="url" target="_blank" href="about:blank"></a> <input class="input" type="text"> <span>&nbsp;&#45;&nbsp;</span> <a href="javascript:;" class="change">Change</a> <a href="javascript:;" class="remove">Remove</a> <a href="javascript:;" class="done">Done</a>'},b.hotkeys={LINK:{key:"K",metaKey:!0}},b.prototype.initListeners=function(){return this.quill.on(this.quill.constructor.events.SELECTION_CHANGE,function(a){return function(b){var c;if(null!=b&&b.isCollapsed())return c=a._findAnchor(b),c?(a.setMode(c.href,!1),a.show(c)):a.container.style.left!==f.HIDE_MARGIN?(a.range=null,a.hide()):void 0}}(this)),h(this.container.querySelector(".done")).on("click",g.bind(this.saveLink,this)),h(this.container.querySelector(".remove")).on("click",function(a){return function(){return a.removeLink(a.range)}}(this)),h(this.container.querySelector(".change")).on("click",function(a){return function(){return a.setMode(a.link.href,!0)}}(this)),this.initTextbox(this.textbox,this.saveLink,this.hide),this.quill.onModuleLoad("toolbar",function(a){return function(b){return a.toolbar=b,b.initFormat("link",g.bind(a._onToolbar,a))}}(this)),this.quill.onModuleLoad("keyboard",function(a){return function(c){return c.addHotkey(b.hotkeys.LINK,g.bind(a._onKeyboard,a))}}(this))},b.prototype.saveLink=function(){var a,b,c;return c=this._normalizeURL(this.textbox.value),null!=this.range&&(b=this.range.end,this.range.isCollapsed()?(a=this._findAnchor(this.range),null!=a&&(a.href=c)):this.quill.formatText(this.range,"link",c,"user"),this.quill.setSelection(b,b)),this.setMode(c,!1)},b.prototype.removeLink=function(a){return a.isCollapsed()&&(a=this._expandRange(a)),this.hide(),this.quill.formatText(a,"link",!1,"user"),null!=this.toolbar?this.toolbar.setActive("link",!1):void 0},b.prototype.setMode=function(a,b){var c;return null==b&&(b=!1),b?(this.textbox.value=a,g.defer(function(b){return function(){return b.textbox.focus(),b.textbox.setSelectionRange(0,a.length)}}(this))):(this.link.href=a,a=this.link.href,c=a.length>this.options.maxLength?a.slice(0,this.options.maxLength)+"...":a,h(this.link).text(c)),h(this.container).toggleClass("editing",b)},b.prototype._findAnchor=function(a){var b,c,d,e;for(e=this.quill.editor.doc.findLeafAt(a.start,!0),b=e[0],d=e[1],null!=b&&(c=b.node);null!=c&&c!==this.quill.root;){if("A"===c.tagName)return c;c=c.parentNode}return null},b.prototype._expandRange=function(a){var b,c,d,e,f;return e=this.quill.editor.doc.findLeafAt(a.start,!0),c=e[0],d=e[1],f=a.start-d,b=f+c.length,{start:f,end:b}},b.prototype._onToolbar=function(a,b){return this._toggle(a,b)},b.prototype._onKeyboard=function(){var a;return a=this.quill.getSelection(),this._toggle(a,!this._findAnchor(a))},b.prototype._toggle=function(a,b){var c;if(a)return b?a.isCollapsed()?void 0:(this.setMode(this._suggestURL(a),!0),c=this.quill.editor.selection._getNativeRange(),this.show(c)):this.removeLink(a)},b.prototype._normalizeURL=function(a){return/^(https?:\/\/|mailto:)/.test(a)||(a="http://"+a),a},b.prototype._suggestURL=function(a){var b;return b=this.quill.getText(a),this._normalizeURL(b)},b}(f),e.registerModule("link-tooltip",d),b.exports=d},{"../quill":30,"./tooltip":28}],25:[function(a,b,c){var d,e,f,g,h,i=function(a,b){function c(){this.constructor=a}for(var d in b)j.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},j={}.hasOwnProperty;f=a("../quill"),d=a("eventemitter2").EventEmitter2,g=f.require("lodash"),h=f.require("dom"),e=function(a){function b(a,b){this.quill=a,this.options=b,this.cursors={},this.container=this.quill.addContainer("ql-multi-cursor",!0),this.quill.on(this.quill.constructor.events.TEXT_CHANGE,g.bind(this._applyDelta,this))}return i(b,a),b.DEFAULTS={template:'<span class="cursor-flag"> <span class="cursor-name"></span> </span> <span class="cursor-caret"></span>',timeout:2500},b.events={CURSOR_ADDED:"cursor-addded",CURSOR_MOVED:"cursor-moved",CURSOR_REMOVED:"cursor-removed"},b.prototype.clearCursors=function(){return g.each(Object.keys(this.cursors),g.bind(this.removeCursor,this)),this.cursors={}},b.prototype.moveCursor=function(a,b){var c;return c=this.cursors[a],null!=c?(c.index=b,h(c.elem).removeClass("hidden"),clearTimeout(c.timer),c.timer=setTimeout(function(a){return function(){return h(c.elem).addClass("hidden"),c.timer=null}}(this),this.options.timeout),this._updateCursor(c),c):void 0},b.prototype.removeCursor=function(a){var c;return c=this.cursors[a],this.emit(b.events.CURSOR_REMOVED,c),null!=c&&c.elem.parentNode.removeChild(c.elem),delete this.cursors[a]},b.prototype.setCursor=function(a,c,d,e){var f;return null==this.cursors[a]&&(this.cursors[a]=f={userId:a,index:c,color:e,elem:this._buildCursor(d,e)},this.emit(b.events.CURSOR_ADDED,f)),g.defer(function(b){return function(){return b.moveCursor(a,c)}}(this)),this.cursors[a]},b.prototype.shiftCursors=function(a,b,c){return null==c&&(c=null),g.each(this.cursors,function(d){return function(e,f){var g;if(e)return g=Math.max(b,a-e.index),e.userId===c?d.moveCursor(c,e.index+g):e.index>a?e.index+=g:void 0}}(this))},b.prototype.update=function(){
return g.each(this.cursors,function(a){return function(b,c){return null!=b?(a._updateCursor(b),!0):void 0}}(this))},b.prototype._applyDelta=function(a){var b;return b=0,g.each(a.ops,function(a){return function(c){var d,e;return d=0,null!=c.insert?(d=c.insert.length||1,a.shiftCursors(b,d,null!=(e=c.attributes)?e.author:void 0)):null!=c["delete"]?a.shiftCursors(b,-1*c["delete"],null):null!=c.retain&&(a.shiftCursors(b,0,null),d=c.retain),b+=d}}(this)),this.update()},b.prototype._buildCursor=function(a,b){var c,d,e,f;return c=document.createElement("span"),h(c).addClass("cursor"),c.innerHTML=this.options.template,e=c.querySelector(".cursor-flag"),f=c.querySelector(".cursor-name"),h(f).text(a),d=c.querySelector(".cursor-caret"),d.style.backgroundColor=f.style.backgroundColor=b,this.container.appendChild(c),c},b.prototype._updateCursor=function(a){var c,d;return c=this.quill.getBounds(a.index),null==c?this.removeCursor(a.userId):(a.elem.style.top=c.top+this.quill.container.scrollTop+"px",a.elem.style.left=c.left+"px",a.elem.style.height=c.height+"px",d=a.elem.querySelector(".cursor-flag"),h(a.elem).toggleClass("top",parseInt(a.elem.style.top)<=d.offsetHeight).toggleClass("left",parseInt(a.elem.style.left)<=d.offsetWidth).toggleClass("right",this.quill.root.offsetWidth-parseInt(a.elem.style.left)<=d.offsetWidth),this.emit(b.events.CURSOR_MOVED,a))},b}(d),f.registerModule("multi-cursor",e),b.exports=e},{"../quill":30,eventemitter2:2}],26:[function(a,b,c){var d,e,f,g,h,i,j=function(a,b){return function(){return a.apply(b,arguments)}};g=a("../quill"),e=a("../core/document"),h=g.require("lodash"),i=g.require("dom"),d=g.require("delta"),f=function(){function a(b,c){var d;this.quill=b,this._onConvert=j(this._onConvert,this),this.container=this.quill.addContainer("ql-paste-manager"),this.container.setAttribute("contenteditable",!0),this.container.setAttribute("tabindex","-1"),i(this.quill.root).on("paste",h.bind(this._paste,this)),this.options=h.defaults(c,a.DEFAULTS),null==(d=this.options).onConvert&&(d.onConvert=this._onConvert)}return a.DEFAULTS={onConvert:null},a.prototype._onConvert=function(a){var b,c,f;return c=new e(a,this.quill.options),b=c.toDelta(),f=b.length(),0===f?b:b.compose((new d).retain(f-1)["delete"](1))},a.prototype._paste=function(){var a,b;return a=this.quill.getLength(),b=this.quill.getSelection(),null!=b?(this.container.focus(),h.defer(function(a){return function(){var c,d;return c=a.options.onConvert(a.container),d=c.length(),d>0&&(b.start>0&&c.ops.unshift({retain:b.start}),c["delete"](b.end-b.start),a.quill.updateContents(c,"user")),a.quill.setSelection(b.start+d,b.start+d),a.quill.editor.selection.scrollIntoView(),a.container.innerHTML=""}}(this))):void 0},a}(),g.registerModule("paste-manager",f),b.exports=f},{"../core/document":8,"../quill":30}],27:[function(a,b,c){var d,e,f,g;d=a("../quill"),f=d.require("lodash"),g=d.require("dom"),e=function(){function a(b,c){if(this.quill=b,this.options=c,(f.isString(this.options)||f.isElement(this.options))&&(this.options={container:this.options}),null==this.options.container)throw new Error("container required for toolbar",this.options);this.container=f.isString(this.options.container)?document.querySelector(this.options.container):this.options.container,this.inputs={},this.preventUpdate=!1,this.triggering=!1,f.each(this.quill.options.formats,function(b){return function(c){return null==a.formats.TOOLTIP[c]?b.initFormat(c,f.bind(b._applyFormat,b,c)):void 0}}(this)),this.quill.on(d.events.FORMAT_INIT,function(b){return function(c){return null==a.formats.TOOLTIP[c]?b.initFormat(c,f.bind(b._applyFormat,b,c)):void 0}}(this)),this.quill.on(d.events.SELECTION_CHANGE,function(a){return function(b){return null!=b?a.updateActive(b):void 0}}(this)),this.quill.on(d.events.TEXT_CHANGE,function(a){return function(){return a.updateActive()}}(this)),this.quill.onModuleLoad("keyboard",function(a){return function(b){return b.addHotkey([g.KEYS.BACKSPACE,g.KEYS.DELETE],function(){return f.defer(f.bind(a.updateActive,a))})}}(this)),g(this.container).addClass("ql-toolbar"),g.isIOS()&&g(this.container).addClass("ios")}return a.DEFAULTS={container:null},a.formats={LINE:{align:"align",bullet:"bullet",list:"list"},SELECT:{align:"align",background:"background",color:"color",font:"font",size:"size"},TOGGLE:{bold:"bold",bullet:"bullet",image:"image",italic:"italic",link:"link",list:"list",strike:"strike",underline:"underline"},TOOLTIP:{image:"image",link:"link"}},a.prototype.initFormat=function(b,c){var d,e,f;return f=".ql-"+b,null!=a.formats.SELECT[b]?(f="select"+f,d="change"):d="click",e=this.container.querySelector(f),null!=e?(this.inputs[b]=e,g(e).on(d,function(a){return function(){var b,f;return f="change"===d?g(e).value():!g(e).hasClass("ql-active"),a.preventUpdate=!0,a.quill.focus(),b=a.quill.getSelection(),null!=b&&c(b,f),g.isIE(11)&&a.quill.editor.selection.scrollIntoView(),a.preventUpdate=!1,!1}}(this))):void 0},a.prototype.setActive=function(a,b){var c,d,e,f;return"image"===a&&(b=!1),d=this.inputs[a],null!=d?(c=g(d),"SELECT"===d.tagName?(this.triggering=!0,f=c.value(d),null==b&&(b=null!=(e=c["default"]())?e.value:void 0),Array.isArray(b)&&(b=""),b!==f&&(null!=b?c.option(b):c.reset()),this.triggering=!1):c.toggleClass("ql-active",b||!1)):void 0},a.prototype.updateActive=function(a,b){var c;return null==b&&(b=null),a||(a=this.quill.getSelection()),null==a||this.preventUpdate?void 0:(c=this._getActive(a),f.each(this.inputs,function(a){return function(d,e){return(!Array.isArray(b)||b.indexOf(e)>-1)&&a.setActive(e,c[e]),!0}}(this)))},a.prototype._applyFormat=function(b,c,d){return this.triggering?void 0:(c.isCollapsed()?this.quill.prepareFormat(b,d,"user"):null!=a.formats.LINE[b]?this.quill.formatLine(c,b,d,"user"):this.quill.formatText(c,b,d,"user"),f.defer(function(a){return function(){return a.updateActive(c,["bullet","list"]),a.setActive(b,d)}}(this)))},a.prototype._getActive=function(a){var b,c;return b=this._getLeafActive(a),c=this._getLineActive(a),f.defaults({},b,c)},a.prototype._getLeafActive=function(a){var b,c,d,e,g;return a.isCollapsed()?(g=this.quill.editor.doc.findLineAt(a.start),d=g[0],e=g[1],b=0===e?this.quill.getContents(a.start,a.end+1):this.quill.getContents(a.start-1,a.end)):b=this.quill.getContents(a),c=f.map(b.ops,"attributes"),this._intersectFormats(c)},a.prototype._getLineActive=function(a){var b,c,d,e,g,h;for(c=[],g=this.quill.editor.doc.findLineAt(a.start),b=g[0],e=g[1],h=this.quill.editor.doc.findLineAt(a.end),d=h[0],e=h[1],null!=d&&d===b&&(d=d.next);null!=b&&b!==d;)c.push(f.clone(b.formats)),b=b.next;return this._intersectFormats(c)},a.prototype._intersectFormats=function(b){return f.reduce(b.slice(1),function(b,c){var d,e,g,h,i;return null==c&&(c={}),d=Object.keys(b),g=null!=c?Object.keys(c):{},h=f.intersection(d,g),i=f.difference(d,g),e=f.difference(g,d),f.each(h,function(d){if(null!=a.formats.SELECT[d])if(Array.isArray(b[d])){if(b[d].indexOf(c[d])<0)return b[d].push(c[d])}else if(b[d]!==c[d])return b[d]=[b[d],c[d]]}),f.each(i,function(c){return null!=a.formats.TOGGLE[c]?delete b[c]:null==a.formats.SELECT[c]||Array.isArray(b[c])?void 0:b[c]=[b[c]]}),f.each(e,function(d){return null!=a.formats.SELECT[d]?b[d]=[c[d]]:void 0}),b},b[0]||{})},a}(),d.registerModule("toolbar",e),b.exports=e},{"../quill":30}],28:[function(a,b,c){var d,e,f,g;d=a("../quill"),f=d.require("lodash"),g=d.require("dom"),e=function(){function a(b,c){this.quill=b,this.options=c,this.container=this.quill.addContainer("ql-tooltip"),this.container.innerHTML=this.options.template,this.hide(),this.quill.on(this.quill.constructor.events.TEXT_CHANGE,function(b){return function(c,d){return b.container.style.left!==a.HIDE_MARGIN?(b.range=null,b.hide()):void 0}}(this))}return a.DEFAULTS={offset:10,template:""},a.HIDE_MARGIN="-10000px",a.prototype.initTextbox=function(a,b,c){return g(a).on("keydown",function(a){return function(d){switch(d.which){case g.KEYS.ENTER:return d.preventDefault(),b.call(a);case g.KEYS.ESCAPE:return d.preventDefault(),c.call(a);default:return!0}}}(this))},a.prototype.hide=function(){return this.container.style.left=a.HIDE_MARGIN,this.range&&this.quill.setSelection(this.range),this.range=null},a.prototype.position=function(a){var b,c,d,e,f,g,h;return null!=a?(g=a.getBoundingClientRect(),f=this.quill.container.getBoundingClientRect(),d=g.left-f.left,e=g.top-f.top,c=g.bottom-f.bottom,b=d+g.width/2-this.container.offsetWidth/2,h=e+g.height+this.options.offset,h+this.container.offsetHeight>this.quill.container.offsetHeight&&(h=e-this.container.offsetHeight-this.options.offset),b=Math.max(0,Math.min(b,this.quill.container.offsetWidth-this.container.offsetWidth)),h=Math.max(0,Math.min(h,this.quill.container.offsetHeight-this.container.offsetHeight))):(b=this.quill.container.offsetWidth/2-this.container.offsetWidth/2,h=this.quill.container.offsetHeight/2-this.container.offsetHeight/2),h+=this.quill.container.scrollTop,[b,h]},a.prototype.show=function(a){var b,c,d;return this.range=this.quill.getSelection(),c=this.position(a),b=c[0],d=c[1],this.container.style.left=b+"px",this.container.style.top=d+"px",this.container.focus()},a}(),d.registerModule("tooltip",e),b.exports=e},{"../quill":30}],29:[function(a,b,c){var d,e,f,g;e=a("../quill"),g=e.require("lodash"),d=e.require("delta"),f=function(){function a(a,b){this.quill=a,this.options=null!=b?b:{},this.lastRecorded=0,this.ignoreChange=!1,this.clear(),this.initListeners()}return a.DEFAULTS={delay:1e3,maxStack:100,userOnly:!1},a.hotkeys={UNDO:{key:"Z",metaKey:!0},REDO:{key:"Z",metaKey:!0,shiftKey:!0}},a.prototype.initListeners=function(){return this.quill.onModuleLoad("keyboard",function(b){return function(c){var d;return c.addHotkey(a.hotkeys.UNDO,function(){return b.quill.editor.checkUpdate(),b.undo(),!1}),d=[a.hotkeys.REDO],navigator.platform.indexOf("Win")>-1&&d.push({key:"Y",metaKey:!0}),c.addHotkey(d,function(){return b.quill.editor.checkUpdate(),b.redo(),!1})}}(this)),this.quill.on(this.quill.constructor.events.TEXT_CHANGE,function(a){return function(b,c){return a.ignoreChange?void 0:(a.options.userOnly&&c!==e.sources.USER?a._transform(b):a.record(b,a.oldDelta),a.oldDelta=a.quill.getContents())}}(this))},a.prototype.clear=function(){return this.stack={undo:[],redo:[]},this.oldDelta=this.quill.getContents()},a.prototype.record=function(a,b){var c,d,e,f;if(a.ops.length>0){this.stack.redo=[];try{if(f=this.quill.getContents().diff(this.oldDelta),e=(new Date).getTime(),this.lastRecorded+this.options.delay>e&&this.stack.undo.length>0?(c=this.stack.undo.pop(),f=f.compose(c.undo),a=c.redo.compose(a)):this.lastRecorded=e,this.stack.undo.push({redo:a,undo:f}),this.stack.undo.length>this.options.maxStack)return this.stack.undo.unshift()}catch(g){return d=g,console.warn("Could not record change... clearing undo stack."),this.clear()}}},a.prototype.redo=function(){return this._change("redo","undo")},a.prototype.undo=function(){return this._change("undo","redo")},a.prototype._getLastChangeIndex=function(a){var b,c;return c=0,b=0,g.each(a.ops,function(a){return null!=a.insert?c=Math.max(b+(a.insert.length||1),c):null!=a["delete"]?c=Math.max(b,c):null!=a.retain?(null!=a.attributes&&(c=Math.max(b+a.retain,c)),b+=a.retain):void 0}),c},a.prototype._change=function(a,b){var c,d;return this.stack[a].length>0?(c=this.stack[a].pop(),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(c[a],e.sources.USER),this.ignoreChange=!1,d=this._getLastChangeIndex(c[a]),this.quill.setSelection(d,d),this.oldDelta=this.quill.getContents(),this.stack[b].push(c)):void 0},a.prototype._transform=function(a){var b,c,d,e,f,g,h,i;for(this.oldDelta=a.transform(this.oldDelta,!0),g=this.stack.undo,c=0,e=g.length;e>c;c++)b=g[c],b.undo=a.transform(b.undo,!0),b.redo=a.transform(b.redo,!0);for(h=this.stack.redo,i=[],d=0,f=h.length;f>d;d++)b=h[d],b.undo=a.transform(b.undo,!0),i.push(b.redo=a.transform(b.redo,!0));return i},a}(),e.registerModule("undo-manager",f),b.exports=f},{"../quill":30}],30:[function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o=function(a,b){function c(){this.constructor=a}for(var d in b)p.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},p={}.hasOwnProperty,q=[].slice;l=a("lodash"),n=a("../package.json"),d=a("rich-text/lib/delta"),g=a("eventemitter2").EventEmitter2,m=a("./lib/dom"),e=a("./core/document"),f=a("./core/editor"),h=a("./core/format"),i=a("./core/normalizer"),k=a("./lib/range"),j=function(a){function b(a,c){var d,e,g;if(this.container=a,null==c&&(c={}),l.isString(this.container)&&(this.container=document.querySelector(this.container)),null==this.container)throw new Error("Invalid Quill container");if(e=l.defaults(c.modules||{},b.DEFAULTS.modules),d=this.container.innerHTML,this.container.innerHTML="",this.options=l.defaults(c,b.DEFAULTS),this.options.modules=e,this.options.id=this.id="ql-editor-"+(b.editors.length+1),this.modules={},this.root=this.addContainer("ql-editor"),this.editor=new f(this.root,this,this.options),b.editors.push(this),this.setHTML(d,b.sources.SILENT),g=b.themes[this.options.theme],null==g)throw new Error("Cannot load "+this.options.theme+" theme. Are you sure you registered it?");this.theme=new g(this,this.options),l.each(this.options.modules,function(a){return function(b,c){return a.addModule(c,b)}}(this))}return o(b,a),b.version=n.version,b.editors=[],b.modules=[],b.themes=[],b.DEFAULTS={formats:["align","bold","italic","strike","underline","color","background","font","size","link","image","bullet","list"],modules:{keyboard:!0,"paste-manager":!0,"undo-manager":!0},pollInterval:100,readOnly:!1,styles:{},theme:"base"},b.events={FORMAT_INIT:"format-init",MODULE_INIT:"module-init",POST_EVENT:"post-event",PRE_EVENT:"pre-event",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change"},b.sources=f.sources,b.registerModule=function(a,c){return null!=b.modules[a]&&console.warn("Overwriting "+a+" module"),b.modules[a]=c},b.registerTheme=function(a,c){return null!=b.themes[a]&&console.warn("Overwriting "+a+" theme"),b.themes[a]=c},b.require=function(a){switch(a){case"lodash":return l;case"delta":return d;case"format":return h;case"normalizer":return i;case"dom":return m;case"document":return e;case"range":return k;default:return null}},b.prototype.destroy=function(){var a;return a=this.getHTML(),l.each(this.modules,function(a,b){return l.isFunction(a.destroy)?a.destroy():void 0}),this.editor.destroy(),this.removeAllListeners(),b.editors.splice(l.indexOf(b.editors,this),1),this.container.innerHTML=a},b.prototype.addContainer=function(a,b){var c,d;return null==b&&(b=!1),d=b?this.root:null,c=document.createElement("div"),m(c).addClass(a),this.container.insertBefore(c,d),c},b.prototype.addFormat=function(a,c){return this.editor.doc.addFormat(a,c),this.emit(b.events.FORMAT_INIT,a)},b.prototype.addModule=function(a,c){var d;if(d=b.modules[a],null==d)throw new Error("Cannot load "+a+" module. Are you sure you registered it?");return c===!0&&(c={}),c=l.defaults(c,this.theme.constructor.OPTIONS[a]||{},d.DEFAULTS||{}),this.modules[a]=new d(this,c),this.emit(b.events.MODULE_INIT,a,this.modules[a]),this.modules[a]},b.prototype.deleteText=function(a,c,e){var f,g,h;return null==e&&(e=b.sources.API),h=this._buildParams(a,c,{},e),a=h[0],c=h[1],g=h[2],e=h[3],c>a?(f=(new d).retain(a)["delete"](c-a),this.editor.applyDelta(f,e)):void 0},b.prototype.emit=function(){var a,c;return c=arguments[0],a=2<=arguments.length?q.call(arguments,1):[],b.__super__.emit.apply(this,[b.events.PRE_EVENT,c].concat(q.call(a))),b.__super__.emit.apply(this,[c].concat(q.call(a))),b.__super__.emit.apply(this,[b.events.POST_EVENT,c].concat(q.call(a)))},b.prototype.focus=function(){return this.editor.focus()},b.prototype.formatLine=function(a,b,c,d,e){var f,g,h,i,j;return i=this._buildParams(a,b,c,d,e),a=i[0],b=i[1],f=i[2],e=i[3],j=this.editor.doc.findLineAt(b),g=j[0],h=j[1],null!=g&&(b+=g.length-h),this.formatText(a,b,f,e)},b.prototype.formatText=function(a,b,c,e,f){var g,h,i;return i=this._buildParams(a,b,c,e,f),a=i[0],b=i[1],h=i[2],f=i[3],h=l.reduce(h,function(a){return function(b,c,d){var e;return e=a.editor.doc.formats[d],c&&c!==e.config["default"]||(b[d]=null),b}}(this),h),g=(new d).retain(a).retain(b-a,h),this.editor.applyDelta(g,f)},b.prototype.getBounds=function(a){return this.editor.getBounds(a)},b.prototype.getContents=function(a,b){return null==a&&(a=0),null==b&&(b=null),l.isObject(a)&&(b=a.end,a=a.start),this.editor.delta.slice(a,b)},b.prototype.getHTML=function(){return this.editor.doc.getHTML()},b.prototype.getLength=function(){return this.editor.length},b.prototype.getModule=function(a){return this.modules[a]},b.prototype.getSelection=function(){return this.editor.checkUpdate(),this.editor.selection.getRange()},b.prototype.getText=function(a,b){return null==a&&(a=0),null==b&&(b=null),l.map(this.getContents(a,b).ops,function(a){return l.isString(a.insert)?a.insert:""}).join("")},b.prototype.insertEmbed=function(a,b,c,e){var f,g,h,i;return i=this._buildParams(a,0,b,c,e),a=i[0],g=i[1],h=i[2],e=i[3],f=(new d).retain(a).insert(1,h),this.editor.applyDelta(f,e)},b.prototype.insertText=function(a,b,c,e,f){var g,h,i,j;return j=this._buildParams(a,0,c,e,f),a=j[0],h=j[1],i=j[2],f=j[3],b.length>0?(g=(new d).retain(a).insert(b,i),this.editor.applyDelta(g,f)):void 0},b.prototype.onModuleLoad=function(a,c){return this.modules[a]?c(this.modules[a]):this.on(b.events.MODULE_INIT,function(b,d){return b===a?c(d):void 0})},b.prototype.prepareFormat=function(a,c,d){var e,f;return null==d&&(d=b.sources.API),e=this.editor.doc.formats[a],null!=e&&(f=this.getSelection(),null!=f?f.isCollapsed():void 0)?e.isType(h.types.LINE)?this.formatLine(f,a,c,d):e.prepare(c):void 0},b.prototype.setContents=function(a,c){var e;return null==c&&(c=b.sources.API),a=new d(Array.isArray(a)?a.slice():a.ops.slice()),e=l.last(a.slice(a.length()-1).ops),a["delete"](this.getLength()-1),null!=e&&l.isString(e.insert)&&"\n"===l.last(e.insert)&&a["delete"](1),this.updateContents(a,c)},b.prototype.setHTML=function(a,c){return null==c&&(c=b.sources.API),a.trim()||(a="<"+m.DEFAULT_BLOCK_TAG+"><"+m.DEFAULT_BREAK_TAG+"></"+m.DEFAULT_BLOCK_TAG+">"),this.editor.doc.setHTML(a),this.editor.checkUpdate(c)},b.prototype.setSelection=function(a,c,d){var e;return null==d&&(d=b.sources.API),l.isNumber(a)&&l.isNumber(c)?e=new k(a,c):(e=a,d=c||d),this.editor.selection.setRange(e,d)},b.prototype.setText=function(a,c){var e;return null==c&&(c=b.sources.API),e=(new d).insert(a),this.setContents(e,c)},b.prototype.updateContents=function(a,c){return null==c&&(c=b.sources.API),Array.isArray(a)&&(a={ops:a}),this.editor.applyDelta(a,c)},b.prototype._buildParams=function(){var a,c;return c=1<=arguments.length?q.call(arguments,0):[],l.isObject(c[0])&&c.splice(0,1,c[0].start,c[0].end),l.isString(c[2])&&(a={},a[c[2]]=c[3],c.splice(2,2,a)),null==c[3]&&(c[3]=b.sources.API),c},b}(g),j.registerTheme("base",a("./themes/base")),j.registerTheme("snow",a("./themes/snow")),b.exports=j},{"../package.json":7,"./core/document":8,"./core/editor":9,"./core/format":10,"./core/normalizer":13,"./lib/dom":17,"./lib/range":20,"./themes/base":32,"./themes/snow":33,eventemitter2:2,lodash:1,"rich-text/lib/delta":3}],31:[function(a,b,c){b.exports=""},{}],32:[function(a,b,c){var d,e,f,g;e=a("lodash"),g=a("../../lib/dom"),f=a("./base.styl"),d=function(){function a(b,c){var d;this.quill=b,this.options=c,g(this.quill.container).addClass("ql-container"),this.options.styles&&this.addStyles(f+a.objToCss(this.options.styles)),g.isIE(10)&&(d=g.isIE(9)?"9":"10",g(this.quill.root).addClass("ql-ie-"+d))}return a.OPTIONS={},a.objToCss=function(a){return e.map(a,function(a,b){var c;return c=e.map(a,function(a,b){return b+": "+a+";"}).join(" "),b+" { "+c+" }"}).join("\n")},a.prototype.addStyles=function(b){var c;return e.isObject(b)&&(b=a.objToCss(b)),c=document.createElement("style"),c.type="text/css",c.appendChild(document.createTextNode(b)),document.head.appendChild(c)},a}(),b.exports=d},{"../../lib/dom":17,"./base.styl":31,lodash:1}],33:[function(a,b,c){var d,e,f,g,h,i,j=function(a,b){function c(){this.constructor=a}for(var d in b)k.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},k={}.hasOwnProperty;h=a("lodash"),e=a("../../lib/color-picker"),d=a("../base"),i=a("../../lib/dom"),f=a("../../lib/picker"),g=function(a){function b(a,c){this.quill=a,this.options=c,b.__super__.constructor.apply(this,arguments),i(this.quill.container).addClass("ql-snow"),this.pickers=[],this.quill.on(this.quill.constructor.events.SELECTION_CHANGE,function(a){return function(b){return null!=b?h.invoke(a.pickers,"close"):void 0}}(this)),this.quill.onModuleLoad("multi-cursor",h.bind(this.extendMultiCursor,this)),this.quill.onModuleLoad("toolbar",h.bind(this.extendToolbar,this))}return j(b,a),b.COLORS=["#000000","#e60000","#ff9900","#ffff00","#008A00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],b.OPTIONS={"multi-cursor":{template:'<span class="cursor-flag"> <span class="cursor-triangle top"></span> <span class="cursor-name"></span> <span class="cursor-triangle bottom"></span> </span> <span class="cursor-caret"></span>'}},b.prototype.extendMultiCursor=function(a){return a.on(a.constructor.events.CURSOR_ADDED,function(a){var b,c;return b=a.elem.querySelector(".cursor-triangle.bottom"),c=a.elem.querySelector(".cursor-triangle.top"),b.style.borderTopColor=c.style.borderBottomColor=a.color})},b.prototype.extendToolbar=function(a){return i(a.container).addClass("ql-snow"),h.each(["color","background","font","size","align"],function(b){return function(c){var d,g;if(g=a.container.querySelector(".ql-"+c),null!=g){switch(c){case"font":case"size":case"align":d=new f(g);break;case"color":case"background":d=new e(g),h.each(d.container.querySelectorAll(".ql-picker-item"),function(a,b){return 7>b?i(a).addClass("ql-primary-color"):void 0})}return null!=d?b.pickers.push(d):void 0}}}(this)),h.each(i(a.container).textNodes(),function(a){return 0===i(a).text().trim().length?i(a).remove():void 0})},b}(d),b.exports=g},{"../../lib/color-picker":16,"../../lib/dom":17,"../../lib/picker":19,"../base":32,lodash:1}]},{},[15])(15)}),angular.module("kyle.colorPick",[]).directive("colorPickEle",["colorPickService","$timeout",function(a,b){return{restrict:"A",scope:{baseTarget:"@baseTarget",pickType:"@pickType"},link:function(c,d,e){var f=null;b(function(){f=void 0===c.baseTarget?$(d):$("#"+c.baseTarget),$(d).on("click",function(){a.setType(c.pickType),a.updateOldColor();var b=f.offset().top,d=f.offset().left;a.showDom(d,b)})})}}}]).directive("colorPickBoxEle",["colorPickService",function(a){return{restrict:"A",require:"ngModel",scope:{colorPickBoxEle:"@"},link:function(b,c,d,e){var f=$(c);$(c).on("click",function(){a.setPickTarget(b.colorPickBoxEle),a.setColorHandle(e),a.updateOldColor();var c=f.offset().top+30,d=f.offset().left;a.showBoxDom(d,c)})}}}]).directive("colorPickBox",["userProfile","siteConfig","colorPickService",function(a,b,c){return{restrict:"A",template:['<div class="color-pick-box" id="color-pick-box" drag-ele="default" handle="handle" onmousedown="event.stopPropagation()" onclick="event.stopPropagation()">','    <div class="my-color">','        <div class="title handle">',"            文字颜色",'            <button class="btn btn--xs btn--white btn--icon" lx-ripple ng-click="closeColorPick()"><i class="mdi mdi-close"></i></button>',"        </div>",'        <div class="content-box">','            <div class="row sub-title">','                <span class="left">主题颜色</span><span class="right">更换</span>',"            </div>",'            <div class="row color-list z-depth-1">','                <div class="item" ng-repeat="color in themeColor" ng-click="setColor(color.value)" ng-style="{\'background-color\': color.value}"></div>','                <div style="clear: both"></div>',"            </div>",'            <div class="row sub-title">','                <span class="left">我的颜色</span>',"            </div>",'            <div class="row color-list box-padding">','                <div class="item-round">','                    <div class="round" color-pick-ele pick-type="add" base-target="color-pick-box"><i class="mdi mdi-plus"></i></div>',"                </div>",'                <div class="item-round" ng-repeat="color in myColor track by $index">','                    <div class="round" ng-click="setColor(color)" ng-style="{\'background-color\': color}"></div>',"                </div>",'                <div style="clear: both"></div>',"            </div>",'            <div class="row add-color">','                <i class="mdi mdi-pencil" color-pick-ele  base-target="color-pick-box">编辑颜色</i>',"            </div>","        </div>","    </div>","</div>"].join(""),replace:!0,link:function(d,e,f){d.myColor=a.getMyColor(),d.themeColor=b.getThemeColor(),d.setColor=function(a){c.changeColor(a),c.updateOldColor()},d.closeColorPick=function(){c.hideBoxDom()}}}}]).directive("colorPick",["colorPickService","userProfile","$timeout",function(a,b,c){return{restrict:"A",template:['<div class="color-pick" id="color-pick-select" onmousedown="event.stopPropagation()">','        <div class="color-select-box">','            <div class="color-select-box-handle z-depth-1"></div>','            <div class="color-layer main" ng-style="{\'background-color\':hColor}"></div>','            <div class="color-layer white"></div>','            <div class="color-layer black"></div>',"        </div>",'        <div class="color-line">','            <div class="color-line-handle z-depth-1"></div>','            <img src="images/hue-horizontal.png">',"        </div>",'        <div class="current-color-box">','            <div class="z-depth-1 current-color" style="background-image: url(\'images/point.png\')">','               <div class="handle-box"></div>',"               <div class=\"main\" ng-style=\"{'background-image': 'linear-gradient(to left, rgba(255, 255, 255, 0), '+currentColor+')'}\"></div>","            </div>","        </div>",'        <div class="color-code" ng-init="tabState=0">','           <div class="tc-white-1" flex-container="row">','               <div flex-item="4" flex-item-order="1"><button class="btn btn--m btn--block btn--blue btn--flat" ng-class={true:"active"}[tabState==0] ng-click="tabState=0" lx-ripple>HEX</button></div>','               <div flex-item="4" flex-item-order="1"><button class="btn btn--m btn--block btn--blue btn--flat" ng-class={true:"active"}[tabState==1] ng-click="tabState=1" lx-ripple>RGB</button></div>','               <div flex-item="4" flex-item-order="1"><button class="btn btn--m btn--block btn--blue btn--flat" ng-class={true:"active"}[tabState==2] ng-click="tabState=2" lx-ripple>HSB</button></div>',"           </div>",'           <div class="color-code-box" ng-show="tabState==0">','               <lx-text-field label="HEX">','                   <input type="text" ng-model="inputColor.currentColorHEX" ng-blur="currentColorHEXBlur()" ng-keyup="changeHEX()">',"               </lx-text-field>","           </div>",'           <div class="color-code-box" ng-show="tabState==1">','                <div class="item">','                    <lx-text-field label="R">','                        <input type="text" ng-model="inputColor.currentColorRGB.r" ng-keyup="changeRGB()">',"                    </lx-text-field>","                </div>",'                <div class="item">','                    <lx-text-field label="G">','                        <input type="text" ng-model="inputColor.currentColorRGB.g" ng-keyup="changeRGB()">',"                    </lx-text-field>","                </div>",'                <div class="item">','                    <lx-text-field label="B">','                        <input type="text" ng-model="inputColor.currentColorRGB.b" ng-keyup="changeRGB()">',"                    </lx-text-field>","                </div>","           </div>",'            <div class="color-code-box" ng-show="tabState==2">','                <div class="item">','                    <lx-text-field label="H">','                        <input type="text" ng-model="inputColor.colorHSB.h" ng-keyup="changeHSB()">',"                    </lx-text-field>","                </div>",'                <div class="item">','                    <lx-text-field label="S">','                        <input type="text" ng-model="inputColor.colorHSB.s" ng-keyup="changeHSB()">',"                    </lx-text-field>","                </div>",'                <div class="item">','                    <lx-text-field label="B">','                        <input type="text" ng-model="inputColor.colorHSB.b" ng-keyup="changeHSB()">',"                    </lx-text-field>","                </div>","            </div>","        </div>",'        <div class="bottom-button">','            <div class="item">','                <button class="btn btn--m btn--grey btn--flat" lx-ripple ng-click="cancel()">取消</button>',"            </div>",'            <div class="item">','                <button class="btn btn--m btn--blue btn--flat" lx-ripple ng-click="confirm()">确定</button>',"            </div>","        </div>","    </div>"].join(""),replace:!0,link:function(d,e){function f(b){if(n.flag){var c=b.pageX-n.left;c=n.cx+c,c<-n.handleWidth/2&&(c=-n.handleWidth/2),c>n.eleWidth-n.handleWidth/2&&(c=n.eleWidth-n.handleWidth/2),o.css("left",c),c+=n.handleWidth/2,d.inputColor.colorHSB.h=parseInt(360*(1-c/n.eleWidth)),d.$apply(function(){d.hColor=a.HSBtoHex(d.inputColor.colorHSB.h/360,1,1),d.currentColor=a.HSBtoHex(d.inputColor.colorHSB.h/360,d.inputColor.colorHSB.s/100,d.inputColor.colorHSB.b/100),d.inputColor.currentColorHEX=a.HSBtoHex(d.inputColor.colorHSB.h/360,d.inputColor.colorHSB.s/100,d.inputColor.colorHSB.b/100),d.inputColor.currentColorRGB=a.HSBtoRGB(d.inputColor.colorHSB.h/360,d.inputColor.colorHSB.s/100,d.inputColor.colorHSB.b/100)})}}function g(a){n.flag&&(n.flag=!1)}function h(b){if(q.flag){var c=b.pageX-q.left,e=b.pageY-q.top;c=q.cx+c,e=q.cy+e,c<-q.handleWidth/2&&(c=-q.handleWidth/2),c>q.eleWidth-q.handleWidth/2&&(c=q.eleWidth-q.handleWidth/2),e<-q.handleHeight/2&&(e=-q.handleHeight/2),e>q.eleHeight-q.handleHeight/2&&(e=q.eleHeight-q.handleHeight/2),s.css("left",c),s.css("top",e),c+=q.handleWidth/2,e+=q.handleHeight/2,d.inputColor.colorHSB.s=parseInt(c/q.eleWidth*100),d.inputColor.colorHSB.b=parseInt(100*(1-e/q.eleHeight)),d.$apply(function(){d.currentColor=a.HSBtoHex(d.inputColor.colorHSB.h/360,d.inputColor.colorHSB.s/100,d.inputColor.colorHSB.b/100),d.inputColor.currentColorHEX=a.HSBtoHex(d.inputColor.colorHSB.h/360,d.inputColor.colorHSB.s/100,d.inputColor.colorHSB.b/100),d.inputColor.currentColorRGB=a.HSBtoRGB(d.inputColor.colorHSB.h/360,d.inputColor.colorHSB.s/100,d.inputColor.colorHSB.b/100)})}}function i(a){q.flag&&(q.flag=!1)}function j(a){if(t.flag){var b=a.pageX-t.left;b=t.cx+b,b<-t.handleWidth/2&&(b=-t.handleWidth/2),b>t.eleWidth-t.handleWidth/2&&(b=t.eleWidth-t.handleWidth/2),d.$apply(function(){d.opacity=(1-b/t.eleWidth).toFixed(2)-.03,v.css("left",b)})}}function k(a){t.flag&&(t.flag=!1)}function l(){var b=d.oldColorHandle.value,c=0,e=0,f=0,g=0;-1!==b.indexOf("#")?(d.currentColor=b,d.inputColor.currentColorHEX=b,d.inputColor.currentColorRGB=a.HEXtoRGB(b),d.inputColor.colorHSB=a.RGBtoHSB(d.inputColor.currentColorRGB.r,d.inputColor.currentColorRGB.g,d.inputColor.currentColorRGB.b),d.inputColor.colorHSB.h=parseInt(360*d.inputColor.colorHSB.h),d.inputColor.colorHSB.s=parseInt(100*d.inputColor.colorHSB.s),d.inputColor.colorHSB.b=parseInt(100*d.inputColor.colorHSB.b),d.hColor=a.HSBtoHex(d.inputColor.colorHSB.h/360,1,1),d.opacity=1,c=(1-d.opacity)*t.eleWidth-t.handleWidth/2,v.css("left",c+"px"),e=(1-d.inputColor.colorHSB.h/360)*n.eleWidth-n.handleWidth/2,o.css("left",e+"px"),
f=d.inputColor.colorHSB.s/100*q.eleWidth-q.handleWidth/2,s.css({left:f+"PX"}),g=(1-d.inputColor.colorHSB.b/100)*q.eleHeight-q.handleHeight/2,s.css({top:g+"px"})):-1!==b.indexOf("rgba")?(b.replace(/\s/g,""),b=b.substring(5,b.length-1).split(","),d.inputColor.currentColorRGB.r=b[0],d.inputColor.currentColorRGB.g=b[1],d.inputColor.currentColorRGB.b=b[2],d.opacity=b[3],d.inputColor.colorHSB=a.RGBtoHSB(b[0],b[1],b[2]),d.inputColor.colorHSB.h=parseInt(360*d.inputColor.colorHSB.h),d.inputColor.colorHSB.s=parseInt(100*d.inputColor.colorHSB.s),d.inputColor.colorHSB.b=parseInt(100*d.inputColor.colorHSB.b),d.hColor=a.HSBtoHex(d.inputColor.colorHSB.h/360,1,1),d.currentColor=a.HSBtoHex(d.inputColor.colorHSB.h/360,d.inputColor.colorHSB.s/100,d.inputColor.colorHSB.b/100),d.inputColor.currentColorHEX=a.HSBtoHex(d.inputColor.colorHSB.h/360,d.inputColor.colorHSB.s/100,d.inputColor.colorHSB.b/100),c=(1-d.opacity)*t.eleWidth-t.handleWidth/2,v.css("left",c+"px"),e=(1-d.inputColor.colorHSB.h/360)*n.eleWidth-n.handleWidth/2,o.css("left",e+"px"),f=d.inputColor.colorHSB.s/100*q.eleWidth-q.handleWidth/2,s.css({left:f+"PX"}),g=(1-d.inputColor.colorHSB.b/100)*q.eleHeight-q.handleHeight/2,s.css({top:g+"px"})):(b.replace(/\s/g,""),b=b.substring(4,b.length-1).split(","),d.inputColor.currentColorRGB.r=b[0],d.inputColor.currentColorRGB.g=b[1],d.inputColor.currentColorRGB.b=b[2],d.opacity=1,d.inputColor.colorHSB=a.RGBtoHSB(b[0],b[1],b[2]),d.inputColor.colorHSB.h=parseInt(360*d.inputColor.colorHSB.h),d.inputColor.colorHSB.s=parseInt(100*d.inputColor.colorHSB.s),d.inputColor.colorHSB.b=parseInt(100*d.inputColor.colorHSB.b),d.hColor=a.HSBtoHex(d.inputColor.colorHSB.h/360,1,1),d.currentColor=a.HSBtoHex(d.inputColor.colorHSB.h/360,d.inputColor.colorHSB.s/100,d.inputColor.colorHSB.b/100),d.inputColor.currentColorHEX=a.HSBtoHex(d.inputColor.colorHSB.h/360,d.inputColor.colorHSB.s/100,d.inputColor.colorHSB.b/100),c=(1-d.opacity)*t.eleWidth-t.handleWidth/2,v.css("left",c+"px"),e=(1-d.inputColor.colorHSB.h/360)*n.eleWidth-n.handleWidth/2,o.css("left",e+"px"),f=d.inputColor.colorHSB.s/100*q.eleWidth-q.handleWidth/2,s.css({left:f+"PX"}),g=(1-d.inputColor.colorHSB.b/100)*q.eleHeight-q.handleHeight/2,s.css({top:g+"px"}))}d.currentColor="#ffffff",d.pastColor="#ffffff",d.hColor="#ff0000",d.inputColor={colorHSB:{h:360,s:0,b:100},currentColorHEX:"#ffffff",currentColorRGB:{r:255,g:255,b:255}},d.opacity=1;var m=$(e);d.changePastColor=function(a){d.pastColor=a},d.changeCurrentColor=function(a){d.currentColor=a};var n={flag:!1,left:0,cx:0,eleWidth:0,handleWidth:0},o=$(e).find(".color-line .color-line-handle"),p=$(e).find(".color-line");c(function(){n.eleWidth=parseInt(p.width()),n.handleWidth=parseInt(o.width())}),p.on("mousedown",function(b){b.stopPropagation(),b.preventDefault(),n.flag=!0,n.left=o.offset().left,n.cx=parseInt(o.css("left"));var c=b.pageX-n.left;c=n.cx+c-n.handleWidth/2,c<-n.handleWidth/2&&(c=-n.handleWidth/2),c>n.eleWidth-n.handleWidth/2&&(c=n.eleWidth-n.handleWidth/2),o.css("left",c),c+=n.handleWidth/2,d.inputColor.colorHSB.h=parseInt(360*(1-c/n.eleWidth)),d.$apply(function(){d.hColor=a.HSBtoHex(d.inputColor.colorHSB.h/360,1,1),d.currentColor=a.HSBtoHex(d.inputColor.colorHSB.h/360,d.inputColor.colorHSB.s/100,d.inputColor.colorHSB.b/100),d.inputColor.currentColorHEX=a.HSBtoHex(d.inputColor.colorHSB.h/360,d.inputColor.colorHSB.s/100,d.inputColor.colorHSB.b/100),d.inputColor.currentColorRGB=a.HSBtoRGB(d.inputColor.colorHSB.h/360,d.inputColor.colorHSB.s/100,d.inputColor.colorHSB.b/100)})}),$(document).on("mousemove",f),$(document).on("mouseup",g);var q={flag:!1,left:0,top:0,cx:0,cy:0,eleWidth:0,eleHeight:0,handleWidth:0,handleHeight:0},r=$(e).find(".color-select-box"),s=$(e).find(".color-select-box .color-select-box-handle");c(function(){q.eleWidth=parseInt(r.width()),q.eleHeight=parseInt(r.height()),q.handleWidth=parseInt(s.width()),q.handleHeight=parseInt(s.height())}),r.on("mousedown",function(b){b.stopPropagation(),b.preventDefault(),q.flag=!0,q.left=s.offset().left,q.top=s.offset().top,q.cx=parseInt(s.css("left")),q.cy=parseInt(s.css("top"));var c=b.pageX-q.left,e=b.pageY-q.top;c=q.cx+c-q.handleWidth/2,e=q.cy+e-q.handleHeight/2,c<-q.handleWidth/2&&(c=-q.handleWidth/2),c>q.eleWidth-q.handleWidth/2&&(c=q.eleWidth-q.handleWidth/2),e<-q.handleHeight/2&&(e=-q.handleHeight/2),e>q.eleHeight-q.handleHeight/2&&(e=q.eleHeight-q.handleHeight/2),s.css("left",c),s.css("top",e),c+=q.handleWidth/2,e+=q.handleHeight/2,d.inputColor.colorHSB.s=parseInt(c/q.eleWidth*100),d.inputColor.colorHSB.b=parseInt(100*(1-e/q.eleHeight)),d.$apply(function(){d.currentColor=a.HSBtoHex(d.inputColor.colorHSB.h/360,d.inputColor.colorHSB.s/100,d.inputColor.colorHSB.b/100),d.inputColor.currentColorHEX=a.HSBtoHex(d.inputColor.colorHSB.h/360,d.inputColor.colorHSB.s/100,d.inputColor.colorHSB.b/100),d.inputColor.currentColorRGB=a.HSBtoRGB(d.inputColor.colorHSB.h/360,d.inputColor.colorHSB.s/100,d.inputColor.colorHSB.b/100)})}),$(document).on("mousemove",h),$(document).on("mouseup",i);var t={flag:!1,left:0,cx:0,eleWidth:0,handleWidth:0},u=$(e).find(".current-color-box .current-color"),v=$(u).find(".handle-box");c(function(){t.eleWidth=parseInt(u.width()),t.handleWidth=parseInt(v.width())}),u.on("mousedown",function(a){a.stopPropagation(),a.preventDefault(),t.flag=!0,t.left=v.offset().left,t.cx=parseInt(v.css("left"));var b=a.pageX-t.left;b=t.cx+b-t.handleWidth/2,b<-t.handleWidth/2&&(b=-t.handleWidth/2),b>t.eleWidth-t.handleWidth/2&&(b=t.eleWidth-t.handleWidth/2),d.$apply(function(){d.opacity=(1-b/t.eleWidth).toFixed(2)-.03,v.css("left",b)})}),$(document).on("mousemove",j),$(document).on("mouseup",k),d.currentColorHEXBlur=function(){var a=/^#[0-9a-fA-F]{6}$/;if(null===d.inputColor.currentColorHEX.match(a)){d.inputColor.currentColorHEX="#ffffff";var b=-q.handleWidth/2,c=-q.handleHeight/2;s.css({left:b+"px",top:c+"px"})}d.currentColor="#ffffff",d.inputColor.currentColorRGB.r=255,d.inputColor.currentColorRGB.g=255,d.inputColor.currentColorRGB.b=255,d.inputColor.colorHSB.s=0,d.inputColor.colorHSB.b=100},d.changeHEX=function(){var b=/^#[0-9a-fA-F]{6}$/,c=0,e=0,f=0;null===d.inputColor.currentColorHEX.match(b)&&d.inputColor.currentColorHEX.length>=7&&(d.inputColor.currentColorHEX="#ffffff",d.currentColor="#ffffff",d.inputColor.currentColorRGB.r=255,d.inputColor.currentColorRGB.g=255,d.inputColor.currentColorRGB.b=255,d.inputColor.colorHSB.s=0,d.inputColor.colorHSB.b=100,c=(1-d.inputColor.colorHSB.h/360)*n.eleWidth-n.handleWidth/2,o.css("left",c+"px"),e=d.inputColor.colorHSB.s/100*q.eleWidth-q.handleWidth/2,s.css({left:e+"PX"}),f=(1-d.inputColor.colorHSB.b/100)*q.eleHeight-q.handleHeight/2,s.css({top:f+"px"})),null!==d.inputColor.currentColorHEX.match(b)&&7===d.inputColor.currentColorHEX.length&&(d.currentColor=d.inputColor.currentColorHEX,d.inputColor.currentColorRGB=a.HEXtoRGB(d.inputColor.currentColorHEX),d.inputColor.colorHSB=a.RGBtoHSB(d.inputColor.currentColorRGB.r,d.inputColor.currentColorRGB.g,d.inputColor.currentColorRGB.b),d.inputColor.colorHSB.h=parseInt(360*d.inputColor.colorHSB.h),d.inputColor.colorHSB.s=parseInt(100*d.inputColor.colorHSB.s),d.inputColor.colorHSB.b=parseInt(100*d.inputColor.colorHSB.b),d.hColor=a.HSBtoHex(d.inputColor.colorHSB.h/360,1,1),c=(1-d.inputColor.colorHSB.h/360)*n.eleWidth-n.handleWidth/2,o.css("left",c+"px"),e=d.inputColor.colorHSB.s/100*q.eleWidth-q.handleWidth/2,s.css({left:e+"PX"}),f=(1-d.inputColor.colorHSB.b/100)*q.eleHeight-q.handleHeight/2,s.css({top:f+"px"}))},d.changeRGB=function(){(d.inputColor.currentColorRGB.r<0||d.inputColor.currentColorRGB.r>255)&&(d.inputColor.currentColorRGB.r=255),(d.inputColor.currentColorRGB.g<0||d.inputColor.currentColorRGB.g>255)&&(d.inputColor.currentColorRGB.g=255),(d.inputColor.currentColorRGB.b<0||d.inputColor.currentColorRGB.b>255)&&(d.inputColor.currentColorRGB.b=255),d.inputColor.colorHSB=a.RGBtoHSB(d.inputColor.currentColorRGB.r,d.inputColor.currentColorRGB.g,d.inputColor.currentColorRGB.b),d.inputColor.colorHSB.h=parseInt(360*d.inputColor.colorHSB.h),d.inputColor.colorHSB.s=parseInt(100*d.inputColor.colorHSB.s),d.inputColor.colorHSB.b=parseInt(100*d.inputColor.colorHSB.b),d.hColor=a.HSBtoHex(d.inputColor.colorHSB.h/360,1,1),d.currentColor=a.HSBtoHex(d.inputColor.colorHSB.h/360,d.inputColor.colorHSB.s/100,d.inputColor.colorHSB.b/100),d.inputColor.currentColorHEX=a.HSBtoHex(d.inputColor.colorHSB.h/360,d.inputColor.colorHSB.s/100,d.inputColor.colorHSB.b/100);var b=(1-d.inputColor.colorHSB.h/360)*n.eleWidth-n.handleWidth/2;o.css("left",b+"px");var c=d.inputColor.colorHSB.s/100*q.eleWidth-q.handleWidth/2;s.css({left:c+"PX"});var e=(1-d.inputColor.colorHSB.b/100)*q.eleHeight-q.handleHeight/2;s.css({top:e+"px"})},d.changeHSB=function(){(d.inputColor.colorHSB.h<0||d.inputColor.colorHSB.h>360)&&(d.inputColor.colorHSB.h=360),(d.inputColor.colorHSB.s<0||d.inputColor.colorHSB.s>100)&&(d.inputColor.colorHSB.s=0),(d.inputColor.colorHSB.b<0||d.inputColor.colorHSB.b>100)&&(d.inputColor.colorHSB.b=100),d.hColor=a.HSBtoHex(d.inputColor.colorHSB.h/360,1,1),d.currentColor=a.HSBtoHex(d.inputColor.colorHSB.h/360,d.inputColor.colorHSB.s/100,d.inputColor.colorHSB.b/100),d.inputColor.currentColorHEX=a.HSBtoHex(d.inputColor.colorHSB.h/360,d.inputColor.colorHSB.s/100,d.inputColor.colorHSB.b/100),d.inputColor.currentColorRGB=a.HSBtoRGB(d.inputColor.colorHSB.h/360,d.inputColor.colorHSB.s/100,d.inputColor.colorHSB.b/100);var b=(1-d.inputColor.colorHSB.h/360)*n.eleWidth-n.handleWidth/2;o.css("left",b+"px");var c=d.inputColor.colorHSB.s/100*q.eleWidth-q.handleWidth/2;s.css({left:c+"PX"});var e=(1-d.inputColor.colorHSB.b/100)*q.eleHeight-q.handleHeight/2;s.css({top:e+"px"})},d.oldColorHandle=a.getOldColorHandle(),d.$watch("oldColorHandle",function(){l()},!0),d.colorPickType=a.getType(),d.cancel=function(){"default"===d.colorPickType.value&&(a.changeColor(a.getOldColor()),l()),m.hide()},d.confirm=function(){if("add"===d.colorPickType.value){var a="rgba("+d.inputColor.currentColorRGB.r+","+d.inputColor.currentColorRGB.g+","+d.inputColor.currentColorRGB.b+","+d.opacity+")";b.addMyColor(a),l()}m.hide()},d.$watch("inputColor.currentColorRGB",function(){if("default"===d.colorPickType.value){var b="rgba("+d.inputColor.currentColorRGB.r+","+d.inputColor.currentColorRGB.g+","+d.inputColor.currentColorRGB.b+","+d.opacity+")";a.changeColor(b)}},!0),d.$watch("opacity",function(){if("default"===d.colorPickType.value){var b="rgba("+d.inputColor.currentColorRGB.r+","+d.inputColor.currentColorRGB.g+","+d.inputColor.currentColorRGB.b+","+d.opacity+")";a.changeColor(b)}},!0),d.$on("$destroy",function(){$(document).off("mousemove",j),$(document).off("mouseup",k),$(document).off("mousemove",h),$(document).off("mouseup",i),$(document).off("mousemove",f),$(document).off("mouseup",g)})}}}]).factory("colorPickService",["$rootScope","$compile","textEditorService",function(a,b,c){var d={ID:"oldColor",value:""},e={ID:"colorHandle",value:""},f={ID:"colorPick",value:""},g={ID:"colorPickBox",value:""},h={ID:"colorPickType",value:"default"},i="",j={setPickTarget:function(a){i=a},getPickTarget:function(){return i},removePlugin:function(){""!==f.value&&(f.value.remove(),f.value=""),""!==g.value&&(g.value.remove(),g.value="")},updateOldColor:function(){d.value=e.value.$viewValue},getOldColorHandle:function(){return d},getOldColor:function(){return d.value},getType:function(){return h},setType:function(a){void 0===a?h.value="default":h.value=a},setColorHandle:function(a){e.value=a},changeColor:function(a){"editorColor"===this.getPickTarget()&&c.formatText("color",a),"editorBackground"===this.getPickTarget()&&(("rgba(255,255,255,1)"===a||"#ffffff"===a||"#FFFFFF"===a||"rgb(255,255,255)"===a)&&(a="rgba(254,255,255,1)"),c.formatText("background",a)),e.value.$setViewValue(a)},getDefaultColor:function(){return"#ffffff"},createDom:function(c,d){var e=b("<div color-pick></div>")(a);e=$(e),$("body").append(e),f.value=e,f.value.show();var g=parseInt(f.value.height()),h=parseInt($("body").height());d+g>h&&(d-=d+g-h),f.value.css({left:c,top:d})},createBoxDom:function(c,d){var e=b("<div color-pick-box></div>")(a);e=$(e),$("body").append(e),g.value=e,g.value.show();var f=parseInt(g.value.height()),h=parseInt($("body").height());d+f>h&&(d-=d+f-h),g.value.css({left:c,top:d})},showDom:function(a,b){if(""===f.value)j.createDom(a,b);else{f.value.show();var c=parseInt(f.value.height()),d=parseInt($("body").height());b+c>d&&(b-=b+c-d),f.value.css({left:a,top:b})}},showBoxDom:function(a,b){if(""===g.value)j.createBoxDom(a,b);else{g.value.show();var c=parseInt(g.value.height()),d=parseInt($("body").height());b+c>d&&(b-=b+c-d),g.value.css({left:a,top:b})}},hideBoxDom:function(){""!==g.value&&g.value.hide()},hideDom:function(){""!==f.value&&f.value.hide()},HSBtoRGB:function(a,b,c){a||(a=1),a*=360;var d,e,f,g,h;return a=a%360/60,h=c*b,g=h*(1-Math.abs(a%2-1)),d=e=f=c-h,a=~~a,d+=[h,g,0,0,g,h][a],e+=[g,h,h,g,0,0][a],f+=[0,0,g,h,h,g][a],{r:Math.round(255*d),g:Math.round(255*e),b:Math.round(255*f)}},HSBtoHex:function(a,b,c){var d=this.HSBtoRGB(a,b,c);return this.rgbaIsTransparent(d)?"transparent":"#"+(1<<24|parseInt(d.r)<<16|parseInt(d.g)<<8|parseInt(d.b)).toString(16).substr(1)},RGBtoHSB:function(a,b,c){a/=255,b/=255,c/=255;var d,e,f,g;return f=Math.max(a,b,c),g=f-Math.min(a,b,c),d=0===g?null:f===a?(b-c)/g:f===b?(c-a)/g+2:(a-b)/g+4,d=(d+360)%6*60/360,e=0===g?0:g/f,{h:this._sanitizeNumber(d),s:e,b:f}},_sanitizeNumber:function(a){return"number"==typeof a?a:isNaN(a)||null===a||""===a||void 0===a?1:void 0!==a.toLowerCase?parseFloat(a):1},HEXtoRGB:function(a){var b=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/,c=a.toLowerCase(),d=0;if(c&&b.test(c)){if(4===c.length){var e="#";for(d=1;4>d;d+=1)e+=c.slice(d,d+1).concat(c.slice(d,d+1));c=e}var f=[];for(d=1;7>d;d+=2)f.push(parseInt("0x"+c.slice(d,d+2)));var g={r:0,g:0,b:0};return g.r=f[0],g.g=f[1],g.b=f[2],g}return c},rgbaIsTransparent:function(a){return 0===a.r&&0===a.g&&0===a.b&&0===a.a}};return j}]),angular.module("kyle.editor",[]).directive("fullText",["textEditorService",function(a){return{restrict:"A",link:function(b,c){function d(a,b){var c={font:"微软雅黑",size:0,Bold:!1,Italic:!1,Underline:!1,color:"rgba(255,255,255,1)",background:"rgba(255,255,255,0)",Strikethrough:!1,align:"left",lineHeight:"100",space:"0"},d=f.getContents(a,b);d=d.ops;var g=$(f.getHTML());"left"===g.css("text-align")||"center"===g.css("text-align")||"right"===g.css("text-align")?c.align=g.css("text-align"):c.align="left";for(var h=0;h<d.length;h++)void 0!==d[h].attributes&&10!==d[h].insert.charCodeAt()&&(0===h?(c.font=d[h].attributes.font||"Arial",c.size=d[h].attributes.size||0,c.Bold=d[h].attributes.bold||!1,c.Strikethrough=d[h].attributes.strikethrough||!1,c.Italic=d[h].attributes.italic||!1,c.Underline=d[h].attributes.underline||!1,c.color=d[h].attributes.color||"rgba(255,255,255,1)",c.background=d[h].attributes.background||"rgba(255,255,255,0)"):(c.font!==d[h].attributes.font&&(c.font="Arial"),c.size!==d[h].attributes.size&&(c.size=0),c.Bold!==d[h].attributes.bold&&(c.Bold=!1),c.Strikethrough!==d[h].attributes.strikethrough&&(c.Strikethrough=!1),c.Italic!==d[h].attributes.italic&&(c.Italic=!1),c.Underline!==d[h].attributes.underline&&(c.Underline=!1),c.color!==d[h].attributes.color&&(c.color="rgba(255,255,255,1)"),c.background!==d[h].attributes.background&&(c.background="rgba(255,255,255,0)")));return""!==c.size&&(c.size=parseInt(c.size)),c.lineHeight=parseInt(e.css("line-height")),c.spacing=parseInt(e.css("letter-spacing")),c}var e=$(c).find(".ele"),f=new Quill(e.get(0)),g={};c.on("dblclick",function(){var b=$(c).attr("multiple-choice");"true"!==b&&(a.setEditorHandle(f),e.find(".ql-editor").attr("contenteditable",!0),e.find(".ql-editor").addClass("open-user-select"),e.find(".ql-editor").focus(),f.setSelection(0,f.getLength(),"user"))}),f.on("selection-change",function(c,e){"api"!==e&&c&&(a.setRange(c),g.start=c.start,g.end=c.end,c.start===c.end?void 0===f.getContents(c.start,c.start+1).ops[0].attributes?b.$apply(function(){a.setTextData(d(c.start-1,c.end))}):b.$apply(function(){a.setTextData(d(c.start,c.end+1))}):b.$apply(function(){a.setTextData(d(c.start,c.end))}))})}}}]).directive("editorSizeBox",["textEditorService",function(a){return{restrict:"A",template:['<div class="tool-modal" drag-ele="default" handle="handle" onmousedown=event.stopPropagation()>','        <div class="title handle">',"            文字大小",'            <button class="btn btn--xs btn--white btn--icon right-button" lx-ripple="" ng-click="closeSizeBox()"><i class="mdi mdi-close"></i></button>',"        </div>",'        <div class="content-max content">','           <perfect-scrollbar class="scroller" wheel-propagation="true" wheel-speed="5">','               <div class="slide-box" ng-model="textData.value.size" text-editor-slider slide-type="size" max-value="100"><div class="slide-value">{{textData.value.size}}</div><div class="slide-line z-depth-1"><div class="slide-point z-depth-1"></div></div></div>','               <div class="item" ng-click="setFontSize(\'18px\')" ng-style={"font-size":"18px"}><span>ABCD</span></div>','               <div class="item" ng-click="setFontSize(\'28px\')" ng-style={"font-size":"28px"}><span>ABCD</span></div>','               <div class="item" ng-click="setFontSize(\'38px\')" ng-style={"font-size":"38px"}><span>ABCD</span></div>',"           </perfect-scrollbar>","        </div>","    </div>"].join(""),replace:!0,link:function(b,c){b.closeSizeBox=function(){a.hideSetSizeBox()},b.setFontSize=function(b){a.formatText("size",b)}}}}]).directive("textEditorSlider",["$timeout","textEditorService",function(a,b){return{restrict:"A",require:"ngModel",link:function(c,d,e,f){function g(a){f.$setViewValue(a),b.formatText(e.slideType,a+"px")}a(function(){function a(a){if(h.flag){var b=a.pageX-h.left;b=h.cx+b,b<-h.handleWidth/2&&(b=-h.handleWidth/2),b>h.eleWidth-h.handleWidth/2&&(b=h.eleWidth-h.handleWidth/2),i.css("left",b),b+=h.handleWidth/2;var d=(b/h.eleWidth).toFixed(2);c.$apply(function(){g(parseInt(d*e.maxValue))})}}function b(a){h.flag&&(h.flag=!1)}f.$formatters.push(function(){var a=f.$modelValue/e.maxValue*h.eleWidth-h.handleWidth/2;i.css("left",a+"px")});var h={},i=$(d).find(".slide-point");h.handleWidth=i.width(),h.eleWidth=d.find(".slide-line").get(0).clientWidth,i.css("left",f.$modelValue/e.maxValue*h.eleWidth-h.handleWidth/2+"px"),$(d).find(".slide-line").on("mousedown",function(a){a.stopPropagation(),a.preventDefault(),h.flag=!0,h.left=i.offset().left,h.cx=parseInt(i.css("left"));var b=a.pageX-h.left;b=h.cx+b-h.handleWidth/2,b<-h.handleWidth/2&&(b=-h.handleWidth/2),b>h.eleWidth-h.handleWidth/2&&(b=h.eleWidth-h.handleWidth/2),i.css("left",b),b+=h.handleWidth/2;var d=(b/h.eleWidth).toFixed(2);c.$apply(function(){g(parseInt(d*e.maxValue))})}),$(document).on("mousemove",a),$(document).on("mouseup",b),c.$on("$destroy",function(){$(document).off("mousemove",a),$(document).off("mouseup",b)})})}}}]).directive("editorFontBox",["textEditorService","fontList",function(a,b){return{restrict:"A",template:['<div class="tool-modal" drag-ele="default" handle="handle" onmousedown=event.stopPropagation()>','        <div class="title handle">',"            字体",'            <button class="btn btn--xs btn--white btn--icon right-button" lx-ripple="" ng-click="closeFontBox()"><i class="mdi mdi-close"></i></button>',"        </div>",'        <div class="option"><button class="btn btn--m btn--white btn--raised" ng-class="{true:\'active\'}[activeTab==0]" ng-click="activeTab=0" lx-ripple>中文</button> <button class="btn btn--m btn--white btn--raised" ng-class="{true:\'active\'}[activeTab==1]" ng-click="activeTab=1" lx-ripple>英文</button></div>','        <div class="content" ng-show="activeTab==0">','           <perfect-scrollbar class="scroller" wheel-propagation="true" wheel-speed="5">','               <div class="item" ng-click="setFontType(font)" ng-repeat="font in cnFontList track by $index" ng-style={"font-family":font}><span>{{font}}</span></div>',"           </perfect-scrollbar>","        </div>",'        <div class="content" ng-show="activeTab==1">','           <perfect-scrollbar class="scroller" wheel-propagation="true" wheel-speed="5">','               <div class="item" ng-click="setFontType(font)" ng-repeat="font in enFontList track by $index" ng-style={"font-family":font}><span>{{font}}</span></div>',"           </perfect-scrollbar>","        </div>","    </div>"].join(""),replace:!0,link:function(c,d){c.closeFontBox=function(){a.hideSetFontBox()},c.activeTab=0,c.enFontList=b.getList("en"),c.cnFontList=b.getList("cn"),c.setFontType=function(b){a.formatText("font",b)}}}}]).directive("editorSpacingBox",["textEditorService",function(a){return{restrict:"A",template:['<div class="tool-modal" drag-ele="default" handle="handle" onmousedown=event.stopPropagation()>','        <div class="title handle">',"            间距",'            <button class="btn btn--xs btn--white btn--icon right-button" lx-ripple="" ng-click="closeSpacingBox()"><i class="mdi mdi-close"></i></button>',"        </div>",'        <div class="content-max content">','           <perfect-scrollbar class="scroller" wheel-propagation="true" wheel-speed="5">','               <div class="slide-box" ng-model="textData.value.spacing" text-editor-slider slide-type="spacing" max-value="60"><div class="slide-value">{{textData.value.spacing}}</div><div class="slide-line z-depth-1"><div class="slide-point z-depth-1"></div></div></div>','               <div class="item" ng-click="setSpacingSize(\'5px\')" ng-style={"letter-spacing":"5px"}><span>ABCD</span></div>','               <div class="item" ng-click="setSpacingSize(\'10px\')" ng-style={"letter-spacing":"10px"}><span>ABCD</span></div>','               <div class="item" ng-click="setSpacingSize(\'15px\')" ng-style={"letter-spacing":"15px"}><span>ABCD</span></div>',"           </perfect-scrollbar>","        </div>","    </div>"].join(""),replace:!0,link:function(b,c){b.closeSpacingBox=function(){a.hideSetSpacingBox()},b.setSpacingSize=function(b){a.formatText("spacing",b)}}}}]).directive("editorLineHeightBox",["textEditorService",function(a){return{restrict:"A",template:['<div class="tool-modal" drag-ele="default" handle="handle" onmousedown=event.stopPropagation()>','        <div class="title handle">',"            行高",'            <button class="btn btn--xs btn--white btn--icon right-button" lx-ripple="" ng-click="closeLineHeightBox()"><i class="mdi mdi-close"></i></button>',"        </div>",'        <div class="content-max content">','           <perfect-scrollbar class="scroller" wheel-propagation="true" wheel-speed="5">','               <div class="slide-box" ng-model="textData.value.lineHeight" text-editor-slider slide-type="lineHeight" max-value="100"><div class="slide-value">{{textData.value.lineHeight}}</div><div class="slide-line z-depth-1"><div class="slide-point z-depth-1"></div></div></div>','               <div class="item" ng-click="setLineHeightSize(\'20px\')" ng-style={"line-height":"20px"}><span>ABCD<br>EFG</span></div>','               <div class="item" ng-click="setLineHeightSize(\'30px\')" ng-style={"line-height":"30px"}><span>ABCD<br>EFG</span></div>','               <div class="item" ng-click="setLineHeightSize(\'40px\')" ng-style={"line-height":"40px"}><span>ABCD<br>EFG</span></div>',"           </perfect-scrollbar>","        </div>","    </div>"].join(""),replace:!0,link:function(b,c){b.closeLineHeightBox=function(){a.hideSetLineHeightBox()}}}}]).directive("textEditor",["userProfile","siteConfig","colorPickService","textEditorService",function(a,b,c,d){return{restrict:"A",template:['<div class="text-editor z-depth-2" drag-ele="default" handle="handle" ng-mousedown="$event.stopPropagation();closeAllMenu();">','    <div class="handle"><i class="mdi mdi-drag-vertical"></i></div>','    <div class="content-box">','        <div class="row">','            <div class="item">','                <i class="mdi mdi-format-text icon-label"></i>','                <button class="btn btn--m btn--white btn--raised" ng-click="setFont($event)" lx-ripple><span>{{textData.value.font}}</span><i','                        class="mdi mdi-menu-down right"></i></button>',"            </div>",'            <div class="item">','                <i class="mdi mdi-format-size icon-label"></i>','                <button class="btn btn--m btn--white btn--raised" ng-click="setSize($event)" lx-ripple><span>{{textData.value.size}}px</span><i','                        class="mdi mdi-menu-down right"></i></button>',"            </div>",'            <div class="item">','                <button class="btn btn--m btn--black btn--flat icon-button" ng-click="setAlign(\'left\')" ng-class="{true:\'active\'}[textData.value.align==\'left\']" lx-ripple><i class="mdi mdi-format-align-left"></i></button>','                <button class="btn btn--m btn--black btn--flat icon-button" ng-click="setAlign(\'center\')" ng-class="{true:\'active\'}[textData.value.align==\'center\']" lx-ripple><i class="mdi mdi-format-align-center"></i></button>','                <button class="btn btn--m btn--black btn--flat icon-button" ng-click="setAlign(\'right\')" ng-class="{true:\'active\'}[textData.value.align==\'right\']" lx-ripple><i class="mdi mdi-format-align-right"></i></button>',"            </div>",'            <div class="item">','                <div class="line"></div>',"            </div>",'            <div class="item">','                <button class="btn btn--m btn--black btn--flat icon-button" ng-click="setBold()" lx-ripple ng-class="{true:\'active\'}[textData.value.Bold]"><i class="mdi mdi-format-bold"></i></button>','                <button class="btn btn--m btn--black btn--flat icon-button" ng-click="setItalic()" lx-ripple ng-class="{true:\'active\'}[textData.value.Italic]"><i class="mdi mdi-format-italic"></i></button>','                <button class="btn btn--m btn--black btn--flat icon-button" ng-click="setUnderline()" lx-ripple ng-class="{true:\'active\'}[textData.value.Underline]"><i class="mdi mdi-format-underline"></i></button>','                <button class="btn btn--m btn--black btn--flat icon-button" ng-click="setStrikethrough()" lx-ripple ng-class="{true:\'active\'}[textData.value.Strikethrough]"><i class="mdi mdi-format-clear"></i></button>',"            </div>","        </div>",'        <div class="row">','            <div class="item">','                <i class="mdi mdi-format-line-spacing icon-label"></i>','                <button class="btn btn--m btn--white btn--raised" ng-click="setLineHeight($event)" lx-ripple><span>{{textData.value.lineHeight}}px</span><i','                        class="mdi mdi-menu-down right"></i></button>',"            </div>",'            <div class="item">','                <i class="mdi mdi-alphabetical icon-label"></i>','                <button class="btn btn--m btn--white btn--raised"  ng-click="setSpacing($event)" lx-ripple><span>{{textData.value.spacing}}px</span><i','                        class="mdi mdi-menu-down right"></i></button>',"            </div>",'            <div class="item">','                <i class="mdi mdi-invert-colors icon-label"></i>','                <button class="btn btn--m btn--white btn--raised color-button" color-pick-box-ele="editorColor" ng-model="textData.value.color" lx-ripple>','                    <div class="color-box" ng-style="{\'background-color\':textData.value.color}">',"                    </div>",'                    <div class="color-box-bg" style="background-image:url(\'images/point.png\')"></div>','                    <i class="mdi mdi-menu-down right"></i></button>',"            </div>",'            <div class="item">','                <i class="mdi mdi-format-color-fill icon-label"></i>','                <button class="btn btn--m btn--white btn--raised color-button" color-pick-box-ele="editorBackground" ng-model="textData.value.background" lx-ripple>','                    <div class="color-box" ng-style="{\'background-color\':textData.value.background}">',"                    </div>",'                    <div class="color-box-bg" style="background-image:url(\'images/point.png\')"></div>','                    <i class="mdi mdi-menu-down right"></i></button>',"            </div>",'            <div class="item">','                <div class="line"></div>',"            </div>",'            <div class="item">','                <button class="btn btn--m btn--black btn--flat icon-button" ng-click="clearTextFormat()" lx-ripple><i class="mdi mdi-eraser"></i></button>',"            </div>","        </div>","    </div>","</div>"].join(""),replace:!0,link:function(a,b){a.textData=d.getTextData();var e={height:0,width:0,bodyHeight:0,bodyWidth:0};e.height=b.height(),e.width=b.width(),a.closeAllMenu=function(){c.hideBoxDom(),c.hideDom(),d.hideSetSizeBox(),d.hideSetFontBox(),d.hideSetSpacingBox(),d.hideSetLineHeightBox()},a.setAlign=function(b){d.formatLine("align",b),a.textData.value.align=b},a.setBold=function(){d.formatText("bold",!a.textData.value.Bold),a.textData.value.Bold=!a.textData.value.Bold},a.setItalic=function(){d.formatText("italic",!a.textData.value.Italic),a.textData.value.Italic=!a.textData.value.Italic},a.setUnderline=function(){d.formatText("underline",!a.textData.value.Underline),a.textData.value.Underline=!a.textData.value.Underline},a.setStrikethrough=function(){d.formatText("strike",!a.textData.value.Strikethrough),a.textData.value.Strikethrough=!a.textData.value.Strikethrough},a.clearTextFormat=function(){d.clearTextFormat()},a.setSize=function(a){d.showSetSizeBox($(a.target).offset().left,$(a.target).offset().top)},a.setFont=function(a){d.showSetFontBox($(a.target).offset().left,$(a.target).offset().top)},a.setSpacing=function(a){d.showSetSpacingBox($(a.target).offset().left,$(a.target).offset().top)},a.setLineHeight=function(a){d.showSetLineHeightBox($(a.target).offset().left,$(a.target).offset().top)}}}}]).factory("textEditorService",["$rootScope","$compile",function(a,b){var c={ID:"textData",value:{font:"微软雅黑",size:"30",lineHeight:150,spacing:10,align:"left",Bold:!1,Italic:!1,Underline:!1,Strikethrough:!1,color:"rgb(255,255,255)",background:"rgba(255,255,255,0)"}},d={ID:"domHandle",value:""},e={ID:"textBoxHandle",value:""},f={ID:"editorHandle",value:""},g={ID:"setSizeBoxDom",value:""},h={ID:"setFontBoxDom",value:""},i={ID:"setSpacingBoxDom",value:""},j={ID:"setLineHeightBoxDom",value:""},k={},l={removePlugin:function(){""!==d.value&&(d.value.remove(),d.value=""),""!==g.value&&(g.value.remove(),g.value=""),""!==h.value&&(h.value.remove(),h.value=""),""!==i.value&&(i.value.remove(),i.value="")},setRange:function(a){k=a},getRange:function(){return k},clearTextFormat:function(){f.value.setText(f.value.getText()),f.value.setSelection(k.start,k.end)},formatText:function(a,b){return"spacing"===a?void e.value.find(".ele").css("letter-spacing",b):"lineHeight"===a?void e.value.find(".ele").css("line-height",b):void(""!==f.value&&(f.value.formatText(k.start,k.end,a,b),"color"===a||"background"===a?window.getSelection()?window.getSelection().removeAllRanges():document.getSelection().removeAllRanges():"size"!==a&&f.value.setSelection(k.start,k.end)))},formatLine:function(a,b){""!==f.value&&(f.value.formatLine(k.start,k.end,a,b),"color"===a||"background"===a?window.getSelection()?window.getSelection().removeAllRanges():document.getSelection().removeAllRanges():f.value.setSelection(k.start,k.end))},prepareFormat:function(a,b){""!==f.value&&f.value.prepareFormat(a,b)},getTextData:function(){return c},setTextData:function(a){c.value=a},setEditorHandle:function(a){f.value=a},createDom:function(){var c=b("<div text-editor></div>")(a);c=$(c),$("body").append(c),d.value=c},showDom:function(a){""!==d.value?d.value.show():(this.createDom(),d.value.show()),e.value=$("#"+a);var b={height:0,width:0,bodyHeight:0,bodyWidth:0};b.height=d.value.height(),b.width=d.value.width(),b.bodyHeight=$("body").height(),b.bodyWidth=$("body").width();var c=e.value.offset().left-b.width/2+e.value.width()/2+20,f=e.value.offset().top-b.height-20;10>c&&(c=10),
60>f&&(f=60),c+b.width>b.bodyWidth&&(c=b.bodyWidth-10-b.width),f+b.height>b.bodyHeight&&(f=b.bodyHeight-10-b.height),d.value.css({left:c+"px",top:f+"px"})},hideDom:function(){if(""!==d.value){d.value.hide();var a=e.value.find(".ele");a.find(".ql-editor").removeClass("open-user-select"),a.find(".ql-editor").removeAttr("contenteditable",!0),""!==g.value&&g.value.hide(),""!==h.value&&h.value.hide(),""!==i.value&&i.value.hide(),""!==j.value&&j.value.hide()}},createSetSizeBox:function(){var c=b("<div editor-size-box></div>")(a);c=$(c),$("body").append(c),g.value=c},showSetSizeBox:function(a,b){""===g.value&&this.createSetSizeBox(),g.value.show();var c=parseInt(g.value.height()),d=parseInt($("body").height());b+c>d&&(b-=b+c-d),g.value.css({left:a,top:b+30})},hideSetSizeBox:function(){""!==g.value&&g.value.hide()},createSetFontBox:function(){var c=b("<div editor-font-box></div>")(a);c=$(c),$("body").append(c),h.value=c},showSetFontBox:function(a,b){""===h.value&&this.createSetFontBox(),h.value.show();var c=parseInt(h.value.height()),d=parseInt($("body").height());b+c>d&&(b-=b+c-d),h.value.css({left:a,top:b+30})},hideSetFontBox:function(){""!==h.value&&h.value.hide()},createSetSpacingBox:function(){var c=b("<div editor-spacing-box></div>")(a);c=$(c),$("body").append(c),i.value=c},showSetSpacingBox:function(a,b){""===i.value&&this.createSetSpacingBox(),i.value.show();var c=parseInt(i.value.height()),d=parseInt($("body").height());b+c>d&&(b-=b+c-d),i.value.css({left:a,top:b+30})},hideSetSpacingBox:function(){""!==i.value&&i.value.hide()},createSetLineHeightBox:function(){var c=b("<div editor-line-height-box></div>")(a);c=$(c),$("body").append(c),j.value=c},showSetLineHeightBox:function(a,b){""===j.value&&this.createSetLineHeightBox(),j.value.show();var c=parseInt(j.value.height()),d=parseInt($("body").height());b+c>d&&(b-=b+c-d),j.value.css({left:a,top:b+30})},hideSetLineHeightBox:function(){""!==j.value&&j.value.hide()}};return l}]),angular.module("kyle.rightClickMenu",[]).directive("rightClickMenuInit",["rightClickMenuService",function(a){return{restrict:"A",link:function(b,c){a.createDom(b),b.$on("$destroy",function(){a.removePlugin()})}}}]).directive("phoneRightClickMenuInit",["rightClickMenuService",function(a){return{restrict:"A",link:function(b,c){a.createPhoneDom(b),b.$on("$destroy",function(){a.removePhonePlugin()})}}}]).directive("rightClickMenuEditEle",function(){return{restrict:"A",scope:{rightClickMenuEditEle:"="},link:function(a,b){b.on("click",function(){$("#"+a.rightClickMenuEditEle+".position-box").trigger("dblclick")})}}}).directive("rightClickMenu",["rightClickMenuService","websiteData","shearPlate","$rootScope","multipleChoiceService","builderTool","activePageService",function(a,b,c,d,e,f,g){return{restrict:"A",template:['<div class="right-click-menu-box close-user-select z-depth-2" onmousedown="event.stopPropagation()" ng-click="hideDom()">','            <div class="right-click-menu-list">','                <div class="right-click-menu-item border" right-click-menu-edit-ele="activeID" ng-show="rightMenuType==\'text\'||rightMenuType==\'group\'"><i class="mdi mdi-pencil"></i>编辑</div>','                <div class="right-click-menu-item border" right-click-menu-edit-ele="activeID" ng-show="rightMenuType==\'image\'"><i class="mdi mdi-image-area"></i>裁剪</div>','                <div class="right-click-menu-item" ng-show="rightMenuType!=\'session\'" ng-click="copy(\'copy\')"><i class="mdi mdi-content-copy"></i>复制</div>','                <div class="right-click-menu-item border" ng-show="rightMenuType!=\'session\'" ng-click="copy(\'cut\')"><i class="mdi mdi-content-cut"></i>剪切</div>','                <div class="right-click-menu-item" ng-show="rightMenuType!=\'session\'"><i class="mdi mdi-layers"></i>图层</div>','                <div class="right-click-menu-item" ng-click="unGroup()" ng-show="rightMenuType==\'group\'"><i class="mdi mdi-ungroup"></i>解除合并</div>','                <div class="right-click-menu-item" ng-click="group()" ng-show="rightMenuType==\'multipleChoice\'"><i class="mdi mdi-group"></i>合并</div>','                <div class="right-click-menu-item" ng-show="rightMenuType==\'session\'"><i class="mdi mdi-image-area"></i>更换背景</div>','                <div class="right-click-menu-item" ng-show="rightMenuType==\'session\'"><i class="mdi mdi-chevron-double-up"></i>上移</div>','                <div class="right-click-menu-item border" ng-show="rightMenuType==\'session\'"><i class="mdi mdi-chevron-double-down"></i>下移</div>','                <div class="right-click-menu-item" ng-show="rightMenuType==\'session\'" ng-click="copySession()"><i class="mdi mdi-content-copy"></i>复制模块</div>','                <div class="right-click-menu-item border" ng-show="rightMenuType==\'session\'" ng-class="{true:\'disable\'}[shearPlateHandle.value==null]" ng-click="paste()"><i class="mdi mdi-content-paste"></i>粘贴</div>','                <div class="right-click-menu-item" ng-click="deleteEle()"><i class="mdi mdi-delete"></i>删除</div>',"            </div>","        </div>"].join(""),replace:!0,link:function(h,i){function j(b){for(var c=e.getEleList().value,d=0,f=0;f<c.length;f++)c[f].state===!0&&d++;if(d>0)return h.$apply(function(){h.rightMenuType="multipleChoice",a.showDom(b.pageX,b.pageY)}),!1;if(a.searchEleParent(b.target)){var g=a.searchEleParent(b.target);h.$apply(function(){h.rightMenuType=g.type,h.activeID=g.ID,a.showDom(b.pageX,b.pageY)})}return!1}function k(b){a.hideDom()}h.rightMenuType="",h.activeID="",h.shearPlateHandle=c.getHandle(),$(document).on("contextmenu",j),$(document).on("mousedown",k),h.$on("$destroy",function(){$(document).off("contextmenu",j),$(document).off("mousedown",k)}),h.hideDom=function(){a.hideDom()},h.deleteEle=function(){b.deleteEle(g.getActivePage().value,h.activeID)},h.group=function(){for(var a=e.getEleList().value,c=[],d=0;d<a.length;d++)a[d].state===!0&&c.push(angular.copy(a[d]));b.groupEle(c)},h.unGroup=function(){b.unGroupEle(f.getEle(h.activeID,"group"))},h.copy=function(a){var d=g.getActivePage().value;c.setData(a,d,b.getEle(d,h.activeID))},h.paste=function(){var a=jQuery.extend(!0,{},c.getData());null!==a.value&&(a.value.position.top="0px",a.value.position.left="0px","copy"===a.type?(a.value.ID="a"+parseInt(1e5*Math.random()),d.$broadcast("builderAddEle",h.activeID,a.value)):(b.deleteEle(g.getActivePage().value,a.value.ID),a.value.ID="a"+parseInt(1e5*Math.random()),d.$broadcast("builderAddEle",h.activeID,a.value)))}}}}]).directive("phoneRightClickMenu",["rightClickMenuService",function(a){return{restrict:"A",template:['<div class="right-click-menu-box z-depth-2" onmousedown="event.stopPropagation()" ng-click="hideDom()">','            <div class="right-click-menu-list">','                <div class="right-click-menu-item" ng-click="deleteEle()"><i class="mdi mdi-eye"></i>隐藏</div>',"            </div>","        </div>"].join(""),replace:!0,link:function(b,c){function d(c){if(a.searchEleParent(c.target)){var d=a.searchEleParent(c.target);b.$apply(function(){b.rightMenuType=d.type,b.activeID=d.ID,a.showPhoneDom(c.pageX,c.pageY)})}return!1}function e(b){a.hidePhoneDom()}b.rightMenuType="",b.activeID="",$(document).on("contextmenu",d),$(document).on("mousedown",e),b.$on("$destroy",function(){$(document).off("contextmenu",d),$(document).off("mousedown",e)}),b.hideDom=function(){a.hidePhoneDom()},b.deleteEle=function(){}}}}]).factory("rightClickMenuService",["$rootScope","$compile",function(a,b){var c={ID:"rightClickMenuDom",value:""},d={ID:"phoneRightClickMenuDom",value:""},e={removePlugin:function(){c.value.remove()},removePhonePlugin:function(){d.value.remove()},createDom:function(a){var d=b("<div right-click-menu></div>")(a);d=$(d),$("body").append(d),c.value=d},createPhoneDom:function(a){var c=b("<div phone-right-click-menu></div>")(a);c=$(c),$("body").append(c),d.value=c},showPhoneDom:function(a,b){""===d.value&&this.createDom(),d.value.css({left:a,top:b}),d.value.show();var c=$("body").height(),e=d.value.get(0).offsetTop,f=d.value.height();if(e+f>c){var g=e+f-c;d.value.css({top:e-g-20})}var h=$("body").width(),i=d.value.get(0).offsetLeft,j=d.value.width();if(i+j>h){var k=i+j-h;d.value.css({left:i-k-20})}},hidePhoneDom:function(){""!==d.value&&d.value.hide()},removePhone:function(){""!==d.value&&d.value.remove()},showDom:function(a,b){""===c.value&&this.createDom(),c.value.css({left:a,top:b}),c.value.show();var d=$("body").height(),e=c.value.get(0).offsetTop,f=c.value.height();if(e+f>d){var g=e+f-d;c.value.css({top:e-g-20})}var h=$("body").width(),i=c.value.get(0).offsetLeft,j=c.value.width();if(i+j>h){var k=i+j-h;c.value.css({left:i-k-20})}},hideDom:function(){""!==c.value&&c.value.hide()},remove:function(){""!==c.value&&c.value.remove()},searchEleParent:function(a){for(var b={};void 0!==a&&null!==a&&"BODY"!==a.tagName.toUpperCase();){if(-1!==a.className.indexOf("position-box"))return b={ID:$(a).attr("id"),type:$(a).attr("ele-type")};if(-1!==a.className.indexOf("ele-session-box"))return b={ID:$(a).attr("id"),type:$(a).attr("ele-type")};a=a.parentNode}return!1}};return e}]),angular.module("multipleChoice",[]).directive("dragSelectEle",["websiteData","builderTool","multipleChoiceService","changeSessionToolForMultiple",function(a,b,c,d){return{restrict:"A",link:function(a,b,e){function f(a){if("resize"!==$(a.target).attr("ele-type")){if(t.shadowFlag=!1,1!==a.buttons)return void("session"===$(a.target).attr("ele-type")&&c.removeEle());var b=a;if(k=b.clientX,l=b.clientY,"session"!==$(a.target).attr("ele-type"))s=!0,c.removeMenuButton(),r.value=c.updateEleInfo(),d.init($(a.target).parents(".ele-session-box").attr("id"),c.getActiveEleCenterY(r.value),e.dragSelectEle);else{t.activeSession=$(a.target).attr("id"),c.removeEle(),r.value=c.getEleInfo($(a.target).attr("id")),m=!0,j++;var f=$("<div></div>");f.addClass("drag-select-box"),f.attr("id",i+j),f.css({"margin-left":k+"px","margin-top":l+"px"}),$("body").append(f)}}}function g(){if(s){s=!1,r.value=c.updateEleInfo();for(var a=[],b=0;b<r.value.length;b++)r.value[b].state===!0&&a.push(r.value[b]);c.updateEleList(r.value),d.overCheck(a)}m&&($("#"+i+j).remove(),$(".ele-session-box .over-shadow").css("display","none"),m=!1)}function h(a){var b={},c={};if(m){if(b=a,n=(k-b.clientX>0?b.clientX:k)+"px",o=(l-b.clientY>0?b.clientY:l)+"px",p=Math.abs(l-b.clientY)+"px",q=Math.abs(k-b.clientX)+"px",$("#"+i+j).css({"margin-left":n,"margin-top":o,width:q,height:p}),(parseInt(p)>20||parseInt(q)>20)&&t.shadowFlag===!1){t.shadowFlag=!0;var e=$(".ele-session-box[id!="+t.activeSession+"] .over-shadow");e.css("display","block")}for(var f=0;f<r.value.length;f++){var g=r.value[f].center;c={},g.x>parseInt(n)&&g.x<parseInt(n)+parseInt(q)&&g.y>parseInt(o)&&g.y<parseInt(o)+parseInt(p)?(r.value[f].state=!0,c=$("#"+r.value[f].ID+".position-box"),c.addClass("multiple-choice-border"),c.attr("multiple-choice",!0)):(c=$("#"+r.value[f].ID+".position-box"),c.removeClass("multiple-choice-border"),c.attr("multiple-choice",!1),r.value[f].state=!1)}}if(s){b=a;var h=b.clientX-k,u=b.clientY-l;c=null;for(var v=0;v<r.value.length;v++)r.value[v].state===!0&&(c=$("#"+r.value[v].ID+".position-box"),c.css({left:r.value[v].position.left+h,top:r.value[v].position.top+u}));d.moveCheck(u)}}var i="w",j=0,k=0,l=0,m=!1,n="0px",o="0px",p="0px",q="0px",r=c.getEleList(),s=!1,t={};t.shadowFlag=!1,$(b).on("mousedown",f),$(document).on("mouseup",g),$(document).on("mousemove",h),a.$on("$destroy",function(){$(b).off("mousedown",f),$(document).off("mouseup",g),$(document).off("mousemove",h)})}}}]).factory("multipleChoiceService",["$compile","LxNotificationService","rotateEleCalculate",function(a,b,c){var d={ID:"eleList",value:[]},e=null,f=null,g={updateEleList:function(a){d.value=a},setEleList:function(a){this.removeEle(),d.value=a;for(var b=0;b<d.value.length;b++)if(d.value[b].state){var c=$("#"+d.value[b].ID+".position-box");c.addClass("multiple-choice-border"),c.attr("multiple-choice",!0)}},getEleList:function(){return d},clearActive:function(){for(var a=0;a<d.value.length;a++){d.value[a].state=!1;var b=$("#"+d.value[a].ID+".position-box");b.removeClass("multiple-choice-border"),b.attr("multiple-choice",!1)}$(".ele-session-box .over-shadow").css("display","none"),f=null},removeEle:function(){this.clearActive(),this.removeMenuButton(),d.value=[]},createMenuButton:function(b){for(var c=0,f=0,g=0,h=0,i=!0,j=0,k=0,l=0;l<d.value.length;l++)if(d.value[l].state){if(j++,i){c=d.value[l].position.top,f=d.value[l].position.left,g=d.value[l].position.top+d.value[l].size.height,h=d.value[l].position.left+d.value[l].size.width,i=!1;continue}d.value[l].position.top<c&&(c=d.value[l].position.top),d.value[l].position.top+d.value[l].size.height>g&&(g=d.value[l].position.top+d.value[l].size.height),d.value[l].position.left<f&&(f=d.value[l].position.left),d.value[l].position.left+d.value[l].size.width>h&&(k=l,h=d.value[l].position.left+d.value[l].size.width)}if(!i&&j>1){var m={};m.y=(c+g)/2,m.x=(f+h)/2;var n="<div class='multiple-choice-menu z-depth-2' ng-click='group($event)' ng-mousedown='$event.stopPropagation()' id='multiple-choice-menu' lx-ripple='white'><i class='mdi mdi-group'></i></div>";e=$(a(n)(b)),$("#"+d.value[k].ID).append(e),m.x=m.x-e.width()/2,m.y=m.y-e.height()/2,e.css("right","-60px"),e.css("top","0px")}},removeMenuButton:function(){null!==e&&e.remove()},getEleInfo:function(a){for(var b=[],c=$("#"+a+".ele-session-box .ele-session > .position-box-parent > .position-box"),d=0;d<c.length;d++){var e=c.eq(d),f=this.getEleData(e);b.push(f)}return c.value=b,b},updateEleInfo:function(){for(var a=0;a<d.value.length;a++)if(d.value[a].state){var b=$("#"+d.value[a].ID+".position-box"),e={};e.x=b.offset().left+parseInt(b.get(0).offsetWidth)/2,e.y=b.offset().top+parseInt(b.get(0).offsetHeight)/2;var f={};f.left=parseInt(b.css("left")),f.top=parseInt(b.css("top"));var g={};g.width=b.outerWidth(),g.height=b.outerHeight();var h=c.getSizeAndPosition(f.left,f.top,g.width,g.height,c.getRotate(b));f.left=h.left,f.top=h.top,g.width=h.width,g.height=h.height,d.value[a].center=e,d.value[a].position=f,d.value[a].size=g}return d.value},getEleData:function(a){var b={};b.x=a.offset().left+parseInt(a.get(0).offsetWidth)/2,b.y=a.offset().top+parseInt(a.get(0).offsetHeight)/2;var d={};d.left=parseInt(a.css("left")),d.top=parseInt(a.css("top"));var e={};e.width=a.outerWidth(),e.height=a.outerHeight();var f=c.getSizeAndPosition(d.left,d.top,e.width,e.height,c.getRotate(a));return d.left=f.left,d.top=f.top,e.width=f.width,e.height=f.height,{ID:a.attr("id"),center:b,position:d,type:a.attr("ele-type"),size:e}},addEle:function(a){if($("#"+a).parents(".ele-session-box").attr("id")!==f&&null!==f)return void b.info("不可选择不是同一个模块的元素");for(var c=!1,e=0,g={},h=0;h<d.value.length;h++)if(d.value[h].state&&e++,d.value[h].ID===a){if(d.value[h].state===!0)return;c=!0,d.value[h].state=!0,g=$("#"+d.value[h].ID+".position-box"),g.addClass("multiple-choice-border"),g.attr("multiple-choice",!0)}if(c===!1){g=$("#"+a+".position-box"),f=g.parents(".ele-session-box").attr("id");var i=this.getEleData(g);i.state=!0,d.value.push(i),g.addClass("multiple-choice-border"),g.attr("multiple-choice",!0)}},getActiveEleCenterY:function(a){if(0!==a.length){for(var b=0,c=a[0].position.top,d=a[0].position.top+a[0].size.height,e=0;e<a.length;e++)a[e].state===!0&&(a[e].position.top<c&&(c=a[e].position.top),a[e].position.top+a[e].size.height>d&&(d=a[e].position.top+a[e].size.height));return b=(c+d)/2}}};return g}]),angular.module("kyle.eleSetting",[]).directive("eleSettingBox",["eleSettingService",function(a){return{restrict:"A",replace:!0,scope:{},template:['<div class="color-pick-box lager" id="color-pick-box" drag-ele="default" handle="handle" onmousedown="event.stopPropagation()" onclick="event.stopPropagation()">','    <div class="my-color">','        <div class="title handle">',"            {{boxInitData.title}}",'            <button class="btn btn--xs btn--white btn--icon" lx-ripple ng-click="closeEleSetting()"><i class="mdi mdi-close"></i></button>',"        </div>",'        <div ele-setting-box-design-image ng-if=boxInitData.type=="imagedesign"></div>','        <div ele-setting-box-design-text ng-if=boxInitData.type=="textdesign"></div>','        <div ele-setting-box-layers ng-if=boxInitData.type=="layers"></div>','        <div ele-setting-box-animate ng-if=boxInitData.type=="animate"></div>','        <div ele-setting-box-filter ng-if=boxInitData.type=="filter"></div>',"    </div>","</div>"].join(""),link:function(b,c){b.boxInitData=a.getInitData(),b.$watch("boxInitData",function(){switch(b.boxInitData.type){case"imagedesign":b.boxInitData.title="图片设计";break;case"textdesign":b.boxInitData.title="文字设计";break;case"layers":b.boxInitData.title="布局";break;case"animate":b.boxInitData.title="动画";break;case"filter":b.boxInitData.title="滤镜"}},!0),b.closeEleSetting=function(){a.hideDom()}}}}]).directive("eleSettingBoxDesignImage",["eleSettingService",function(a){return{restrict:"A",template:['        <div class="content-box" ng-init="tabState=0" style="height:450px">','           <div class="ele-setting-option z-depth-1">','               <div ele-setting-slide="image" style="height: 85px"></div>','                   <div class="tab-box tc-white-1" flex-container="row">','                       <div flex-item="6" flex-item-order="1"><button class="btn btn--m btn--block btn--blue btn--flat" ng-class={true:"active"}[tabState==0] ng-click="tabState=0" lx-ripple>普通状态</button></div>','                       <div flex-item="6" flex-item-order="1"><button class="btn btn--m btn--block btn--blue btn--flat" ng-class={true:"active"}[tabState==1] ng-click="tabState=1" lx-ripple>鼠标悬浮</button></div>',"                   </div>","           </div>",'           <div class="ele-setting-content" ng-init="activeLeftMenu=\'background\'" ng-if="tabState==0">','               <div class="left-menu">','                   <div class="menu-item" ng-click="activeLeftMenu=\'background\'" ng-class="{true:\'active\'}[activeLeftMenu==\'background\']"><div class="border"></div><i class="mdi mdi-invert-colors"></i></div>','                   <div class="menu-item" ng-click="activeLeftMenu=\'border\'" ng-class="{true:\'active\'}[activeLeftMenu==\'border\']"><div class="border"></div><i class="mdi mdi-checkbox-blank-outline"></i></div>','                   <div class="menu-item" ng-click="activeLeftMenu=\'radius\'" ng-class="{true:\'active\'}[activeLeftMenu==\'radius\']"><div class="border"></div><i class="mdi mdi-crop-free"></i></div>','                   <div class="menu-item" ng-click="activeLeftMenu=\'shadow\'" ng-class="{true:\'active\'}[activeLeftMenu==\'shadow\']"><div class="border"></div><i class="mdi mdi-checkbox-multiple-blank"></i></div>',"               </div>",'               <div class="right-content">','                   <perfect-scrollbar class="scroller-page small-bar" wheel-propagation="true" suppress-scroll-x="true" wheel-speed="5">',"                       <div ng-show=\"activeLeftMenu=='background'\">",'                           <div class="title-text">颜色</div>','                           <div class="sub-content">','                               <div class="sub-title">背景颜色</div>','                               <div class="color-box z-depth-1"></div>',"                           </div>","                       </div>","                       <div ng-show=\"activeLeftMenu=='border'\">",'                           <div class="title-text">边框</div>','                           <div class="sub-content">','                               <div class="sub-title">边框颜色</div>','                               <div class="color-box z-depth-1"></div>',"                           </div>",'                           <div class="sub-content">','                               <div class="sub-title">边框大小</div>','                               <div class="border-box z-depth-1" style="padding: 10px">','                                   <div class="center input-box z-depth-1">20</div>','                                   <div class="top input-box z-depth-1">20</div>','                                   <div class="left input-box z-depth-1">20</div>','                                   <div class="bottom input-box z-depth-1">20</div>','                                   <div class="right input-box z-depth-1">20</div>',"                               </div>","                           </div>","                       </div>","                       <div ng-show=\"activeLeftMenu=='radius'\">",'                           <div class="title-text">圆角</div>','                           <div class="sub-content">','                               <div class="sub-title">圆角度数</div>','                               <div class="radius-box z-depth-1" style="border-radius: 20px">','                                   <div class="center input-box z-depth-1">20</div>','                                   <div class="top-right input-box z-depth-1">20</div>','                                   <div class="top-left input-box z-depth-1">20</div>','                                   <div class="bottom-left input-box z-depth-1">20</div>','                                   <div class="bottom-right input-box z-depth-1">20</div>',"                               </div>","                           </div>","                       </div>","                   </perfect-scrollbar>               </div>","           </div>",'           <div class="ele-setting-content" ng-init="activeLeftMenu=\'background\'" ng-if="tabState==1"></div>',"        </div>"].join(""),link:function(a,b){}}}]).directive("eleSettingBoxDesignText",["eleSettingService",function(a){return{restrict:"A",template:['        <div class="content-box" style="height:450px">',"        </div>"].join(""),link:function(a,b){}}}]).directive("eleSettingBoxLayers",["eleSettingService",function(a){return{restrict:"A",template:['        <div class="content-box" style="height:450px">',"        </div>"].join(""),link:function(a,b){}}}]).directive("eleSettingBoxAnimate",["eleSettingService",function(a){return{restrict:"A",template:['        <div class="content-box" style="height:450px">',"        </div>"].join(""),link:function(a,b){}}}]).directive("eleSettingBoxFilter",["eleSettingService",function(a){return{restrict:"A",template:['<div class="content-box" style="height:450px">','<div class="tab-box z-depth-1 tc-white-1" flex-container="row">','<div flex-item="6" flex-item-order="1"><button class="btn btn--m btn--block btn--blue btn--flat" ng-class={true:"active"}[tabState==0] ng-click="tabState=0" lx-ripple>系统滤镜</button></div>','<div flex-item="6" flex-item-order="1"><button class="btn btn--m btn--block btn--blue btn--flat" ng-class={true:"active"}[tabState==1] ng-click="tabState=1" lx-ripple>我的滤镜</button></div>',"</div>",'<perfect-scrollbar style="height:405px" class="scroller-page small-bar" wheel-propagation="true" suppress-scroll-x="true" wheel-speed="5"><div class="image-filter-list"><div class="image-filter-item"><div class="item-box none"><div class="line"></div></div></div><div class="image-filter-item" ng-repeat="rowData in filterData"><div class="item-box"><div class="filter-box" ng-style=rowData.style><div class="image" ng-style={"background-image":"url("+boxInitData.eleData.url+")"}></div></div></div></div></div></perfect-scrollbar></div>'].join(""),link:function(a,b){a.tabState=0,a.filterData=[{name:"灰度",style:{"-webkit-filter":"grayscale(1)"}},{name:"褐色",style:{"-webkit-filter":"sepia(1)"}},{name:"饱和度",style:{"-webkit-filter":"saturate(.5)"}},{name:"色相旋转",style:{"-webkit-filter":"hue-rotate(90deg)"}},{name:"反色",style:{"-webkit-filter":"invert(1)"}},{name:"亮度",style:{"-webkit-filter":"brightness(.5)"}},{name:"对比度",style:{"-webkit-filter":"contrast(2)"}},{name:"模糊",style:{"-webkit-filter":"blur(2px)"}}]}}}]).directive("eleSettingSlide",function(){return{restrict:"A",replace:!0,templateUrl:function(a,b){switch(b.eleSettingSlide){case"image":return"views/eleSetting/imageSlide.html"}},link:function(a,b){$(b).swiper({direction:"horizontal",nextButton:".swiper-button-next",prevButton:".swiper-button-prev",slidesPerView:4,slidesOffsetBefore:20,slidesOffsetAfter:20,mousewheelControl:!0})}}}).factory("eleSettingService",["$rootScope","$compile",function(a,b){var c={ID:"colorPick",value:""},d={type:"",ID:""},e={getInitData:function(){return d},removePlugin:function(){""!==c.value&&(c.value.remove(),c.value="")},updatePosition:function(a,b,c){console.log(a.value.height());var d=parseInt(a.value.height()),e=parseInt(a.value.width()),f=parseInt($("body").height()),g=parseInt($("body").width());c-=d/2,b-=e/2,c+d>f?c-=c+d-f+50:50>c&&(c=50),b+e>g?b-=b+e-g+50:50>c&&(b=50),a.value.css({left:b,top:c})},createDom:function(d,f){var g=b("<div ele-setting-box></div>")(a);g=$(g),$("body").append(g),c.value=g,c.value.show(),setTimeout(function(){e.updatePosition(c,d,f)},100)},updateInitData:function(a){d.eleData=a},showDom:function(a,b,f,g,h){d.type=f,d.ID=g,d.eleData=h,""===c.value?e.createDom(a,b):(c.value.show(),e.updatePosition(c,a,b))},hideDom:function(){""!==c.value&&c.value.hide()}};return e}]),angular.module("kyle.sessionSetting",[]).directive("sessionBackgroundSettingBox",["sessionSettingService","websiteData",function(a,b){return{restrict:"A",replace:!0,scope:{},template:['<div class="color-pick-box lager" id="color-pick-box" drag-ele="default" handle="handle" onmousedown="event.stopPropagation()" onclick="event.stopPropagation()">','<div class="my-color">','<div class="title handle">',"{{title}}",'<button class="btn btn--xs btn--white btn--icon" lx-ripple ng-click="closeEleSetting()"><i class="mdi mdi-close"></i></button>',"</div>",'<div class="content-box" style="height:480px"><div class="preview-head"><div class="image box" ng-if="boxInitData.option.type == \'image\' || boxInitData.option.type == \'video\'" ng-style="{\'background-image\':\'url(\'+boxInitData.option.image+\')\'}"></div><div class="color box" ng-if="boxInitData.option.type == \'color\'" ng-style="{\'background-color\':boxInitData.option.color}"></div><div class="menu" flex-container="row"><div flex-item="4" flex-item-order="1"><lx-button lx-color="blue"><i class="mdi mdi-invert-colors"></i> 颜色</lx-button></div><div flex-item="4" flex-item-order="1"><lx-button lx-color="blue"><i class="mdi mdi-image-area"></i> 图片</lx-button></div><div flex-item="4" flex-item-order="1"><lx-button lx-color="blue"><i class="mdi mdi-video"></i> 视频</lx-button></div></div><div class="button-box"><lx-button><i class="mdi mdi-settings"></i> 设置</lx-button><lx-button class="play-button" ng-class="{true:\'show\',false:\'hide\'}[boxInitData.option.type == \'video\']" ng-click="toggleVideo()"><i class="mdi mdi-play" ng-show="videoState.state == \'pause\'"></i><i class="mdi mdi-pause" ng-show="videoState.state == \'play\'"></i></lx-button></div></div><perfect-scrollbar suppress-scroll-x="true" class="preview-list scroll-page small-bar" wheel-propagation="true" wheel-speed="3"><div class="preview-item" ng-click="selectBackground(rowData)" lx-ripple="white" ng-repeat="rowData in previewList" ng-style="{\'background-image\':\'url(\'+rowData.image+\')\'}"><i class="mdi mdi-video flag" ng-if="rowData.type == \'video\'"></i><i class="mdi mdi-image-area flag" ng-if="rowData.type == \'image\'"></i></div></perfect-scrollbar></div>',"</div>","</div>"].join(""),link:function(c,d){c.boxInitData=a.getInitData(),c.title="更换背景",c.closeEleSetting=function(){a.hideDom()},c.videoState={state:"pause",handle:null},c.toggleVideo=function(){"pause"==c.videoState.state?c.videoState.handle.play():c.videoState.handle.pause()},c.$watch("boxInitData.option.type",function(){"video"==c.boxInitData.option.type&&(c.videoState.handle=$("#"+c.boxInitData.ID+".ele-session-box .video-background video").get(0),c.videoState.handle.onended=function(){c.$apply(function(){c.videoState.state="pause"})},c.videoState.handle.onpause=function(){c.$apply(function(){c.videoState.state="pause"})},c.videoState.handle.onplaying=function(){c.$apply(function(){c.videoState.state="play"})},c.videoState.handle.pause(),c.videoState.state="pause")}),c.selectBackground=function(a){switch(void 0!==c.boxInitData.callback&&c.boxInitData.callback(a),c.videoState.state="pause",a.type){case"image":c.boxInitData.option.type="image",c.boxInitData.option.image=a.image;break;case"video":c.boxInitData.option.type="video",c.boxInitData.option.image=a.image,c.boxInitData.option.url=a.url}b.updateSessionBackground(a,c.boxInitData.ID)},c.previewList=[{type:"image",image:"images/website/headBg.jpg"},{type:"image",image:"images/website/bg1.jpg"},{type:"video",url:"http://obo7gtx2x.bkt.clouddn.com/banner1.webm",image:"images/video/banner1.jpg"},{type:"image",image:"images/website/headBg.jpg"},{type:"video",url:"http://obo7gtx2x.bkt.clouddn.com/banner1.webm",image:"images/video/banner1.jpg"},{type:"image",image:"images/website/headBg.jpg"},{type:"video",url:"http://obo7gtx2x.bkt.clouddn.com/banner.mp4",image:"images/video/banner.png"},{type:"image",image:"images/website/headBg.jpg"},{type:"video",url:"http://obo7gtx2x.bkt.clouddn.com/banner.mp4",image:"images/video/banner.png"}]}}}]).factory("sessionSettingService",["$rootScope","$compile",function(a,b){var c={ID:"colorPick",value:"",option:{type:"",color:"",video:"",image:""}},d={ID:"",option:{}},e={getInitData:function(){return d},removePlugin:function(){""!==c.value&&(e.stopVideo(d.ID),c.value.remove(),c.value="")},updatePosition:function(a,b,c){var d=parseInt(a.value.height()),e=parseInt(a.value.width()),f=parseInt($("body").height()),g=parseInt($("body").width());c+d>f?c-=c+d-f:50>c&&(c=50),b+e>g?b-=b+e-g:50>c&&(b=50),a.value.css({left:b,top:c})},createDom:function(d,f){var g=b("<div session-background-setting-box></div>")(a);g=$(g),$("body").append(g),c.value=g,c.value.show(),setTimeout(function(){e.updatePosition(c,d,f)},100)},updateOption:function(a){d.option=a},showDom:function(a,b,f,g,h){d.ID=f,d.option=g,d.callback=h,""===c.value?e.createDom(a,b):(c.value.show(),e.updatePosition(c,a,b))},stopVideo:function(a){var b=$("#"+a+".ele-session-box .video-background video");0!==b.length&&b.get(0).pause()},hideDom:function(){""!==c.value&&(c.value.hide(),e.stopVideo(d.ID))}};return e}]),angular.module("myBuilderApp",["ngAnimate","ngSanitize","ngTouch","ui.router","lumx","oc.lazyLoad","ui.slimscroll","kyle.editor","kyle.colorPick","kyle.rightClickMenu","perfect_scrollbar","multipleChoice","kyle.eleSetting","kyle.sessionSetting","webSiteEditor","phoneSiteEditor","sessionEditor","historyLog","dataService","creator","browserInfo","shortcuts","insert.directive","eleMenu","addSession","kyle.imageLibrary","kyle.imageCrop"]).config(["$stateProvider","$urlRouterProvider","$ocLazyLoadProvider","$locationProvider",function(a,b,c,d){c.config({debug:!1}),b.otherwise("/index/workSpace"),a.state("index",{"abstract":!0,url:"/index",templateUrl:"views/common/top_nav.html",controller:"MainCtrl",resolve:{webData:["websiteData",function(a){return a.getWebsiteData().then(function(a){return a},function(a){return!1})}]}}).state("index.workSpace",{url:"/workSpace",templateUrl:"views/builder/workSpace.html",controller:"workSpaceCtrl"})}]),angular.module("myBuilderApp").controller("MainCtrl",["$scope","websiteData","historyLog","webData","activePageService",function(a,b,c,d,e){a.allData=d,a.websiteData=a.allData[0],e.setActivePage(a.websiteData.ID),a.modelState="web",a.selectModel=function(b){a.modelState=b},a.changePage=function(d){c.clearAll();for(var f=0;f<a.allData.length;f++)if(d===a.allData[f].ID){a.allData=b.getWebsiteDataForCache(),a.websiteData=a.allData[f],e.setActivePage(a.websiteData.ID);break}c.clearAll(),a.$broadcast("refreshPage",a.websiteData)},a.forward=function(){var a=jQuery.Event("keydown");a.keyCode=89,a.ctrlKey=!0,$(document).trigger(a)},a.retreat=function(){var a=jQuery.Event("keydown");a.keyCode=90,a.ctrlKey=!0,$(document).trigger(a)},a.save=function(){var a=[],c=JSON.stringify(b.getFullDataForCache(),function(b,c){if(null!==c&&"object"==typeof c){if(a.indexOf(c)>=0){
var d=jQuery.extend(!0,[],c.target);c={isPointer:"true",target:d}}a.push(c)}return c});console.log(c)}}]),angular.module("myBuilderApp").controller("workSpaceCtrl",["$scope","websiteData",function(a,b){}]).controller("insertEleCtrl",["$scope","eleResourceTemplate",function(a,b){a.eleList=b.getEleList(),a.activeEle=a.eleList[0],a.selectEleType=function(b){a.activeEle=b}}]).controller("leftMenuCtrl",["$scope",function(a){a.scrollOption={height:"100%",width:"80px"},a.activeMenu="",a.openMenu=function(b){b===a.activeMenu?a.activeMenu="":a.activeMenu=b},a.closeMenu=function(){a.activeMenu=""},a.$on("closeLeftMenu",function(){a.closeMenu()})}]).controller("editorCtrl",["$scope","websiteData","textEditorService","colorPickService","eleSettingService","sessionSettingService",function(a,b,c,d,e,f){a.$on("$destroy",function(){d.removePlugin(),c.removePlugin(),e.removePlugin(),f.removePlugin()})}]).controller("previewBoxCtrl",["$scope","websiteData","elePosition","levelScroll","$timeout",function(a,b,c,d,e){function f(b,f,g){var h=$("#"+f.ID),i=c.getTop(h.get(0)),j=b.scrollTop(),k=0;k=i+h.height()/2-50-$("body").height()/2,d.scrollTop(b,k,Math.abs(k-j)/30),a.closeMenu(),"ele"==g&&e(function(){"group"==f.type?h.find(">.ele-box >.group-over").trigger("mousedown"):h.trigger("mousedown"),$(document).trigger("mouseup")})}a.activeSession=a.websiteData.sessionList[0].ID,a.eleList=a.websiteData.sessionList[0].eleList,a.selectLayers=function(b){a.activeSession=b;for(var c=0;c<a.websiteData.sessionList.length;c++)if(b===a.websiteData.sessionList[c].ID)return void(a.eleList=a.websiteData.sessionList[c].eleList)},a.locateEleForWeb=function(a,b){var c=$("#main-editor-scroll");f(c,a,b)},a.locateEleForPhone=function(a,b){var c=$("#main-editor-scroll");f(c,a,b)},a.toggleEle=function(a,c){c!==!1?b.hideEle(a):b.showEle(a)},a.toggleSession=function(a,c){c!==!1?b.hideSession(a):b.showSession(a)}}]),angular.module("myBuilderApp").directive("sessionResize",["$timeout","websiteData","builderTool",function(a,b,c){return{restrict:"A",link:function(a,d,e){function f(a){if(h.flag){var b=0;if(b=a.pageY-h.startY,b>0)b+=h.currentHeight;else{if(!(b+h.currentHeight>=h.minHeight))return;b+=h.currentHeight}$(d).css("min-height",b+"px"),0!==j.length&&c.fixVideoPosition($(d),j,k)}}function g(a){h.flag&&(h.flag=!1,"phone"===e.sessionResize?b.changePhoneSessionHeight(i,parseInt(l.css("min-height"))):b.changeSessionHeight(i,parseInt(l.css("min-height"))))}var h={};h.minHeight=0,h.startY=0,h.currentHeight=0,h.flag=!1;var i=$(d).attr("id"),j=$(d).find(".video-background video"),k={},l=$(d);$(d).find("> .session-resize").on("mousedown",function(a){a.preventDefault(),h.currentHeight=parseInt(l.css("min-height")),h.startY=a.pageY,h.flag=!0,h.minHeight=b.getSessionMinHeight(i),j=$(d).find(".video-background video"),k={width:j.width(),height:j.height()}}),$(document).on("mousemove",f),$(document).on("mouseup",g),a.$on("$destroy",function(){$(document).off("mousedown",f),$(document).off("mouseup",g)})}}}]).directive("createThumbnail",["phoneCreatorServices","creatorServices","$compile",function(a,b,c){return{restrict:"A",scope:{createThumbnail:"=",type:"@",eleType:"@",layout:"@",previewHeight:"@"},link:function(d,e,f){function g(a){if(a.ID="preview"+a.ID,void 0!==a.eleList)for(var b=0;b<a.eleList.length;b++)g(a.eleList[b])}var h={width:$(e).width(),height:"auto"};void 0!==d.previewHeight&&(h.height=parseFloat(d.previewHeight)),$(e).height(h.height);var i="",j=jQuery.extend(!0,{},d.createThumbnail);g(j),"phone"===d.type&&("session"===d.eleType&&(i=a.createSession(j)),"ele"===d.eleType&&(i=a.createEle(j))),"web"===d.type&&("session"===d.eleType&&(i=b.createSession(j)),"ele"===d.eleType&&(i=b.createEle(j))),i.attr("thumbnail","true"),i=c(i.get(0))(d),i.find(".resize").remove(),i.find(".session-resize").remove(),i.find(".rotate").remove(),i.find(".line").remove(),i.find(".ele-label").remove(),i.find(".menu-tool-box").remove(),e.empty(),e.append(i);e.find(".position-box");if("session"===f.eleType&&"phone"===f.type&&(e.css("top","50%"),e.css("margin-top",-(.35*e.height())/2)),"session"===f.eleType&&"web"===f.type&&(e.css("top","50%"),e.css("margin-top",-(.095*e.height())/2)),"session"===f.eleType,"ele"===f.eleType){var k=$(e).find("> .position-box-parent > .position-box"),l=k.find(" > .ele-box"),m=1,n=1,o=1;l.width()>h.width&&(n=h.width/l.width()),l.height()>h.height&&(o=h.height/parseInt(l.css("min-height"))),m=o>n?o:n,"normal"===d.layout?k.css("position","static"):(l.css({transform:"scale("+m+","+m+")","-ms-transform":"scale("+m+","+m+")","-moz-transform":"scale("+m+","+m+")","-webkit-transform":"scale("+m+","+m+")","-o-transform":"scale("+m+","+m+")"}),k.css("left","50%"),k.css("top","50%"),k.css("margin-left",-l.width()/2),k.css("margin-top",-l.height()/2),l.css({"transform-origin":"50% 50%","-ms-transform-origin":"50% 50%","-moz-transform-origin":"50% 50%","-webkit-transform-origin":"50% 50%","-o-transform-origin":"50% 50%"}))}}}}]).directive("pageSettingToolModal",["$rootScope",function(a){return{restrict:"A",link:function(b,c,d){function e(a){b.$apply(function(){b.pageMenuShow=!1})}b.pageMenuShow=!1,b.toggleMenu=function(){b.pageMenuShow=!b.pageMenuShow,b.pageMenuShow&&a.$broadcast("closeLeftMenu")},$(c).find(".tool-modal").height($("body").height()*parseFloat(d.pageSettingToolModal)),$("body").on("mousedown",e),b.$on("$destory",function(){$("body").off("mousedown",e)})}}}]).directive("onGroupSizeChange",function(){return{restrict:"A",link:function(a,b,c){var d=$(b),e=0,f=0,g=0,h=0,i=d.find(" >.ele-box"),j=d.attr("id"),k=null;$(b).parents(".position-box[ele-type=group]").length>0&&(k=$(b).parents(".position-box[ele-type=group]").eq(0).attr("id"));var l=[];$(b).on("groupUpdateInit",function(a,c){if(j===c){$(b).trigger("groupUpdateInit",k),e=parseInt(d.css("left")),h=parseInt(d.css("top")),f=d.get(0).clientWidth,g=d.get(0).clientHeight,l=$(b).find(" >.ele-box >.ele >.position-box-parent >.position-box");for(var i=0;i<l.length;i++)l.get(i).eleLeft=parseInt(l.eq(i).css("left")),l.get(i).eleTop=parseInt(l.eq(i).css("top"))}}),$(b).on("groupUpdate",function(a,c){var m=jQuery.extend(!0,{},c);if(j===m.ID){var n=!1,o=0,p=0;if(m.elePar.left<0){for(p=f+Math.abs(m.elePar.left),i.css("width",p),d.css("left",e+m.elePar.left),n=!0,o=0;o<l.length;o++)"group"===l.eq(o).attr("ele-type")?l.eq(o).css("left",0):l.eq(o).css("left",l.get(o).eleLeft+Math.abs(m.elePar.left));m.elePar.left=0}m.elePar.left+m.elePar.width>f&&p<m.elePar.left+m.elePar.width&&(i.css("width",m.elePar.left+m.elePar.width),n=!0);var q=0;if(m.elePar.top<0){for(q=g+Math.abs(m.elePar.top),i.css("min-height",q),d.css("top",h+m.elePar.top),n=!0,o=0;o<l.length;o++)"group"===l.eq(o).attr("ele-type")?l.eq(o).css("top",0):l.eq(o).css("top",l.get(o).eleTop+Math.abs(m.elePar.top));m.elePar.top=0}if(m.elePar.top+m.elePar.height>g&&q<m.elePar.top+m.elePar.height&&(i.css("min-height",m.elePar.top+m.elePar.height),n=!0),n&&null!==k){var r={width:i.width(),height:i.height(),left:parseInt(d.css("left")),top:parseInt(d.css("top"))},s={ID:k,elePar:r};$(b).trigger("groupUpdate",s)}}})}}}),angular.module("myBuilderApp").directive("headDefault",["creatorServices","sessionSettingService","elePosition","builderTool",function(a,b,c,d){return{restrict:"AE",template:function(a,b){var c=a.get(0).eleConfig;console.dir(a.get(0).eleConfig);var d="";return d=b.thumbnail?"<div class='ele-session-box' id="+c.ID+' ele-type=\'session\'><div class="over-shadow"></div><div class="ele-session"></div></div>':"<div class='ele-session-box' id="+c.ID+" ele-type='session' session-resize ng-mouseover=hoverSession($event,'"+c.ID+'\')><div class="session-resize only-bottom z-depth-2" ele-type="resize"><i ele-type="resize" class="mdi mdi-arrow-down-bold"></i></div><div add-session-handle></div><div class="over-shadow"></div><div class="ele-session"></div><div class=\'menu-tool-box\'><div class="fab"><button class="fab__primary btn btn--m btn--blue btn--fab" lx-ripple tooltip-position="top"><i class="mdi mdi-dots-horizontal"></i><i class="mdi mdi-close"></i></button><div class="fab__actions fab__actions--left"><button class="btn btn--s btn--white btn--fab" lx-ripple lx-tooltip="更换背景" ng-click=changeBackground($event,"'+c.ID+'") tooltip-position="bottom"><i class="mdi mdi-image-area"></i></button><button class="btn btn--s btn--white btn--fab" lx-ripple lx-tooltip="设置" tooltip-position="bottom"><i class="mdi mdi-settings"></i></button></div></div></div>'},replace:!1,compile:function(b,c){var e=b.get(0).eleConfig,f=$(b).find(".ele-session-box");if($.each(e.style,function(a,b){f.css(a,b)}),void 0!==e["class"])for(var g=0;g<e["class"].length;g++)f.addClass(e["class"][g]);if("video"==e.background.type){var h={url:e.background.url,previewImage:e.background.previewImage};d.createSessionVideo($(b).find(".ele-session-box"),h)}"image"==e.background.type&&f.css("background-image","url("+e.background.url+")");for(var i=f.find(".ele-session"),j=0;j<e.eleList.length;j++)i.append(a.createEle(e.eleList[j]));return function(a,b,c){var e=b.get(0).eleConfig;$(document).on("resize",function(){if("video"==e.background.type){var a=$(b).find(".video-background video");d.fixVideoPosition($(b).find(".ele-session-box"),a)}})}}}}]).directive("sessionDefault",["creatorServices","sessionSettingService","elePosition","builderTool",function(a,b,c,d){return{restrict:"AE",template:function(a,b){var c=a.get(0).eleConfig,d="";return d=b.thumbnail?"<div class='ele-session-box' id="+c.ID+' ele-type=\'session\'><div class="over-shadow"></div><div class="ele-session"></div></div>':"<div class='ele-session-box' id="+c.ID+" ele-type='session' session-resize ng-mouseover=hoverSession($event,'"+c.ID+'\')><div class="session-resize only-bottom z-depth-2" ele-type="resize"><i ele-type="resize" class="mdi mdi-arrow-down-bold"></i></div><div add-session-handle></div><div class="over-shadow"></div><div class="ele-session"></div><div class=\'menu-tool-box\'><div class="fab"><button class="fab__primary btn btn--m btn--blue btn--fab" lx-ripple tooltip-position="top"><i class="mdi mdi-dots-horizontal"></i><i class="mdi mdi-close"></i></button><div class="fab__actions fab__actions--left"><button id="deleteSessionButton" class="btn btn--s btn--red btn--fab" lx-ripple lx-tooltip="删除" tooltip-position="bottom" ng-click=deleteSession("'+c.ID+'")><i class="mdi mdi-delete"></i></button><button id="moveUpButton" class="btn btn--s btn--white btn--fab" lx-ripple lx-tooltip="向上移动" tooltip-position="bottom"><i class="mdi mdi-chevron-double-up"></i></button><button id="moveDownButton" class="btn btn--s btn--white btn--fab" lx-ripple lx-tooltip="向下移动" tooltip-position="bottom"><i class="mdi mdi-chevron-double-down"></i></button><button class="btn btn--s btn--white btn--fab" lx-ripple lx-tooltip="更换背景" ng-click=changeBackground($event,"'+c.ID+'") tooltip-position="bottom"><i class="mdi mdi-image-area"></i></button><button class="btn btn--s btn--white btn--fab" lx-ripple lx-tooltip="设置" tooltip-position="bottom"><i class="mdi mdi-settings"></i></button></div></div></div>'},replace:!1,compile:function(b,c){var e=b.get(0).eleConfig,f=$(b).find(".ele-session-box");if($.each(e.style,function(a,b){f.css(a,b)}),void 0!==e["class"])for(var g=0;g<e["class"].length;g++)f.addClass(e["class"][g]);if("video"==e.background.type){var h={url:e.background.url,previewImage:e.background.previewImage};d.createSessionVideo($(b).find(".ele-session-box"),h)}"image"==e.background.type&&f.css("background-image","url("+e.background.url+")");for(var i=f.find(".ele-session"),j=0;j<e.eleList.length;j++)i.append(a.createEle(e.eleList[j]));return function(a,b,c){var e=b.get(0).eleConfig;$(document).on("resize",function(){if("video"==e.background.type){var a=$(b).find(".video-background video");d.fixVideoPosition($(b).find(".ele-session-box"),a)}})}}}}]).directive("eleTextDefault",["eleApplyService","elePosition","$timeout",function(a,b,c){return{restrict:"AE",template:function(a,b){var c=a.get(0).eleConfig,d="";return d=b.thumbnail?['<div id="'+c.ID+'" ele-type="'+c.type+'" class="position-box">','                <div class="ele-label">文本</div>','                <div class="ele-box">','                    <div class="ele ele-text">',c.textValue,"                    </div>","                </div>","            </div>"].join(""):['<div id="'+c.ID+'" ele-type="'+c.type+'" class="position-box" ng-class="{true:\'active\'}[activeEle.ID==\''+c.ID+'\']" full-text drag-ele="ele-web" rotate="ele-web" resize="ele-web" ng-dblclick=editEleText(\''+c.ID+"') ng-mousedown=selectEle($event,'"+c.ID+"')>",'                <div class="rotate no-top-resize" onmousedown="event.preventDefault();event.stopPropagation();"><i class="mdi mdi-refresh"></i></div>','                <div class="line text-line" onmousedown="event.preventDefault()"></div>','                <div class="center" onmousedown="event.preventDefault()"></div>','                <div class="resize only-left" onmousedown="event.preventDefault()"></div>','                <div class="resize only-right" onmousedown="event.preventDefault()"></div>','                <div class="ele-label">文本</div>','                <div class="ele-box">','                    <div class="ele ele-text">',c.textValue,"                    </div>","                </div>","            </div>"].join("")},replace:!1,link:function(b,d,e){var f=d.get(0).eleConfig;a.defaultApply($(d).find(">.position-box"),f),c(function(){var a=$(d).find(">.position-box >.ele-box >.ele"),b=a.height();a.css("margin-top",-b/2)})}}}]).directive("eleImageDefault",["eleApplyService",function(a){return{restrict:"AE",template:function(a,b){var c=a.get(0).eleConfig,d="";return d=b.thumbnail?['<div id="'+c.ID+'" ele-type="'+c.type+'" class="position-box" background-size="'+c.backgroundSize+'">','                <div class="ele-label">图片</div>','                <div class="ele-box">','                    <img class="ele ele-image" src="'+c.url+'" onmousedown=event.preventDefault() onmousedown=event.preventDefault()/>',"                </div>","            </div>"].join(""):['<div background-size="'+c.backgroundSize+'" id="'+c.ID+'" ele-type="'+c.type+'" class="position-box" ng-class="{true:\'active\'}[activeEle.ID==\''+c.ID+'\']" drag-ele="ele-web" rotate="ele-web" resize="ele-web" ng-dblclick=editEleImage(\''+c.ID+"') ng-mousedown=selectEle($event,'"+c.ID+"')>",'                <div class="rotate" onmousedown="event.preventDefault();event.stopPropagation();"><i class="mdi mdi-refresh"></i></div>','                <div class="line" onmousedown="event.preventDefault()"></div>','                <div class="center" onmousedown="event.preventDefault()"></div>','                <div class="resize left-top" onmousedown="event.preventDefault()"></div>','                <div class="resize left-bottom" onmousedown="event.preventDefault()"></div>','                <div class="resize right-top" onmousedown="event.preventDefault()"></div>','                <div class="resize right-bottom" onmousedown="event.preventDefault()"></div>','                <div class="resize only-left" onmousedown="event.preventDefault()"></div>','                <div class="resize only-right" onmousedown="event.preventDefault()"></div>','                <div class="resize only-top" onmousedown="event.preventDefault()"></div>','                <div class="resize only-bottom" onmousedown="event.preventDefault()"></div>','                <div class="ele-label">图片</div>','                <div class="ele-box" onmousedown=event.preventDefault()>','                    <img class="ele ele-image" src="'+c.url+'" onmousedown=event.preventDefault() onmousedown=event.preventDefault()/>',"                </div>","            </div>"].join("")},replace:!1,link:function(b,c,d){var e=c.get(0).eleConfig;a.defaultApply($(c).find(">.position-box"),e)}}}]).directive("eleGroupDefault",["eleApplyService","creatorServices",function(a,b){return{restrict:"AE",template:function(a,b){var c=a.get(0).eleConfig,d="";return d=b.thumbnail?['<div id="'+c.ID+'" ele-type="'+c.type+'" class="position-box">','                <div class="ele-label">组</div>','                <div class="ele-box">','                   <div class="group-over">',"                   </div>",'                    <div class="ele ele-group">',"                    </div>","                </div>","            </div>"].join(""):['<div id="'+c.ID+'" ele-type="'+c.type+'" on-group-size-change class="position-box" ng-class="{true:\'active\'}[activeEle.ID==\''+c.ID+'\']" drag-ele="ele-web" resize="ele-web">','                <div class="center" onmousedown="event.preventDefault()"></div>','                <div class="resize left-top" onmousedown="event.preventDefault()"></div>','                <div class="resize left-bottom" onmousedown="event.preventDefault()"></div>','                <div class="resize right-top" onmousedown="event.preventDefault()"></div>','                <div class="resize right-bottom" onmousedown="event.preventDefault()"></div>','                <div class="resize only-left" onmousedown="event.preventDefault()"></div>','                <div class="resize only-right" onmousedown="event.preventDefault()"></div>','                <div class="resize only-top" onmousedown="event.preventDefault()"></div>','                <div class="resize only-bottom" onmousedown="event.preventDefault()"></div>','                <div class="ele-label">组</div>','                <div class="ele-box">','                   <div class="group-over" ng-dblclick=editEleGroup($event,\''+c.ID+"') ng-mousedown=selectEle($event,'"+c.ID+"')>","                   </div>",'                    <div class="ele ele-group">',"                    </div>","                </div>","            </div>"].join("")},replace:!1,compile:function(c,d){for(var e=c.get(0).eleConfig,f=$(c).find("> .position-box"),g=f.find(" >.ele-box >.ele"),h=0;h<e.eleList.length;h++)g.append(b.createEle(e.eleList[h]));return function(b,c,d){var e=c.get(0).eleConfig;a.defaultApply($(c).find(">.position-box"),e)}}}}]).directive("eleMenuDefault",["eleApplyService","$timeout",function(a,b){return{restrict:"AE",template:function(a,b){var c=a.get(0).eleConfig,d="";return d=b.thumbnail?['<div id="'+c.ID+'" ele-type="'+c.type+'" class="position-box">','                <div class="ele-label">导航</div>','                <div class="ele-box">','                   <div class="menu-box ele"></div>',"                </div>","            </div>"].join(""):['<div id="'+c.ID+'" ele-type="'+c.type+'" class="position-box" ng-class="{true:\'active\'}[activeEle.ID==\''+c.ID+'\']" drag-ele="ele-web" rotate="ele-web" resize="ele-web" ng-mousedown=selectEle($event,\''+c.ID+"')>",'                <div class="rotate" onmousedown="event.preventDefault();event.stopPropagation();"><i class="mdi mdi-refresh"></i></div>','                <div class="line" onmousedown="event.preventDefault()"></div>','                <div class="center" onmousedown="event.preventDefault()"></div>','                <div class="resize left-top" onmousedown="event.preventDefault()"></div>','                <div class="resize left-bottom" onmousedown="event.preventDefault()"></div>','                <div class="resize right-top" onmousedown="event.preventDefault()"></div>','                <div class="resize right-bottom" onmousedown="event.preventDefault()"></div>','                <div class="resize only-left" onmousedown="event.preventDefault()"></div>','                <div class="resize only-right" onmousedown="event.preventDefault()"></div>','                <div class="resize only-top" onmousedown="event.preventDefault()"></div>','                <div class="resize only-bottom" onmousedown="event.preventDefault()"></div>','                <div class="ele-label">导航</div>','                <div class="ele-box">','                   <div class="menu-box ele"></div>',"                </div>","            </div>"].join("")},replace:!1,link:function(c,d,e){for(var f=d.get(0).eleConfig,g=$(d).find("> .position-box"),h=g.find(" >.ele-box >.ele"),i=f.item.length,j=0;i>j;j++){var k=$("<div class='menu-item' id="+f.item[j].ID+">"+f.item[j].name+"</div>");k.css({width:(100/i).toFixed(2)+"%","float":"left"}),h.append(k)}b(function(){var a=$(d).find(">.position-box >.ele-box >.ele"),b=a.height();a.css("margin-top",-b/2)}),a.defaultApply($(d).find(">.position-box"),f)}}}]).directive("headDefaultPhone",["phoneCreatorServices","builderTool",function(a,b){return{restrict:"AE",template:function(a,b){var c=a.get(0).eleConfig,d="";return d=b.thumbnail?"<div class='ele-session-box' id="+c.ID+' ele-type=\'session\')><div class="over-shadow"></div><div class="ele-session"></div></div>':"<div class='ele-session-box' id="+c.ID+" ele-type='session' session-resize='phone' phone-right-click-menu-init ng-mouseover=hoverSession($event,'"+c.ID+'\')><div class="session-resize phone only-bottom z-depth-2" ele-type="resize"><i ele-type="resize" class="mdi mdi-arrow-down-bold"></i></div><div class="over-shadow"></div><div class="ele-session"></div><div class="menu-tool-box phone"><button class="btn btn--s btn--red btn--fab" lx-ripple lx-tooltip="隐藏" tooltip-position="bottom" ng-click=deleteSession("'+c.ID+'")><i class="mdi mdi-delete"></i></button></div></div>'},replace:!1,compile:function(c,d){var e=c.get(0).eleConfig,f=$(c).find(".ele-session-box");if($.each(e.style,function(a,b){f.css(a,b)}),$.each(e.phoneStyle,function(a,b){f.css(a,b)}),void 0!==e["class"])for(var g=0;g<e["class"].length;g++)f.addClass(e["class"][g]);if("video"==e.background.type){var h={url:e.background.url,previewImage:e.background.previewImage};b.createSessionVideo($(c).find(".ele-session-box"),h)}"image"==e.background.type&&f.css("background-image","url("+e.background.url+")");for(var i=f.find(".ele-session"),j=0;j<e.eleList.length;j++){var k=a.createEle(e.eleList[j]);i.append(k),e.eleList[j].showState===!1&&k.css("display","none")}return function(a,c,d){var e=c.get(0).eleConfig;$(document).on("resize",function(){if("video"==e.background.type){var a=$(c).find(".video-background video");b.fixVideoPosition($(c).find(".ele-session-box"),a)}})}}}}]).directive("sessionDefaultPhone",["phoneCreatorServices","builderTool",function(a,b){return{restrict:"AE",template:function(a,b){var c=a.get(0).eleConfig,d="";return d=b.thumbnail?"<div class='ele-session-box' id="+c.ID+' ele-type=\'session\')><div class="over-shadow"></div><div class="ele-session"></div></div>':"<div class='ele-session-box' id="+c.ID+" ele-type='session' session-resize='phone' phone-right-click-menu-init ng-mouseover=hoverSession($event,'"+c.ID+'\')><div class="session-resize phone only-bottom z-depth-2" ele-type="resize"><i ele-type="resize" class="mdi mdi-arrow-down-bold"></i></div><div class="over-shadow"></div><div class="ele-session"></div><div class=\'menu-tool-box phone\'><button class="btn btn--s btn--red btn--fab" lx-ripple lx-tooltip="隐藏" tooltip-position="bottom" ng-click=deleteSession("'+c.ID+'")><i class="mdi mdi-delete"></i></button></div></div>'},replace:!1,compile:function(c,d){var e=c.get(0).eleConfig,f=$(c).find(".ele-session-box");if($.each(e.style,function(a,b){f.css(a,b)}),$.each(e.phoneStyle,function(a,b){f.css(a,b)}),void 0!==e["class"])for(var g=0;g<e["class"].length;g++)f.addClass(e["class"][g]);if("video"==e.background.type){var h={url:e.background.url,previewImage:e.background.previewImage};b.createSessionVideo($(c).find(".ele-session-box"),h)}"image"==e.background.type&&f.css("background-image","url("+e.background.url+")");for(var i=f.find(".ele-session"),j=0;j<e.eleList.length;j++){var k=a.createEle(e.eleList[j]);i.append(k),e.eleList[j].showState===!1&&k.css("display","none")}return function(a,c,d){var e=c.get(0).eleConfig;$(document).on("resize",function(){if("video"==e.background.type){var a=$(c).find(".video-background video");b.fixVideoPosition($(c).find(".ele-session-box"),a)}})}}}}]).directive("eleTextDefaultPhone",["eleApplyService","$timeout",function(a,b){return{restrict:"AE",template:function(a,b){var c=a.get(0).eleConfig,d="";return d=b.thumbnail?['<div id="'+c.ID+'" ele-type="'+c.type+'" class="position-box">','                <div class="ele-label">文本</div>','                <div class="ele-box">','                    <div class="ele ele-text">',c.textValue,"                    </div>","                </div>","            </div>"].join(""):['<div id="'+c.ID+'" ele-type="'+c.type+'" class="position-box" ng-class="{true:\'active\'}[activeEle.ID==\''+c.ID+'\']" drag-ele="ele-phone" rotate="ele-phone" resize="ele-phone" ng-dblclick=editEle(\''+c.ID+"') ng-mousedown=selectEle($event,'"+c.ID+"')>",'                <div class="rotate no-top-resize" onmousedown="event.preventDefault();event.stopPropagation();"><i class="mdi mdi-refresh"></i></div>','                <div class="line text-line" onmousedown="event.preventDefault()"></div>','                <div class="center" onmousedown="event.preventDefault()"></div>','                <div class="resize only-left" onmousedown="event.preventDefault()"></div>','                <div class="resize only-right" onmousedown="event.preventDefault()"></div>','                <div class="ele-label">文本</div>','                <div class="ele-box">','                    <div class="ele ele-text">',c.textValue,"                    </div>","                </div>","            </div>"].join("")},replace:!1,link:function(c,d,e){var f=d.get(0).eleConfig;a.phoneDefaultApply($(d).find(">.position-box"),f);var g=$(d).find(">.position-box"),h=g.find(" >.ele-box");h.css({transform:"scale("+f.phoneStyle.scale+","+f.phoneStyle.scale+")","-ms-transform":"scale("+f.phoneStyle.scale+","+f.phoneStyle.scale+")","-moz-transform":"scale("+f.phoneStyle.scale+","+f.phoneStyle.scale+")","-webkit-transform":"scale("+f.phoneStyle.scale+","+f.phoneStyle.scale+")","-o-transform":"scale("+f.phoneStyle.scale+","+f.phoneStyle.scale+")"}),h.css({"transform-origin":"0% 0%","-ms-transform-origin":"0% 0%","-moz-transform-origin":"0% 0%","-webkit-transform-origin":"0% 0%","-o-transform-origin":"0% 0%"}),$.each(f.phoneStyle.border,function(a,b){h.css(a,b)}),b(function(){var a=$(d).find(">.position-box >.ele-box >.ele"),b=a.height();a.css("margin-top",-b/2),g.css("height",h.get(0).offsetHeight*f.phoneStyle.scale),g.css("width",h.get(0).offsetWidth*f.phoneStyle.scale)})}}}]).directive("eleImageDefaultPhone",["eleApplyService",function(a){return{restrict:"AE",template:function(a,b){var c=a.get(0).eleConfig,d="";return d=b.thumbnail?['<div id="'+c.ID+'" ele-type="'+c.type+'" class="position-box" background-size="'+c.backgroundSize+'">','                <div class="ele-label">图片</div>','                <div class="ele-box">','                    <img class="ele ele-image" src="'+c.url+'" onmousedown=event.preventDefault() onmousedown=event.preventDefault()/>',"                </div>","            </div>"].join(""):['<div background-size="'+c.backgroundSize+'" id="'+c.ID+'" ele-type="'+c.type+'" class="position-box" ng-class="{true:\'active\'}[activeEle.ID==\''+c.ID+'\']" drag-ele="ele-phone" rotate="ele-phone" resize="ele-phone" ng-mousedown=selectEle($event,\''+c.ID+"')>",'                <div class="rotate" onmousedown="event.preventDefault();event.stopPropagation();"><i class="mdi mdi-refresh"></i></div>','                <div class="line" onmousedown="event.preventDefault()"></div>','                <div class="center" onmousedown="event.preventDefault()"></div>','                <div class="resize left-top" onmousedown="event.preventDefault()"></div>','                <div class="resize left-bottom" onmousedown="event.preventDefault()"></div>','                <div class="resize right-top" onmousedown="event.preventDefault()"></div>','                <div class="resize right-bottom" onmousedown="event.preventDefault()"></div>','                <div class="resize only-left" onmousedown="event.preventDefault()"></div>','                <div class="resize only-right" onmousedown="event.preventDefault()"></div>','                <div class="resize only-top" onmousedown="event.preventDefault()"></div>','                <div class="resize only-bottom" onmousedown="event.preventDefault()"></div>','                <div class="ele-label">图片</div>','                <div class="ele-box" onmousedown=event.preventDefault()>','                    <img class="ele ele-image" src="'+c.url+'" onmousedown=event.preventDefault() onmousedown=event.preventDefault()/>',"                </div>","            </div>"].join("")},replace:!1,link:function(b,c,d){var e=c.get(0).eleConfig;a.phoneDefaultApply($(c).find(">.position-box"),e)}}}]).directive("eleGroupDefaultPhone",["eleApplyService","phoneCreatorServices","$compile","$timeout",function(a,b,c,d){return{restrict:"AE",template:function(a,b){var c=a.get(0).eleConfig,d="";return d=b.thumbnail?['<div id="'+c.ID+'" ele-type="'+c.type+'" class="position-box">','                <div class="ele-label">组</div>','                <div class="ele-box">','                   <div class="group-over">',"                   </div>",'                    <div class="ele ele-group">',"                    </div>","                </div>","            </div>"].join(""):['<div id="'+c.ID+'" ele-type="'+c.type+'" on-group-size-change class="position-box" ng-class="{true:\'active\'}[activeEle.ID==\''+c.ID+'\']" drag-ele="ele-phone" resize="ele-phone">','                <div class="center" onmousedown="event.preventDefault()"></div>','                <div class="resize left-top" onmousedown="event.preventDefault()"></div>','                <div class="resize left-bottom" onmousedown="event.preventDefault()"></div>','                <div class="resize right-top" onmousedown="event.preventDefault()"></div>','                <div class="resize right-bottom" onmousedown="event.preventDefault()"></div>','                <div class="resize only-left" onmousedown="event.preventDefault()"></div>','                <div class="resize only-right" onmousedown="event.preventDefault()"></div>','                <div class="resize only-top" onmousedown="event.preventDefault()"></div>','                <div class="resize only-bottom" onmousedown="event.preventDefault()"></div>','                <div class="ele-label">组</div>','                <div class="ele-box">','                   <div class="group-over" ng-dblclick=editEleGroup($event,\''+c.ID+"') ng-mousedown=selectEle($event,'"+c.ID+"')>","                   </div>",'                    <div class="ele ele-group">',"                    </div>","                </div>","            </div>"].join("")},replace:!1,compile:function(c,e){for(var f=c.get(0).eleConfig,g=$(c).find(">.position-box"),h=g.find(" >.ele-box >.ele"),i=0;i<f.eleList.length;i++)h.append(b.createEle(f.eleList[i]));return function(b,c,e){var f=c.get(0).eleConfig;a.phoneDefaultApply($(c).find(">.position-box"),f),d(function(){var a=$(c).find(">.position-box >.ele-box >.ele"),b=a.height();a.css("margin-top",-b/2)})}}}}]).directive("eleMenuDefaultPhone",["eleApplyService","$timeout",function(a,b){return{restrict:"AE",template:function(a,b){var c=a.get(0).eleConfig,d="";return d=b.thumbnail?['<div id="'+c.ID+'" ele-type="'+c.type+'" class="position-box">','                <div class="ele-label">导航</div>','                <div class="ele-box">','                   <div class="menu-box phone ele"><i class="mdi mdi-menu"></i></div>',"                </div>","            </div>"].join(""):['<div id="'+c.ID+'" ele-type="'+c.type+'" class="position-box" ng-class="{true:\'active\'}[activeEle.ID==\''+c.ID+'\']" drag-ele="ele-phone" resize="ele-phone" ng-mousedown=selectEle($event,\''+c.ID+"')>",'                <div class="center" onmousedown="event.preventDefault()"></div>','                <div class="resize left-top" onmousedown="event.preventDefault()"></div>','                <div class="resize left-bottom" onmousedown="event.preventDefault()"></div>','                <div class="resize right-top" onmousedown="event.preventDefault()"></div>','                <div class="resize right-bottom" onmousedown="event.preventDefault()"></div>','                <div class="resize only-left" onmousedown="event.preventDefault()"></div>','                <div class="resize only-right" onmousedown="event.preventDefault()"></div>','                <div class="resize only-top" onmousedown="event.preventDefault()"></div>','                <div class="resize only-bottom" onmousedown="event.preventDefault()"></div>','                <div class="ele-label">导航</div>','                <div class="ele-box">','                   <div class="menu-box phone ele"><i class="mdi mdi-menu"></i></div>',"                </div>","            </div>"].join("");
},replace:!1,link:function(c,d,e){var f=d.get(0).eleConfig,g=$(d).find(">.position-box"),h=g.find(" >.ele-box >.ele");h.find("i").css("color",f.phoneStyle.style.color),h.find("i").css("font-size",f.phoneStyle.style["font-size"]),b(function(){var a=$(d).find(">.position-box >.ele-box >.ele"),b=a.height();a.css("margin-top",-b/2)}),a.phoneDefaultApply($(d).find(">.position-box"),f)}}}]).factory("eleApplyService",function(){var a={defaultApply:function(a,b){a=$(a),$.each(b.position,function(b,c){a.css(b,c)});var c=a.find(" >.ele-box");$.each(b.border,function(a,b){c.css(a,b)});var d=c.find(" >.ele");$.each(b.style,function(a,b){d.css(a,b)})},phoneDefaultApply:function(a,b){a=$(a),a.attr("scale",b.phoneStyle.scale),$.each(b.position,function(b,c){a.css(b,c)});var c=a.find(" >.ele-box");$.each(b.border,function(a,b){c.css(a,b)});var d=c.find(" >.ele");$.each(b.style,function(a,b){d.css(a,b)}),$.each(b.phoneStyle.style,function(a,b){d.css(a,b)}),$.each(b.phoneStyle.position,function(b,c){a.css(b,c)}),$.each(b.phoneStyle.border,function(a,b){c.css(a,b)})}};return a}),angular.module("myBuilderApp").controller("textResourceCtrl",["$scope",function(a){a.activeEleList={ID:"text",name:"文本",template:"views/eleResource/text.html",eleList:[{ID:"1",type:"text",textValue:'<div><span class="author-galadriel"><span style="font-size: 24px;"><span style="color: rgb(0, 0, 0);">Site Title</span></span></span></div>',style:{},position:{left:"45px",top:"130px"},border:{width:"240px","min-height":"50px"},phoneStyle:{position:{left:"17px",top:"28px"},border:{width:"240px","min-height":"50px"},style:{},scale:.7},eleTemplateType:"ele-text-default"},{ID:"2",type:"text",textValue:'<div><span class="author-galadriel"><span style="font-size: 34px;"><span style="color: rgb(0, 0, 0);">Site Title</span></span></span></div>',style:{},position:{left:"45px",top:"130px"},border:{width:"240px","min-height":"50px"},phoneStyle:{position:{left:"17px",top:"28px"},border:{width:"240px","min-height":"50px"},style:{},scale:.7},eleTemplateType:"ele-text-default"},{ID:"3",type:"text",textValue:'<div><span class="author-galadriel"><span style="font-size: 44px;"><span style="color: rgb(0, 0, 0);">Site Title</span></span></span></div>',style:{},position:{left:"45px",top:"130px"},border:{width:"240px","min-height":"50px"},phoneStyle:{position:{left:"17px",top:"28px"},border:{width:"240px","min-height":"50px"},style:{},scale:.7},eleTemplateType:"ele-text-default"}]}}]).controller("imageResourceCtrl",["$scope",function(a){a.activeEleList={ID:"image",name:"基础图片",template:"views/eleResource/image.html",eleList:[{preview:"images/imageDesign/2.png",data:{ID:"eleeee23",type:"image",url:"images/imageDesign/2.png",backgroundSize:"contain",imageSize:{width:"260px",height:"196px"},phoneStyle:{position:{left:"0px",top:"110px"},border:{width:"260px","min-height":"196px"},style:{width:"260px",height:"196px",clip:"rect(0px 260px 196px 0px)"},scale:.7},style:{width:"260px",height:"196px",clip:"rect(0px 260px 196px 0px)"},position:{left:"580px",top:"81px"},border:{width:"260px","min-height":"196px"},eleTemplateType:"ele-image-default"}},{preview:"images/imageDesign/1.png",data:{ID:"eleeee23",type:"image",url:"images/imageDesign/1.png",backgroundSize:"contain",imageSize:{width:"260px",height:"196px"},phoneStyle:{position:{left:"0px",top:"110px"},border:{width:"260px","min-height":"196px"},style:{width:"260px",height:"196px",clip:"rect(0px 260px 196px 0px)"},scale:.7},style:{width:"260px",height:"196px",clip:"rect(0px 260px 196px 0px)"},position:{left:"580px",top:"81px"},border:{width:"260px","min-height":"196px","background-color":"#fff","box-shadow":"0px 8px 17px 0px rgba(0, 0, 0, 0.2)","border-radius":"8px"},eleTemplateType:"ele-image-default"}},{preview:"images/imageDesign/3.png",data:{ID:"eleeee23",type:"image",url:"images/imageDesign/3.png",backgroundSize:"contain",imageSize:{width:"260px",height:"196px"},phoneStyle:{position:{left:"0px",top:"110px"},border:{width:"260px","min-height":"196px"},style:{width:"260px",height:"196px",clip:"rect(0px 260px 196px 0px)"},scale:.7},style:{width:"260px",height:"196px",clip:"rect(0px 260px 196px 0px)"},position:{left:"580px",top:"81px"},border:{width:"260px","min-height":"196px","background-color":"#fff","box-shadow":"0px 8px 17px 0px rgba(0, 0, 0, 0.2)","border-radius":"50%"},eleTemplateType:"ele-image-default"}}]}}]).factory("eleResourceTemplate",function(){var a=[{ID:"text",name:"文本",template:"views/eleResource/text.html"},{ID:"image",name:"图片",template:"views/eleResource/image.html"}],b={getEleList:function(){return a}};return b}),angular.module("myBuilderApp").factory("userProfile",["LxNotificationService",function(a){var b=["#F44336","#448AFF","#FF9800","#00BCD4","#FF4081"],c={getMyColor:function(){return b},addMyColor:function(c){return b.length>=9?void a.info("最多只能添加九个颜色"):void b.unshift(c)}};return c}]).factory("siteConfig",function(){var a={themeColor:[{type:"darkPrimaryColor",value:"#0288D1"},{type:"primaryColor",value:"#03A9F4"},{type:"lightPrimaryColor",value:"#B3E5FC"},{type:"text",value:"#ffffff"},{type:"accentColor",value:"#00BCD4"},{type:"primaryText",value:"#212121"},{type:"secondaryText",value:"#727272"},{type:"divider",value:"#B6B6B6"}]},b={getThemeColor:function(){return a.themeColor},setThemeColor:function(b){a.themeColor=b}};return b}).factory("fontList",function(){var a={en:["Candara","Helvetica"],cn:["微软雅黑","华文细黑"]},b={getList:function(b){return a[b]}};return b}).factory("shearPlate",function(){var a={type:"",pageID:"",value:null},b={setData:function(b,c,d){a.type=b,a.pageID=c,a.value=angular.copy(d)},getData:function(){var b=jQuery.extend(!0,{},a);return"cut"===a.type&&(a.type="",a.value=null,a.ID=""),b},getHandle:function(){return a}};return b}).factory("activeEleService",["eleMenuServices","websiteData","activePageService",function(a,b,c){var d={ID:"ele",value:{}},e={getEle:function(){return d.value=b.getEle(c.getActivePage().value,d.value.ID),d},setEle:function(b){d.value=b,"edit"===d.value.state?a.hideDom():a.showDom(d.value.ID,d.value.type)},clear:function(){d.value={},a.hideDom(!0)}};return e}]).factory("activeSessionService",function(){var a={ID:"session",value:{}},b={getSession:function(){return a},setSession:function(b){a.value=b},check:function(b){return b!==a.value?a.value:!1}};return b}).factory("elePosition",function(){var a={getLeft:function(a,b){if(void 0!==b&&$(a).get(0)==b)return 0;var c=a.offsetLeft;return null!==a.offsetParent&&(c+=this.getLeft(a.offsetParent,b)),c},getTop:function(a,b){if(void 0!==b&&$(a).get(0)==b)return 0;var c=a.offsetTop;return null!==a.offsetParent&&(c+=this.getTop(a.offsetParent,b)),c}};return a}).factory("levelScroll",["$timeout","$rootScope",function(a,b){var c={delay:8},d={scrollTop:function(d,e,f){function g(c,d,e){c.scrollTop(d+f),e>d+f?a(function(){g(c,d+f,e)},1):b.$emit("levelScrollEnd")}function h(c,d,e){c.scrollTop(d-f),d-f>e?a(function(){h(c,d-f,e)},1):b.$emit("levelScrollEnd")}void 0===f&&(f=c.delay),b.$emit("levelScrollStart");var i=d.scrollTop();e>i?g(d,i,e):h(d,i,e)},scrollLeft:function(a,b){}};return d}]).factory("activePageService",function(){var a={ID:"page",value:{}},b={getActivePage:function(){return a},setActivePage:function(b){a.value=b}};return b}).factory("rotateEleCalculate",function(){var a={getSizeAndPosition:function(a,b,c,d,e){var f={left:0,top:0,width:0,height:0};return f.width=Math.abs(Math.cos(e*Math.PI/180))*c+Math.abs(Math.sin(e*Math.PI/180))*d,f.height=Math.abs(Math.sin(e*Math.PI/180))*c+Math.abs(Math.cos(e*Math.PI/180))*d,f.left=a+(c-f.width)/2,f.top=b+(d-f.height)/2,f.originalLeft=a,f.originalTop=b,f},getRotate:function(a){var b=$(a).css("transform"),c=0;return"none"===b?c=0:(b=b.substring(7,b.length-1),c=180*Math.acos(parseFloat(b.split(",")[0]))/Math.PI,parseFloat(b.split(",")[1])<0&&(c=360-c)),c}};return a}),angular.module("myBuilderApp").directive("rotate",["builderTool","phoneBuilderTool","activePageService","websiteData","rotateEleCalculate","eleIndicator","$rootScope",function(a,b,c,d,e,f,g){return{restrict:"A",link:function(h,i,j){function k(a){if(m.flag){var b=a.pageX-m.cx,c=a.pageY-m.cy,d=Math.abs(b/c),g=Math.atan(d)/(2*Math.PI)*360;0>b&&0>c?g=270+(90-g):0>b&&c>0?g=180+g:b>0&&0>c?g=g:b>0&&c>0&&(g=180-g);var h=g;if(i.css("transform","rotate("+h+"deg)"),m.isGroupEle){var j=e.getSizeAndPosition(m.left,m.top,$(i).outerWidth(),$(i).outerHeight(),h),k={ID:n,elePar:j};$(i).trigger("groupUpdate",k)}f.update()}}function l(h){if(m.flag){if(m.flag=!1,g.$emit("eleDragEnd"),"ele-web"==m.type){var k=a.getEle(j.id,j.eleType);d.updateEle(c.getActivePage().value,k),a.reviseRotateCss(e.getRotate(i),j.id)}if("ele-phone"==m.type){var k=b.getEle(j.id,j.eleType);d.updatePhoneEle(c.getActivePage().value,k),a.reviseRotateCss(e.getRotate(i),j.id)}f.remove()}}var m={cx:0,cy:0,flag:!1,px:0,py:0,eleHeight:0,eleWidth:0,rotate:0,isGroupEle:"",left:0,right:0};m.type=j.rotate;var n="",o="";if($(i).parents(".position-box[ele-type=group]").length>0){m.isGroupEle=!0;var p=$(i).parents(".position-box[ele-type=group]");n=p.eq(0).attr("id"),o=p.eq(p.length-1).attr("id")}a.reviseRotateCss(e.getRotate(i),j.id),$(i).find(" >.rotate").on("mousedown",function(a){m.flag=!0;var b=$(i).find(" >.center").offset();g.$emit("eleDragStart"),m.eleHeight=$(i).get(0).clientHeight,m.eleWidth=$(i).get(0).clientWidth,m.cx=b.left,m.cy=b.top,m.px=b.left,m.py=b.top+m.eleHeight/2+10,m.left=parseInt($(i).css("left")),m.top=parseInt($(i).css("top")),m.isGroupEle&&($(i).trigger("groupUpdateInit",n),a.stopPropagation()),f.add($(i),0,-38,"rotate")}),$(document).on("mousemove",k),$(document).on("mouseup",l),h.$on("$destroy",function(){$(document).off("mousemove",k),$(document).off("mouseup",l)})}}}]).directive("dragEle",["activeSessionService","builderTool","phoneBuilderTool","websiteData","changeSessionTool","rotateEleCalculate","activePageService","$rootScope","eleIndicator","autoAlignment",function(a,b,c,d,e,f,g,h,i,j){return{restrict:"A",link:function(a,k,l){function m(a){if(!o.contenteditable&&o.flag){t&&(t=!1);var b=a.clientX-o.cx,c=a.clientY-o.cy;if(b+=o.left,c+=o.top,o.type.indexOf("ele")>=0?"ele-web"===o.type&&o.isGroupEle!==!0&&e.moveCheck(a.clientY-o.cy):(10>b&&(b=10),60>c&&(c=60),b+o.eleWidth>o.bodyWidth&&(b=o.bodyWidth-10-o.eleWidth),c+o.eleHeight>o.bodyHeight&&(c=o.bodyHeight-10-o.eleHeight)),o.isGroupEle){var d=$(k).outerWidth(),g=$(k).outerHeight(),h=f.getSizeAndPosition(b,c,d,g,o.rotate),l={ID:p,elePar:h};$(k).trigger("groupUpdate",l),h.left<0&&(b=(h.width-d)/2),h.top<0&&(c=(h.height-g)/2)}if("ele-web"==o.type||"ele-phone"==o.type){i.update();var m={leftStart:b,leftEnd:b+o.eleWidth,topStart:c,topEnd:c+o.eleHeight},n=j.calculatePosition(m);$(k).css({left:n.left+"px",top:n.top+"px"})}else $(k).css({left:b+"px",top:c+"px"})}}function n(f){if(o.flag){if(o.flag=!1,t===!1&&(t=!0),"ele-web"===o.type){var j=[{ID:l.id,type:l.eleType}];if(o.isGroupEle!==!0)a.$apply(function(){e.overCheck(j)});else{var k=b.getEle(q,"group");a.$apply(function(){d.updateEle(g.getActivePage().value,k)})}}if("ele-phone"===o.type)if(o.isGroupEle!==!0){var k=c.getEle(l.id,l.eleType);a.$apply(function(){d.updatePhoneEle(g.getActivePage().value,k)})}else{var k=c.getEle(q,"group");a.$apply(function(){d.updatePhoneEle(g.getActivePage().value,k)})}("ele-web"==o.type||"ele-phone"==o.type)&&(i.remove(),h.$emit("eleDragEnd"))}}var o={flag:!1,left:0,top:0,cx:0,cy:0,bodyWidth:0,bodyHeight:0,eleWidth:0,eleHeight:0,type:"",contenteditable:!1,currentSession:"",isGroupEle:!1,rotate:0},p="",q="";if($(k).parents(".position-box[ele-type=group]").length>0){o.isGroupEle=!0;var r=$(k).parents(".position-box[ele-type=group]");p=r.eq(0).attr("id"),q=r.eq(r.length-1).attr("id")}o.type=l.dragEle;var s=null;s=void 0===l.handle?k:k.find("."+l.handle),s.on("mousedown",function(a){if(1===a.buttons){var b=$(k).attr("multiple-choice");"true"!==b&&(o.flag=!0,o.left=$(k).get(0).offsetLeft,o.top=$(k).get(0).offsetTop,o.cx=a.clientX,o.cy=a.clientY,o.bodyWidth=$("body").width(),o.bodyHeight=$("body").height(),o.eleWidth=$(k).outerWidth(),o.eleHeight=$(k).outerHeight(),o.contenteditable=$(k).find(".ele .ql-editor").attr("contenteditable"),o.rotate=f.getRotate(k),o.isGroupEle&&($(k).trigger("groupUpdateInit",p),a.stopPropagation()),"ele-web"===o.type&&e.init($(k).parents(".ele-session-box").attr("id"),o.top+o.eleHeight/2),("ele-web"==o.type||"ele-phone"==o.type)&&(h.$emit("eleDragStart"),j.init($(k).parents(".ele-session-box"),$(k)),Boolean(o.contenteditable)===!1&&i.add($(k),0,-38,"position")))}});var t=!0;$(document).on("mousemove",m),$(document).on("mouseup",n),a.$on("$destroy",function(){$(document).off("mousemove",m),$(document).off("mouseup",n)})}}}]).directive("resize",["$timeout","builderTool","phoneBuilderTool","websiteData","rotateEleCalculate","activePageService","$rootScope","imageCropService","eleIndicator",function(a,b,c,d,e,f,g,h,i){return{restrict:"A",link:function(a,j,k){function l(){var a=C.height()/2;C.css("margin-top",-a+"px"),$(C).resize(function(){C.is(":hidden")||("text"==D?B.css("min-height",C.height()+"px"):C.height()>parseInt(B.css("min-height"))&&B.css("min-height",C.height()+"px"))}),$(j).resize(function(){if(!C.is(":hidden")){var a=C.height()/2;C.css("margin-top",-a+"px")}})}function m(a,b){return 20>a||20>b?!1:!0}function n(a,b,c){var d=0,e=0,f=0;switch(c){case 0:d=(-a+x.eleWidth)/x.eleWidth;break;case 1:d=(-b+x.eleHeight)/x.eleHeight;break;case 2:d=(a+x.eleWidth)/x.eleWidth;break;case 3:d=(a+x.eleWidth)/x.eleWidth;break;case 4:d=(a+x.eleWidth)/x.eleWidth;break;case 5:d=(b+x.eleHeight)/x.eleHeight;break;case 6:d=(-a+x.eleWidth)/x.eleWidth;break;case 7:d=(-a+x.eleWidth)/x.eleWidth}if(e=parseInt(x.eleHeight*d),f=parseInt(x.eleWidth*d),m(f,e)){B.css({"min-height":e+"px",width:f+"px"});var g=0,h=0;switch(c){case 0:h=x.top+(x.eleHeight-e),g=x.left+(x.eleWidth-f);break;case 1:h=x.top+(x.eleHeight-e),g=x.left;break;case 2:h=x.top+(x.eleHeight-e),g=x.left;break;case 3:h=x.top+(x.eleHeight-e),g=x.left;break;case 4:h=x.top,g=x.left;break;case 5:h=x.top,g=x.left+(x.eleWidth-f);break;case 6:h=x.top,g=x.left+(x.eleWidth-f);break;case 7:h=x.top+(x.eleHeight-e),g=x.left+(x.eleWidth-f)}return $(j).css({left:g+"px",top:h+"px"}),{type:"leftTop",scale:d}}}function o(a,b,c){var d=0,e=0,f=0;switch(c){case 0:d=(-a+x.eleWidth)/x.eleWidth;break;case 1:d=(-b+x.eleHeight)/x.eleHeight;break;case 2:d=(a+x.eleWidth)/x.eleWidth;break;case 3:d=(a+x.eleWidth)/x.eleWidth;break;case 4:d=(a+x.eleWidth)/x.eleWidth;break;case 5:d=(b+x.eleHeight)/x.eleHeight;break;case 6:d=(-a+x.eleWidth)/x.eleWidth;break;case 7:d=(-a+x.eleWidth)/x.eleWidth}if(e=parseInt(x.eleHeight*d),f=parseInt(x.eleWidth*d),!m(f,e))return null;B.css({"min-height":e+"px",width:f+"px"});var g=0,h=0;switch(c){case 0:h=x.top+(x.eleHeight-e),g=x.left+(x.eleWidth-f);break;case 1:h=x.top+(x.eleHeight-e),g=x.left;break;case 2:h=x.top+(x.eleHeight-e),g=x.left;break;case 3:h=x.top+(x.eleHeight-e),g=x.left;break;case 4:h=x.top,g=x.left;break;case 5:h=x.top,g=x.left+(x.eleWidth-f);break;case 6:h=x.top,g=x.left+(x.eleWidth-f);break;case 7:h=x.top+(x.eleHeight-e),g=x.left+(x.eleWidth-f)}return j.css({top:h,left:g}),{type:"leftBottom",scale:d}}function p(a,b,c){var d=0,e=0,f=0;switch(c){case 0:d=(-a+x.eleWidth)/x.eleWidth;break;case 1:d=(-b+x.eleHeight)/x.eleHeight;break;case 2:d=(a+x.eleWidth)/x.eleWidth;break;case 3:d=(a+x.eleWidth)/x.eleWidth;break;case 4:d=(a+x.eleWidth)/x.eleWidth;break;case 5:d=(b+x.eleHeight)/x.eleHeight;break;case 6:d=(-a+x.eleWidth)/x.eleWidth;break;case 7:d=(-a+x.eleWidth)/x.eleWidth}if(e=parseInt(x.eleHeight*d),f=parseInt(x.eleWidth*d),!m(f,e))return null;B.css({"min-height":e+"px",width:f+"px"});var g=0,h=0;switch(c){case 0:h=x.top+(x.eleHeight-e),g=x.left+(x.eleWidth-f);break;case 1:h=x.top+(x.eleHeight-e),g=x.left;break;case 2:h=x.top+(x.eleHeight-e),g=x.left;break;case 3:h=x.top+(x.eleHeight-e),g=x.left;break;case 4:h=x.top,g=x.left;break;case 5:h=x.top,g=x.left+(x.eleWidth-f);break;case 6:h=x.top,g=x.left+(x.eleWidth-f);break;case 7:h=x.top+(x.eleHeight-e),g=x.left+(x.eleWidth-f)}return j.css({top:h,left:g}),{type:"rightTop",scale:d}}function q(a,b,c){var d=0,e=0,f=0;switch(c){case 0:d=(-a+x.eleWidth)/x.eleWidth;break;case 1:d=(-b+x.eleHeight)/x.eleHeight;break;case 2:d=(a+x.eleWidth)/x.eleWidth;break;case 3:d=(a+x.eleWidth)/x.eleWidth;break;case 4:d=(a+x.eleWidth)/x.eleWidth;break;case 5:d=(b+x.eleHeight)/x.eleHeight;break;case 6:d=(-a+x.eleWidth)/x.eleWidth;break;case 7:d=(-a+x.eleWidth)/x.eleWidth}if(e=parseInt(x.eleHeight*d),f=parseInt(x.eleWidth*d),!m(f,e))return null;B.css({"min-height":e+"px",width:f+"px"});var g=0,h=0;switch(c){case 0:h=x.top+(x.eleHeight-e),g=x.left+(x.eleWidth-f);break;case 1:h=x.top+(x.eleHeight-e),g=x.left;break;case 2:h=x.top+(x.eleHeight-e),g=x.left;break;case 3:h=x.top+(x.eleHeight-e),g=x.left;break;case 4:h=x.top,g=x.left;break;case 5:h=x.top,g=x.left+(x.eleWidth-f);break;case 6:h=x.top,g=x.left+(x.eleWidth-f);break;case 7:h=x.top+(x.eleHeight-e),g=x.left+(x.eleWidth-f)}return j.css({top:h,left:g}),{type:"rightBottom",scale:d}}function r(a,b,c){var d=0,e=0,f=0,g=0;switch(c){case 0:g=-a;break;case 1:g=-b;break;case 2:g=a;break;case 3:g=a;break;case 4:g=a;break;case 5:g=b;break;case 6:g=-a;break;case 7:g=-a}if(f=x.eleWidth+g,e=B.css("height"),d=f/x.eleWidth,!m(f,e))return null;B.css({width:f+"px"});var h=0,i=0;switch(c){case 0:i=x.top+(x.eleHeight-e),h=x.left+(x.eleWidth-f);break;case 1:i=x.top+(x.eleHeight-e),h=x.left;break;case 2:i=x.top+(x.eleHeight-e),h=x.left;break;case 3:i=x.top+(x.eleHeight-e),h=x.left;break;case 4:i=x.top,h=x.left;break;case 5:i=x.top,h=x.left+(x.eleWidth-f);break;case 6:i=x.top,h=x.left+(x.eleWidth-f);break;case 7:i=x.top+(x.eleHeight-e),h=x.left+(x.eleWidth-f)}return j.css({top:i,left:h}),{type:"left",scale:d}}function s(a,b,c){var d=0,e=0,f=0,g=0;switch(c){case 0:g=-a;break;case 1:g=-b;break;case 2:g=a;break;case 3:g=a;break;case 4:g=a;break;case 5:g=b;break;case 6:g=-a;break;case 7:g=-a}if(f=x.eleWidth+g,e=B.css("height"),d=f/x.eleWidth,!m(f,e))return null;B.css({width:f+"px"});var h=0,i=0;switch(c){case 0:i=x.top+(x.eleHeight-e),h=x.left+(x.eleWidth-f);break;case 1:i=x.top+(x.eleHeight-e),h=x.left;break;case 2:i=x.top+(x.eleHeight-e),h=x.left;break;case 3:i=x.top+(x.eleHeight-e),h=x.left;break;case 4:i=x.top,h=x.left;break;case 5:i=x.top,h=x.left+(x.eleWidth-f);break;case 6:i=x.top,h=x.left+(x.eleWidth-f);break;case 7:i=x.top+(x.eleHeight-e),h=x.left+(x.eleWidth-f)}return j.css({top:i,left:h}),{type:"right",scale:d}}function t(a,b,c){var d=0,e=0,f=0,g=0;switch(c){case 0:g=-a;break;case 1:g=-b;break;case 2:g=a;break;case 3:g=a;break;case 4:g=a;break;case 5:g=b;break;case 6:g=-a;break;case 7:g=-a}if(e=x.eleHeight+g,f=B.css("width"),d=e/x.eleHeight,!m(f,e))return null;B.css({"min-height":e+"px"});var h=0,i=0;switch(c){case 0:i=x.top+(x.eleHeight-e),h=x.left+(x.eleWidth-f);break;case 1:i=x.top+(x.eleHeight-e),h=x.left;break;case 2:i=x.top+(x.eleHeight-e),h=x.left;break;case 3:i=x.top+(x.eleHeight-e),h=x.left;break;case 4:i=x.top,h=x.left;break;case 5:i=x.top,h=x.left+(x.eleWidth-f);break;case 6:i=x.top,h=x.left+(x.eleWidth-f);break;case 7:i=x.top+(x.eleHeight-e),h=x.left+(x.eleWidth-f)}return j.css({top:i,left:h}),{type:"top",scale:d}}function u(a,b,c){var d=0,e=0,f=0,g=0;switch(c){case 0:g=-a;break;case 1:g=-b;break;case 2:g=a;break;case 3:g=a;break;case 4:g=a;break;case 5:g=b;break;case 6:g=-a;break;case 7:g=-a}if(e=x.eleHeight+g,f=B.css("width"),d=e/x.eleHeight,!m(f,e))return null;B.css({"min-height":e+"px"});var h=0,i=0;switch(c){case 0:i=x.top+(x.eleHeight-e),h=x.left+(x.eleWidth-f);break;case 1:i=x.top+(x.eleHeight-e),h=x.left;break;case 2:i=x.top+(x.eleHeight-e),h=x.left;break;case 3:i=x.top+(x.eleHeight-e),h=x.left;break;case 4:i=x.top,h=x.left;break;case 5:i=x.top,h=x.left+(x.eleWidth-f);break;case 6:i=x.top,h=x.left+(x.eleWidth-f);break;case 7:i=x.top+(x.eleHeight-e),h=x.left+(x.eleWidth-f)}return j.css({top:i,left:h}),{type:"bottom",scale:d}}function v(a){if(x.flag){var g=a.clientX-x.cx,l=a.clientY-x.cy;E&&(E=!1);var m={};switch(x.target){case 0:m=n(g,l,x.rightRotate);break;case 1:m=t(g,l,x.rightRotate);break;case 2:m=p(g,l,x.rightRotate);break;case 3:m=s(g,l,x.rightRotate);break;case 4:m=q(g,l,x.rightRotate);break;case 5:m=u(g,l,x.rightRotate);break;case 6:m=o(g,l,x.rightRotate);break;case 7:m=r(g,l,x.rightRotate)}if(x.isGroupEle){var v=parseInt($(j).css("left")),w=parseInt($(j).css("top")),z=$(j).outerWidth(),A=$(j).outerHeight(),B=e.getSizeAndPosition(v,w,z,A,x.rotate),C={ID:y,elePar:B};$(j).trigger("groupUpdate",C),B.left<0&&(g=(B.width-z)/2,$(j).css({left:g})),B.top<0&&(l=(B.height-A)/2,$(j).css({top:l+"px"}))}if("image"==D){var F=f.getActivePage().value,G=d.getEle(F,k.id);h.resetImage($(j),G,x.eleWidth,x.eleHeight,x.imageWidth,x.imageHeight,x.clip)}if("ele-phone"==x.type&&"text"==D){var H=x.eleData.phoneStyle.scale*parseInt($(j).find(">.ele-box").get(0).offsetWidth),I=x.eleData.phoneStyle.scale*parseInt($(j).find(">.ele-box").get(0).offsetHeight);$(j).css({width:H,height:I})}"group"!=D||0!==x.target&&2!==x.target&&4!==x.target&&6!==x.target||("ele-web"==x.type&&b.zoomEle(x.eleData,m.scale),"ele-phone"==x.type&&c.zoomEle(x.eleData,m.scale)),i.update()}}function w(e){if(x.flag){if(i.remove(),x.flag=!1,g.$emit("eleDragEnd"),E===!1&&(E=!0),"ele-web"==x.type)if(x.isGroupEle!==!0){var h=b.getEle(k.id,k.eleType);d.updateEle(a.websiteCode.ID,h)}else{var h=b.getEle(z,"group");d.updateEle(f.getActivePage().value,h)}if("ele-phone"==x.type)if(x.isGroupEle!==!0){var h=c.getEle(k.id,k.eleType);d.updatePhoneEle(f.getActivePage().value,h)}else{var h=c.getEle(z,"group");d.updatePhoneEle(f.getActivePage().value,h)}}}var x={flag:!1,left:0,top:0,cx:0,cy:0,eleWidth:0,eleHeight:0,target:"",isGroupEle:!1,rotate:0,rightRotate:0};x.type=k.resize;var y="",z="";if($(j).parents(".position-box[ele-type=group]").length>0){x.isGroupEle=!0;var A=$(j).parents(".position-box[ele-type=group]");y=A.eq(0).attr("id"),z=A.eq(A.length-1).attr("id")}var B=$(j).find("> .ele-box"),C=B.find("> .ele"),D=$(j).attr("ele-type");"image"!==D&&(l(),"group"!==k.eleType&&$(j).on("click",function(){var a=C.height()/2;C.css("margin-top",-a+"px")})),$(j).find(" >.resize").on("mousedown",function(a){a.stopPropagation(),g.$emit("eleDragStart"),i.add($(j),0,-38,"size"),x.isGroupEle&&$(j).trigger("groupUpdateInit",y),x.flag=!0,x.left=$(j).get(0).offsetLeft,x.top=$(j).get(0).offsetTop,x.cx=a.clientX,x.cy=a.clientY,x.eleWidth=B.get(0).clientWidth,x.eleHeight=parseInt(B.css("min-height")),x.clip=C.css("clip"),x.imageWidth=C.get(0).offsetWidth,x.imageHeight=C.get(0).offsetHeight,-1!==a.target.className.indexOf("left-top")&&(x.target=0),-1!==a.target.className.indexOf("only-top")&&(x.target=1),-1!==a.target.className.indexOf("right-top")&&(x.target=2),-1!==a.target.className.indexOf("only-right")&&(x.target=3),-1!==a.target.className.indexOf("right-bottom")&&(x.target=4),-1!==a.target.className.indexOf("only-bottom")&&(x.target=5),-1!==a.target.className.indexOf("left-bottom")&&(x.target=6),-1!==a.target.className.indexOf("only-left")&&(x.target=7),x.rotate=e.getRotate(j),x.physicsEle=e.getSizeAndPosition(x.left,x.top,x.eleWidth,x.eleHeight,x.rotate),x.rightRotate=parseInt(x.rotate/45+x.target)%8,"ele-web"==x.type&&(x.eleData=b.getEle(k.id,k.eleType)),"ele-phone"==x.type&&(x.eleData=c.getEle(k.id,k.eleType))});var E=!0;$(document).on("mousemove",v),$(document).on("mouseup",w),a.$on("$destroy",function(){$(document).off("mousemove",v),$(document).off("mouseup",w)})}}}]).factory("eleIndicator",["elePosition","rotateEleCalculate",function(a,b){var c=null,d=null,e='<div class="ele-indicator"></div>',f={left:0,top:0},g="size",h={add:function(a,b,i,j){void 0!==j&&(g=j),void 0!==b&&(f.left=b),void 0!==i&&(f.top=i),h.remove();var k=$(e);$("#main-editor-scroll").append(k),c=k,d=a,h.update()},remove:function(){null!==c&&(c.remove(),c=null,d=null)},update:function(){if(null!==c){switch(g){case"size":c.text("W:"+$(d).get(0).offsetWidth+" | H:"+$(d).get(0).offsetHeight);break;case"position":c.text("X:"+parseInt($(d).css("left"))+" | Y:"+parseInt($(d).css("top")));break;case"rotate":c.text(h.getDeg(d.css("transform"))+"deg")}var e={left:parseInt($(d).css("left")),top:parseInt($(d).css("top")),width:parseInt($(d).get(0).offsetWidth),height:parseInt($(d).get(0).offsetHeight)},i=b.getSizeAndPosition(e.left,e.top,e.width,e.height,b.getRotate(d)),j=i.left+(a.getLeft(d.get(0),$("#main-editor-scroll").get(0))-i.originalLeft),k=i.top+(a.getTop(d.get(0),$("#main-editor-scroll").get(0))-i.originalTop);c.css({left:j+f.left,top:k+f.top})}},getDeg:function(a){if("none"==a)return 0;var b=a.substring(7,a.length-1);b=b.split(","),angular.forEach(b,function(a,c){b[c]=parseFloat(a)});var c=h.getDegFormatrix(b[0],b[1],b[2],b[3],b[4],b[5]);return c},getDegFormatrix:function(a,b,c,d,e,f){var g=Math.round(180*Math.asin(a)/Math.PI),h=Math.round(180*Math.acos(b)/Math.PI),i=Math.round(180*Math.asin(c)/Math.PI),j=Math.round(180*Math.acos(d)/Math.PI),k=0;return g==h||-g==h?k=j:-g+h==180?k=180+i:g+h==180&&(k=360-i||360-j),k>=360?0:k}};return h}]).factory("autoAlignment",["$timeout",function(a){var b={flag:!1,eleList:[]},c=6,d={init:function(a,c){var d=a.find(">.ele-session >.position-box-parent >.position-box");return b.eleList=[],angular.forEach(d,function(a,d){var e={leftStart:parseInt($(a).css("left")),leftEnd:parseInt($(a).css("left"))+parseInt(a.offsetWidth),topStart:parseInt($(a).css("top")),topEnd:parseInt($(a).css("top"))+parseInt(a.offsetHeight)};$(c).attr("id")==$(a).attr("id")||b.eleList.push(e)}),d},getMinSubscript:function(a){var b=Math.abs(a[0]),c=0;return angular.forEach(a,function(a,d){Math.abs(a)<b&&(b=Math.abs(a),c=d)}),c},calculatePosition:function(a){var e=[null,null,null,null],f=[null,null,null,null];angular.forEach(b.eleList,function(b,c){0===c?(e=[b.leftStart-a.leftStart,b.leftStart-a.leftEnd,b.leftEnd-a.leftStart,b.leftEnd-a.leftEnd],f=[b.topStart-a.topStart,b.topStart-a.topEnd,b.topEnd-a.topStart,b.topEnd-a.topEnd]):(e[0]=Math.abs(b.leftStart-a.leftStart)<Math.abs(e[0])?b.leftStart-a.leftStart:e[0],e[1]=Math.abs(b.leftStart-a.leftEnd)<Math.abs(e[1])?b.leftStart-a.leftEnd:e[1],e[2]=Math.abs(b.leftEnd-a.leftStart)<Math.abs(e[2])?b.leftEnd-a.leftStart:e[2],e[3]=Math.abs(b.leftEnd-a.leftEnd)<Math.abs(e[3])?b.leftEnd-a.leftEnd:e[3],f[0]=Math.abs(b.topStart-a.topStart)<Math.abs(f[0])?b.topStart-a.topStart:f[0],f[1]=Math.abs(b.topStart-a.topEnd)<Math.abs(f[1])?b.topStart-a.topEnd:f[1],f[2]=Math.abs(b.topEnd-a.topStart)<Math.abs(f[2])?b.topEnd-a.topStart:f[2],f[3]=Math.abs(b.topEnd-a.topEnd)<Math.abs(f[3])?b.topEnd-a.topEnd:f[3])});var g=d.getMinSubscript(e),h=d.getMinSubscript(f),i={left:a.leftStart,top:a.topStart};return Math.abs(e[g])<c&&(i.left+=e[g]),Math.abs(f[h])<c&&(i.top+=f[h]),i},clean:function(){}};return d}]),angular.module("phoneSiteEditor",[]).factory("phoneBuilderTool",["phoneCreatorServices","$compile","$timeout","imageCropService",function(a,b,c,d){var e=null,f={init:function(a){e=a},addEle:function(c,d){var f=a.createEle(d);f=b(f.get(0))(e),d.showState===!1&&f.css("display","none"),$("#"+c+".ele-session-box").append(f)},hideEle:function(a,b){"session"===b&&$("#"+a+".ele-session-box").hide(),"ele"===b&&$("#"+a+".position-box").parent(".position-box-parent").hide()},showEle:function(a,b){"session"==b&&$("#"+a+".ele-session-box").show(),"ele"==b&&$("#"+a+".position-box").parent(".position-box-parent").show()},moveEle:function(a,b,c){var d=$("#"+a+".position-box");if("top"===b){var e=d.css("top");d.css("top",parseInt(e)+c)}if("left"===b){var f=d.css("left");d.css("left",parseInt(f)+c)}},changeSessionHeight:function(a,b){$("#"+a+".ele-session-box").css("min-height",b)},addSession:function(c){var d=a.createSession(c);d=b(d.get(0))(e);var f=$(".ele-session-box");f.length>c.deleteIndex?$(".ele-session-box").eq(c.deleteIndex).before(d):$(".ele-session-box").eq(f.length-1).after(d)},deleteSession:function(a){$("#"+a+".ele-session-box").remove(),$(".tooltip.tooltip--is-active").remove()},createID:function(){return _.uniqueId("ele"+_.now())},refreshPage:function(b,c){var d=$("#phone-edit-space");d.empty(),d.append(a.createPage(b.sessionList,c))},updateEle:function(a){switch($("#"+a.ID).parent().get(0).eleConfig=a,a.type){case"text":this.updateEleText(a);break;case"image":this.updateEleImage(a);break;case"menu":this.updateEleMenu(a);break;case"group":this.updateEleGroup(a)}},deleteEle:function(a){$("#"+a+".position-box").remove()},getEle:function(a,b){var c={};switch(b){case"text":c=this.getEleText(a);break;case"image":c=this.getEleImage(a);break;case"menu":c=this.getEleMenu(a);break;case"group":c=this.getEleGroup(a)}return c},resolveStyle:function(a){var b={};return angular.forEach(a.style,function(c,d){b[c]=$(a).css(c)}),b},getEleDefaultStyle:function(a,b){b.phoneStyle.position=this.resolveStyle(a[0]);var c=a.find(".ele-box");return b.phoneStyle.border=this.resolveStyle(c[0]),c=a.find(".ele"),b.phoneStyle.style=this.resolveStyle(c[0]),b},getEleText:function(a){var b={};b.phoneStyle={};var c=$("#"+a+".position-box");return b.ID=a,b.type="text",b.textValue=c.find(".ele").get(0).innerHTML,this.getEleDefaultStyle(c,b),b.phoneStyle.scale=c.attr("scale"),b},getEleImage:function(a){var b={};b.phoneStyle={};var c=$("#"+a+".position-box"),d=c.find(".ele");return b.ID=a,b.type="image",this.getEleDefaultStyle(c,b),b.url=d.attr("src"),b.backgroundSize=c.attr("background-size"),b.phoneStyle.scale=c.attr("scale"),b},getEleMenu:function(a){var b={};b.phoneStyle={};var c=$("#"+a+".position-box");b.ID=a,b.type="menu",this.getEleDefaultStyle(c,b),b.item=[];for(var d=c.find(".menu-item"),e=0;e<d.length;e++)b.item.push({ID:d.eq(e).attr("id"),name:d.get(e).textContent});return b.phoneStyle.scale=c.attr("scale"),b},getEleGroup:function(a){var b={};b.phoneStyle={};var c=$("#"+a+".position-box");b.ID=a,b.type="group",this.getEleDefaultStyle(c,b);for(var d=c.find(">.ele-box >.ele >.position-box-parent >.position-box"),e=[],f=0;f<d.length;f++)e.push(this.getEle(d.eq(f).attr("id"),d.eq(f).attr("ele-type")));return b.eleList=e,b.phoneStyle.scale=c.attr("scale"),b},updateEleDefaultStyle:function(a,b){$.each(b.phoneStyle.position,function(b,c){a.css(b,c)});var c=a.find(".ele-box");$.each(b.phoneStyle.border,function(a,b){c.css(a,b)});var d=a.find(".ele");$.each(b.phoneStyle.style,function(a,b){d.css(a,b)})},updateEleText:function(a){var b=$("#"+a.ID+".position-box");this.updateEleDefaultStyle(b,a)},updateEleImage:function(a){var b=$("#"+a.ID+".position-box");this.updateEleDefaultStyle(b,a)},updateEleMenu:function(a){var b=$("#"+a.ID+".position-box");this.updateEleDefaultStyle(b,a)},updateEleGroup:function(a){var b=$("#"+a.ID+".position-box");this.updateEleDefaultStyle(b,a);for(var c=0;c<a.eleList.length;c++)this.updateEle(a.eleList[c])},zoomEle:function(a,b){switch(a.type){case"text":f.zoomEleText(a,b);break;case"image":f.zoomEleImage(a,b);break;case"menu":f.zoomEleMenu(a,b);break;case"group":f.zoomEleGroup(a,b)}},zoomEleText:function(a,b){var c=0,d=0,e=0;d=parseInt(a.phoneStyle.position.top)*b,e=parseInt(a.phoneStyle.position.left)*b,c=parseInt(a.phoneStyle.border.width)*b;var f=$("#"+a.ID);f.css({left:e,top:d}),f.find(">.ele-box").css({width:c});var g=c*a.phoneStyle.scale,h=parseFloat(f.find(">.ele-box").get(0).offsetHeight)*a.phoneStyle.scale;f.css({width:g,height:h})},zoomEleImage:function(a,b){var c=0,e=0,f=0,g=0;f=parseInt(a.phoneStyle.position.top)*b,g=parseInt(a.phoneStyle.position.left)*b,c=parseInt(a.phoneStyle.border.width)*b,e=parseInt(a.phoneStyle.border["min-height"])*b;var h=$("#"+a.ID);h.css({left:g,top:f}),h.find(">.ele-box").css({width:c,"min-height":e}),d.resetImage(h,a,parseInt(a.phoneStyle.border.width),parseInt(a.phoneStyle.border["min-height"]),parseInt(a.phoneStyle.style.width),parseInt(a.phoneStyle.style.height),a.phoneStyle.style.clip)},zoomEleMenu:function(a,b){var c=0,d=0,e=0;d=parseInt(a.phoneStyle.position.top)*b,e=parseInt(a.phoneStyle.position.left)*b,c=parseInt(a.phoneStyle.border.width)*b;var f=$("#"+a.ID);f.css({left:e,top:d}),f.find(">.ele-box").css({
width:c})},zoomEleGroup:function(a,b){var c=0,d=0,e=parseInt(a.phoneStyle.border.width),g=parseInt(a.phoneStyle.border["min-height"]);c=e*b,d=g*b;var h=$("#"+a.ID);h.find(">.ele-box").css({width:c,"min-height":d}),angular.forEach(a.eleList,function(a,c){f.zoomEle(a,b)});for(var i=h.find(">.ele-box >.ele >.position-box-parent >.position-box"),j=d,k=0;k<i.length;k++){var l=i.eq(k).height()+parseInt(i.eq(k).css("top"));l>j&&(j=l)}h.find(">.ele-box").css({"min-height":j+6})}};return f}]),angular.module("sessionEditor",[]).factory("changeSessionTool",["builderTool","websiteData","activePageService",function(a,b,c){var d={};d.currentSession={},d.sessionHeight=[],d.eleCenterY=0;var e={init:function(a,b){d.eleCenterY=b,d.sessionHeight=[],d.currentSession.ID=a;for(var c=$("#edit-space .ele-session-box"),e=0;e<c.length;e++){var f={};f.ID=c.eq(e).attr("id"),f.height=c.get(e).offsetHeight,d.sessionHeight.push(f),f.ID===d.currentSession.ID&&(d.currentSession.index=e,d.currentSession.height=f.height)}},moveCheck:function(a){var b=[],c=0,e=0;if(a<-d.eleCenterY)for(b=[],c=0,e=d.currentSession.index-1;e>=0;e--)if(c+=d.sessionHeight[e].height,Math.abs(a)<c+d.eleCenterY){$(".ele-session-box .over-shadow").css("display","none"),d.changeSessionState=!0,d.targetSession=d.sessionHeight[e].ID,b=$(".ele-session-box[id!="+d.sessionHeight[e].ID+"] .over-shadow"),b.css("display","block");break}if(a>d.currentSession.height-d.eleCenterY)for(b=[],c=0,e=d.currentSession.index;e<d.sessionHeight.length;e++){if(void 0===d.sessionHeight[e+1])return;c+=d.sessionHeight[e].height,Math.abs(a)>c-d.eleCenterY&&($(".ele-session-box .over-shadow").css("display","none"),d.changeSessionState=!0,d.targetSession=d.sessionHeight[e+1].ID,b=$(".ele-session-box[id!="+d.targetSession+"] .over-shadow"),b.css("display","block"))}a>=-d.eleCenterY&&a<=d.currentSession.height-d.eleCenterY&&($(".ele-session-box .over-shadow").css("display","none"),d.changeSessionState=!1)},overCheck:function(e){$(".ele-session-box .over-shadow").css("display","none");var f=0;if(d.changeSessionState){for(f=0;f<e.length;f++)b.changeSession(d.currentSession.ID,d.targetSession,a.getEle(e[f].ID,e[f].type));return d.targetSession}for(f=0;f<e.length;f++){var g=a.getEle(e[f].ID,e[f].type);b.updateEle(c.getActivePage().value,g)}return!1}};return e}]).factory("changeSessionToolForMultiple",["builderTool","phoneBuilderTool","websiteData","activePageService",function(a,b,c,d){var e={};e.currentSession={},e.sessionHeight=[],e.eleCenterY=0;var f="",g={init:function(a,b,c){f=void 0===c?"web":c,e.eleCenterY=b,e.sessionHeight=[],e.currentSession.ID=a;for(var d=$("#edit-space .ele-session-box"),g=0;g<d.length;g++){var h={};h.ID=d.eq(g).attr("id"),h.height=d.get(g).offsetHeight,e.sessionHeight.push(h),h.ID===e.currentSession.ID&&(e.currentSession.index=g,e.currentSession.height=h.height)}},moveCheck:function(a){if("phone"!==f){var b=[],c=0,d=0;if(a<-e.eleCenterY)for(b=[],c=0,d=e.currentSession.index-1;d>=0;d--)if(c+=e.sessionHeight[d].height,Math.abs(a)<c+e.eleCenterY){$(".ele-session-box .over-shadow").css("display","none"),e.changeSessionState=!0,e.targetSession=e.sessionHeight[d].ID,b=$(".ele-session-box[id!="+e.sessionHeight[d].ID+"] .over-shadow"),b.css("display","block");break}if(a>e.currentSession.height-e.eleCenterY)for(b=[],c=0,d=e.currentSession.index;d<e.sessionHeight.length;d++){if(void 0===e.sessionHeight[d+1])return;c+=e.sessionHeight[d].height,Math.abs(a)>c-e.eleCenterY&&($(".ele-session-box .over-shadow").css("display","none"),e.changeSessionState=!0,e.targetSession=e.sessionHeight[d+1].ID,b=$(".ele-session-box[id!="+e.targetSession+"] .over-shadow"),b.css("display","block"))}a>=-e.eleCenterY&&a<=e.currentSession.height-e.eleCenterY&&($(".ele-session-box .over-shadow").css("display","none"),e.changeSessionState=!1)}},overCheck:function(g){$(".ele-session-box .over-shadow").css("display","none");var h=0;if(e.changeSessionState){for(h=0;h<g.length;h++)c.changeSession(e.currentSession.ID,e.targetSession,a.getEle(g[h].ID,g[h].type));return e.targetSession}for(h=0;h<g.length;h++){var i={};"phone"===f&&(i=b.getEle(g[h].ID,g[h].type),c.updatePhoneEle(d.getActivePage().value,i)),"web"===f&&(i=a.getEle(g[h].ID,g[h].type),c.updateEle(d.getActivePage().value,i))}return!1}};return g}]),angular.module("webSiteEditor",["creator","kyle.imageCrop"]).factory("builderTool",["creatorServices","$compile","$timeout","$rootScope","imageCropService",function(a,b,c,d,e){var f=null,g=["nw-resize","n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize","w-resize"],h={init:function(a){f=a},reviseRotateCss:function(a,b){var c=parseInt(a/45),d=$("#"+b+".position-box");d.find(" >.left-top").css("cursor",g[(0+c)%8]),d.find(" >.only-top").css("cursor",g[(1+c)%8]),d.find(" >.right-top").css("cursor",g[(2+c)%8]),d.find(" >.only-right").css("cursor",g[(3+c)%8]),d.find(" >.right-bottom").css("cursor",g[(4+c)%8]),d.find(" >.only-bottom").css("cursor",g[(5+c)%8]),d.find(" >.left-bottom").css("cursor",g[(6+c)%8]),d.find(" >.only-left").css("cursor",g[(7+c)%8])},changeSessionHeight:function(a,b){$("#"+a+".ele-session-box").css("min-height",b)},addSession:function(c,d,e){void 0===e&&(e={isShow:!0});var g=a.createSession(c);g=b(g.get(0))(f),e.isShow||g.height(0);var h=$(".edit-space .ele-session-box-container");return h.length>d?h.eq(d).before(g):h.eq(h.length-1).after(g),g},deleteSession:function(a){$("#"+a+".ele-session-box").parent(".ele-session-box-container").remove(),$(".tooltip.tooltip--is-active").remove()},createID:function(){return _.uniqueId("ele"+_.now())},groupEle:function(d,e){for(var g=0;g<d.eleList.length;g++)$("#"+d.eleList[g].ID+".position-box").remove();var h=a.createEle(d);h=b(h.get(0))(f),$("#"+e+".ele-session-box .ele-session").append(h),c(function(){h.find(">.position-box >.ele-box >.group-over").trigger("mousedown"),$(document).trigger("mouseup")})},changeEleId:function(a){return a.ID=h.createID(),"group"==a.type&&angular.forEach(a.eleList,function(b,c){h.changeEleId(a.eleList[c])}),a},changeSession:function(a,b,c){var d=$("#"+a+" #"+c.ID).detach();$("#"+b+" .ele-session").append(d);var e=0,f=parseInt(c.position.top),g=$("#"+a+".ele-session-box"),h=$("#"+b+".ele-session-box");0>f?(e=g.offset().top-h.offset().top,e+=f):e=f-(h.offset().top-g.offset().top),d.css("top",e+"px")},justChangeSession:function(a,b,c){var d=$("#"+a+" #"+c.ID).detach();$("#"+b+" .ele-session").append(d)},refreshPage:function(b,c){var d=$("#edit-space");d.empty(),d.append(a.createPage(b.sessionList,c))},updateEle:function(a){switch($("#"+a.ID).parent().get(0).eleConfig=a,a.type){case"text":this.updateEleText(a);break;case"image":this.updateEleImage(a);break;case"menu":this.updateEleMenu(a);break;case"group":this.updateEleGroup(a)}d.$emit("updateEle")},deleteEle:function(a){$("#"+a+".position-box").remove(),d.$emit("deleteEle")},addEle:function(c,d){var e=a.createEle(d);return e=b(e.get(0))(f),$("#"+c+".ele-session-box .ele-session").append(e),e},getEle:function(a,b){var c={};switch(b){case"text":c=this.getEleText(a);break;case"image":c=this.getEleImage(a);break;case"menu":c=this.getEleMenu(a);break;case"group":c=this.getEleGroup(a)}return c},resolveStyle:function(a){var b={};return angular.forEach(a.style,function(c,d){b[c]=$(a).css(c)}),b},getEleDefaultStyle:function(a,b){b.position=this.resolveStyle(a[0]);var c=a.find(".ele-box");return b.border=this.resolveStyle(c[0]),c=a.find(".ele"),b.style=this.resolveStyle(c[0]),b.eleTemplateType=a.parent().attr("template-type"),b},getEleText:function(a){var b={},c=$("#"+a+".position-box");return b.ID=a,b.type="text",b.textValue=c.find(".ele .ql-editor").get(0).innerHTML,this.getEleDefaultStyle(c,b),b},getEleImage:function(a){var b={},c=$("#"+a+".position-box"),d=c.find(".ele");b.backgroundSize=c.attr("background-size"),b.ID=a,b.type="image";this.getEleDefaultStyle(c,b);d=c.find(".ele"),b.url=d.attr("src");var e=document.createElement("img");return e.src=b.url,b},getEleMenu:function(a){var b={},c=$("#"+a+".position-box");b.ID=a,b.type="menu";this.getEleDefaultStyle(c,b);b.item=[];for(var d=c.find(".menu-item"),e=0;e<d.length;e++)b.item.push({ID:d.eq(e).attr("id"),name:d.get(e).textContent});return b},getEleGroup:function(a){var b={},c=$("#"+a+".position-box");b.ID=a,b.type="group";for(var d=(this.getEleDefaultStyle(c,b),c.find(">.ele-box >.ele >.position-box-parent >.position-box")),e=[],f=0;f<d.length;f++)e.push(this.getEle(d.eq(f).attr("id"),d.eq(f).attr("ele-type")));return b.eleList=e,b},updateEleDefaultStyle:function(a,b){a.get(0).style="",$.each(b.position,function(b,c){a.css(b,c)}),a=a.find(".ele-box"),a.get(0).style="",$.each(b.border,function(b,c){a.css(b,c)}),a=a.find(".ele");var c=a.css("margin-top");a.get(0).style="",a.css("margin-top",c),$.each(b.style,function(b,c){a.css(b,c)})},updateEleText:function(a){var b=$("#"+a.ID+".position-box");this.updateEleDefaultStyle(b,a),a.textValue!==b.find(".ql-editor").html()&&b.find(".ql-editor").html(a.textValue)},updateEleImage:function(a){var b=$("#"+a.ID+".position-box");this.updateEleDefaultStyle(b,a),b.find(".ele").attr("src",a.url)},updateEleMenu:function(a){var b=$("#"+a.ID+".position-box");this.updateEleDefaultStyle(b,a),b.empty();for(var c=0;c<a.item.length;c++){var d=$("<div class='menu-item' id="+a.item[c].ID+">"+a.item[c].name+"</div>");d.css({width:(100/a.item.length).toFixed(2)+"%","float":"left"}),b.append(d)}},updateEleGroup:function(a){var b=$("#"+a.ID+".position-box");this.updateEleDefaultStyle(b,a);for(var c=0;c<a.eleList.length;c++)this.updateEle(a.eleList[c])},fixVideoPosition:function(a,b,d){void 0===d&&(d={width:b.width(),height:b.height()});var e={width:a.width(),height:a.height()};({width:b.width(),height:b.height()});e.width>e.height?d.height<e.height?(b.css({height:e.height+6,left:"50%",width:"auto","margin-top":"0px",top:"0px"}),c(function(){b.css({"margin-left":-b.width()/2})})):(b.css({width:e.width+6,top:"50%",height:"auto","margin-left":"0px",left:"0px"}),c(function(){b.css({"margin-top":-b.height()/2})})):d.width<e.width?(b.css({width:e.width+6,top:"50%",height:"auto","margin-left":"0px",left:"0px"}),c(function(){b.css({"margin-top":-b.height()/2})})):(b.css({height:e.height+6,left:"50%",width:"auto","margin-top":"0px",top:"0px"}),c(function(){b.css({"margin-left":-b.width()/2})}))},createSessionVideo:function(a,b){a.css("background-color",""),a.css("background-image","");var c=a.find(".video-background"),d='<div class="video-background"><div class="over-layer" style="background-image:url(\'images/videoPattern/v-overlay-pat-2-icon.png\')"></div><video class="video" poster="'+b.previewImage+'" volume="0" src="'+b.url+'"></video></div>';return 0===c.length?(c=$(d),a.append(c)):(c.find("video").attr("src",b.url),c.find("video").attr("poster",b.previewImage)),c.find("video").on("loadeddata",function(){h.fixVideoPosition(a,c.find("video"))}),c},updateSession:function(a){function b(a,b){b.color&&a.css("background-color",""),a.find(".video-background").remove(),a.css("background-image","url("+b.url+")")}function c(a,b){h.createSessionVideo(a,b)}function d(a,b){}var e=$("#"+a.ID);if($.each(a.style,function(a,b){e.css(a,b)}),void 0!==a["class"])for(var f=0;f<a["class"].length;f++)e.addClass(a["class"][f]);switch(a.background.type){case"image":b(e,a.background);break;case"video":c(e,a.background);break;case"color":d(e,a.background)}},zoomEle:function(a,b){switch(a.type){case"text":h.zoomEleText(a,b);break;case"image":h.zoomEleImage(a,b);break;case"menu":h.zoomEleMenu(a,b);break;case"group":h.zoomEleGroup(a,b)}},zoomEleText:function(a,b){var c=0,d=0,e=0;d=parseInt(a.position.top)*b,e=parseInt(a.position.left)*b,c=parseInt(a.border.width)*b;var f=$("#"+a.ID);f.css({left:e,top:d}),f.find(">.ele-box").css({width:c})},zoomEleImage:function(a,b){var c=0,d=0,f=0,g=0;f=parseInt(a.position.top)*b,g=parseInt(a.position.left)*b,c=parseInt(a.border.width)*b,d=parseInt(a.border["min-height"])*b;var h=$("#"+a.ID);h.css({left:g,top:f}),h.find(">.ele-box").css({width:c,"min-height":d}),e.resetImage(h,a,parseInt(a.border.width),parseInt(a.border["min-height"]),parseInt(a.style.width),parseInt(a.style.height),a.style.clip)},zoomEleMenu:function(a,b){var c=0,d=0,e=0;d=parseInt(a.position.top)*b,e=parseInt(a.position.left)*b,c=parseInt(a.border.width)*b;var f=$("#"+a.ID);f.css({left:e,top:d}),f.find(">.ele-box").css({width:c})},zoomEleGroup:function(a,b){var c=0,d=0,e=parseInt(a.border.width),f=parseInt(a.border["min-height"]);c=e*b,d=f*b;var g=$("#"+a.ID);g.find(">.ele-box").css({width:c,"min-height":d}),angular.forEach(a.eleList,function(a,c){h.zoomEle(a,b)});for(var i=g.find(">.ele-box >.ele >.position-box-parent >.position-box"),j=d,k=0;k<i.length;k++){var l=i.eq(k).height()+parseInt(i.eq(k).css("top"));l>j&&(j=l)}g.find(">.ele-box").css({"min-height":j+6})}};return h}]),angular.module("historyLog",[]).factory("historyLog",function(){var a=[],b=[],c={forwardPush:function(b,c,d){void 0===c&&(c="default"),void 0===d&&(d="default");var e={value:b,type:c,sessionId:d};a.push(e),a.length>=50&&a.splice(0,1)},pushHistoryLog:function(a,b,c){"retreat"!==b&&"forward"!==b&&(this.retreatPush(a,c),this.clearForward()),"retreat"===b&&this.forwardPush(a,c),"forward"===b&&this.retreatPush(a,c)},forwardPop:function(){var b=a.pop();return b},retreatPush:function(a,c,d){void 0===c&&(c="default"),void 0===d&&(d="default");var e={value:a,type:c,sessionId:d};b.push(e),b.length>=50&&b.splice(0,1)},retreatPop:function(){var a=b.pop();return a},clearForward:function(){a=[]},clearAll:function(){a=[],b=[]}};return c}).factory("phoneHistoryLog",function(){var a=[],b=[],c={forwardPush:function(b,c,d){void 0===c&&(c="default"),void 0===d&&(d="default");var e={value:b,type:c,sessionId:d};a.push(e),a.length>=50&&a.splice(0,1)},pushHistoryLog:function(a,b,c){"retreat"!==b&&"forward"!==b&&(this.retreatPush(a,c),this.clearForward()),"retreat"===b&&this.forwardPush(a,c),"forward"===b&&this.retreatPush(a,c)},forwardPop:function(){var b=a.pop();return b},retreatPush:function(a,c,d){void 0===c&&(c="default"),void 0===d&&(d="default");var e={value:a,type:c,sessionId:d};b.push(e),b.length>=50&&b.splice(0,1)},retreatPop:function(){var a=b.pop();return a},clearForward:function(){a=[]},clearAll:function(){a=[],b=[]}};return c}),angular.module("dataService",["historyLog","webSiteEditor","phoneSiteEditor"]).factory("websiteData",["historyLog","phoneHistoryLog","phoneBuilderTool","builderTool","$http","$q","$timeout","activePageService","imageCropService",function(a,b,c,d,e,f,g,h,i){var j=[],k={},l={},m={initScope:function(a){l=a},getSession:function(a){var b=this.searchSessionHandle(h.getActivePage().value),c=null;return angular.forEach(b,function(b,d){b.ID==a&&(c=angular.copy(b))}),c},hideSession:function(a,d){void 0===d&&(d="default");for(var e=this.searchSessionHandle(h.getActivePage().value),f=0;f<e.length;f++)if(e[f].ID===a){e[f].showState=!1;var g={sessionID:a};b.pushHistoryLog(g,d,"hideSession"),c.hideEle(a,"session")}},hideEleSearchGroup:function(a,b){for(var c=0;c<a.eleList.length;c++){if(a.eleList[c].ID===b)return a.eleList.splice(c,1)[0];if("group"===a.eleList[c].type)return this.hideEleSearchGroup(a.eleList[c],b)}},hideEle:function(a,d){void 0===d&&(d="default");for(var e=$("#"+a+".position-box").parents(".ele-session-box").attr("id"),f=this.searchEleHandle(h.getActivePage().value,e),g=0;g<f.length;g++){var i={};if(a===f[g].ID){f[g].showState=!1,i={sessionID:e,ID:a},b.pushHistoryLog(i,d,"hideEle"),c.hideEle(a,"ele");break}if("group"===f[g].type){var j=this.hideEleSearchGroup(f[g],a);if(j){j.showState=!1,f.push(j),i={sessionID:e,ID:a},b.pushHistoryLog(i,d,"hideEle"),c.deleteEle(a),c.addEle(e,j);break}}}},showSession:function(a,d){void 0===d&&(d="default");for(var e=this.searchSessionHandle(h.getActivePage().value),f=0;f<e.length;f++)if(e[f].ID===a){e[f].showState=!0;var g={sessionID:a};b.pushHistoryLog(g,d,"showSession"),c.showEle(a,"session")}},showEle:function(a,d){void 0===d&&(d="default");for(var e=$("#"+a+".position-box").parents(".ele-session-box").attr("id"),f=this.searchEleHandle(h.getActivePage().value,e),g=0;g<f.length;g++)if(a===f[g].ID){f[g].showState=!0;var i={sessionID:e,ID:a};b.pushHistoryLog(i,d,"showEle"),c.showEle(a,"ele")}},changeSessionHeight:function(b,c,e){void 0===e&&(e="default");for(var f=this.searchSessionHandle(h.getActivePage().value),g=0;g<f.length;g++)if(b===f[g].ID){var i={sessionID:b,height:f[g].style["min-height"]};("retreat"===e||"forward"===e)&&d.changeSessionHeight(b,c),a.pushHistoryLog(i,e,"changeSessionHeight"),f[g].style["min-height"]=c;break}},changePhoneSessionHeight:function(a,c,e){void 0===e&&(e="default");for(var f=this.searchSessionHandle(h.getActivePage().value),g=0;g<f.length;g++)if(a===f[g].ID){var i={sessionID:a,height:f[g].phoneStyle["min-height"]};("retreat"===e||"forward"===e)&&d.changeSessionHeight(a,c),b.pushHistoryLog(i,e,"changeSessionHeight"),f[g].phoneStyle["min-height"]=c;break}},getSessionMinHeight:function(a){for(var b=this.searchSessionHandle(h.getActivePage().value),c=0,d=0;d<b.length;d++)if(a===b[d].ID){for(var e=0;e<b[d].eleList.length;e++)0!==e?c<parseInt(b[d].eleList[e].border["min-height"])+parseInt(b[d].eleList[e].position.top)&&(c=parseInt(b[d].eleList[e].border["min-height"])+parseInt(b[d].eleList[e].position.top)):c=parseInt(b[d].eleList[e].border["min-height"])+parseInt(b[d].eleList[e].position.top);return c}},addSession:function(b,c,e,f){void 0===f&&(f="default"),b.ID=d.createID();var g=this.searchSessionHandle(h.getActivePage().value),i=0;angular.forEach(g,function(a,b){a.ID==c&&(i=b)}),g.length>i+1?g.splice(i+1,0,b):g.push(b);var j=d.addSession(b,i+1,e);return a.pushHistoryLog(b,f,"addSession"),j},reductionSession:function(b,c){void 0===c&&(c="default");var e=this.searchSessionHandle(h.getActivePage().value);b.ID=d.createID(),e.length>b.deleteIndex?e.splice(b.deleteIndex,0,b):e.push(b),d.addSession(b,b.deleteIndex),a.pushHistoryLog(b,c,"addSession")},deleteSession:function(b,c){void 0===c&&(c="default");for(var e=this.searchSessionHandle(h.getActivePage().value),f=0;f<e.length;f++)if(e[f].ID===b){var g=e.splice(f,1)[0];return g.deleteIndex=f,d.deleteSession(b),void a.pushHistoryLog(g,c,"deleteSession")}},searchSessionHandle:function(a){for(var b=0;b<j.length;b++)if(j[b].ID===a)return j[b].sessionList},searchEleHandle:function(a,b){for(var c=0;c<j.length;c++)if(j[c].ID===a)for(var d=0;d<j[c].sessionList.length;d++)if(b===j[c].sessionList[d].ID)return j[c].sessionList[d].eleList},changeSession:function(b,c,e,f){var g={},i=0,k=0,l=0;for(i=0;i<j.length;i++)if(j[i].ID===h.getActivePage().value){for(k=0;k<j[i].sessionList.length;k++)if(j[i].sessionList[k].ID===b){for(l=0;l<j[i].sessionList[k].eleList.length;l++)if(j[i].sessionList[k].eleList[l].ID===e.ID){g=j[i].sessionList[k].eleList.splice(l,1)[0],"retreat"===f||"forward"===f?(d.updateEle(e),d.justChangeSession(b,c,e)):d.changeSession(b,c,e),g.changeSession={startSession:b,endSession:c},a.pushHistoryLog(g,f,"changeSession");break}break}break}for(i=0;i<j.length;i++)if(j[i].ID===h.getActivePage().value)for(k=0;k<j[i].sessionList.length;k++)if(j[i].sessionList[k].ID===c){var m=d.getEle(e.ID,e.type);if(m.phoneStyle=g.phoneStyle,m.phoneStyle.position.top=m.position.top,m.phoneStyle.position.left=m.position.left,"group"===g.type)for(l=0;l<g.eleList.length;l++)m.eleList[l].phoneStyle=g.eleList[l].phoneStyle,m.eleList[l].phoneStyle.position.top=m.eleList[l].position.top,m.eleList[l].phoneStyle.position.left=m.eleList[l].position.left;return this.calculateForPhone(m),j[i].sessionList[k].eleList.push(m),void d.changeSession(b,c,e)}},calculateForUnGroup:function(a,b){for(var c=0;c<a.length;c++)a[c].phoneStyle.scale=b},calculateForGroup:function(a){function b(a){for(var b=0,d=0,f=(a.phoneStyle.scale,0);f<a.eleList.length;f++){if(a.eleList[f].phoneStyle.scale=1,e=parseInt(a.eleList[f].phoneStyle.border.width),e>c&&(a.eleList[f].phoneStyle.scale=(c-20)/e,"image"==a.eleList[f].type)){a.eleList[f].phoneStyle.border.width=parseInt(a.eleList[f].phoneStyle.border.width)*a.eleList[f].phoneStyle.scale,a.eleList[f].phoneStyle.border["min-height"]=parseInt(a.eleList[f].phoneStyle.border["min-height"])*a.eleList[f].phoneStyle.scale,a.eleList[f].phoneStyle.style.width=parseInt(a.eleList[f].phoneStyle.style.width)*a.eleList[f].phoneStyle.scale,a.eleList[f].phoneStyle.style.height=parseInt(a.eleList[f].phoneStyle.style.height)*a.eleList[f].phoneStyle.scale;var g=i.parsingClip(a.eleList[f].phoneStyle.style.clip,a.eleList[f].phoneStyle.style.width,a.eleList[f].phoneStyle.style.height);g[0]=g[0]*a.eleList[f].phoneStyle.scale,g[1]=g[1]*a.eleList[f].phoneStyle.scale,g[2]=g[2]*a.eleList[f].phoneStyle.scale,g[3]=g[3]*a.eleList[f].phoneStyle.scale,a.eleList[f].phoneStyle.style.clip="rect("+g[0]+"px "+g[1]+"px "+g[2]+"px "+g[3]+"px )"}0===f&&(d=e*a.eleList[f].phoneStyle.scale),e*a.eleList[f].phoneStyle.scale>d&&(d=e*a.eleList[f].phoneStyle.scale),a.eleList[f].phoneStyle.position.top=b,a.eleList[f].phoneStyle.position.left=0,b+="group"===a.eleList[f].type?parseInt(a.eleList[f].phoneStyle.border["min-height"]):parseInt(a.eleList[f].phoneStyle.border["min-height"])*a.eleList[f].phoneStyle.scale}a.phoneStyle.border.width=d,a.phoneStyle.border["min-height"]=b,a.phoneStyle.position.left=(c-d)/2}for(var c=280,d=0;d<a.eleList.length;d++)a.eleList[d].phoneStyle.border.width=a.eleList[d].border.width,a.eleList[d].phoneStyle.border["min-height"]=a.eleList[d].border["min-height"],"image"==a.eleList[d].type&&(a.eleList[d].phoneStyle.style.width=a.eleList[d].style.width,a.eleList[d].phoneStyle.style.height=a.eleList[d].style.height);var e=(parseInt(a.phoneStyle.position.left),parseInt(a.phoneStyle.border.width));e*a.phoneStyle.scale<280?this.calculateForPhone(a):b(a)},calculateForPhone:function(a){function b(a){var b=(parseInt(a.phoneStyle.position.left),parseInt(a.phoneStyle.border.width));c>b?a.phoneStyle.position.left=(c-b*a.phoneStyle.scale)/2:(a.phoneStyle.position.left=10,a.phoneStyle.scale=(c-20)/b,"image"===a.type&&(a.phoneStyle.border.width*=a.phoneStyle.scale,a.phoneStyle.border["min-height"]*=a.phoneStyle.scale))}var c=280;b(a)},groupEle:function(b,c,e){void 0===c&&(c="default");var f=[],g={};g.minTop=0,g.maxTop=0,g.maxLeft=0,g.maxLeft=0,g.phoneMinTop=0,g.phoneMaxTop=0,g.phoneMinLeft=0,g.phoneMaxLeft=0;for(var k=$("#"+b[0].ID+".position-box").parents(".ele-session-box").attr("id"),l=0;l<j.length;l++)if(j[l].ID===h.getActivePage().value)for(var m=0;m<j[l].sessionList.length;m++)if(j[l].sessionList[m].ID===k){for(var n=0;n<b.length;n++){0===n&&(g.minTop=b[n].position.top,g.maxTop=b[n].position.top+b[n].size.height,g.minLeft=b[n].position.left,g.maxLeft=b[n].position.left+b[n].size.width),b[n].position.top<g.minTop&&(g.minTop=b[n].position.top),b[n].position.top+b[n].size.height>g.maxTop&&(g.maxTop=b[n].position.top+b[n].size.height),b[n].position.left<g.minLeft&&(g.minLeft=b[n].position.left),b[n].position.left+b[n].size.width>g.maxLeft&&(g.maxLeft=b[n].position.left+b[n].size.width);for(var o=0;o<j[l].sessionList[m].eleList.length;o++)if(b[n].ID===j[l].sessionList[m].eleList[o].ID){var p=angular.copy(j[l].sessionList[m].eleList[o]);if("image"==p.type){p.phoneStyle.style.width=parseInt(p.phoneStyle.style.width)/p.phoneStyle.scale,p.phoneStyle.style.height=parseInt(p.phoneStyle.style.height)/p.phoneStyle.scale;var q=i.parsingClip(p.phoneStyle.style.clip,p.phoneStyle.style.width,p.phoneStyle.style.height);q[0]=q[0]/p.phoneStyle.scale,q[1]=q[1]/p.phoneStyle.scale,q[2]=q[2]/p.phoneStyle.scale,q[3]=q[3]/p.phoneStyle.scale,p.phoneStyle.style.clip="rect("+q[0]+"px "+q[1]+"px "+q[2]+"px "+q[3]+"px )"}f.push(p);var r=j[l].sessionList[m].eleList[o],s=parseInt(r.phoneStyle.position.left),t=parseInt(r.phoneStyle.position.top),u=parseInt(r.phoneStyle.border.width),v=parseInt(r.phoneStyle.border["min-height"]);0===n&&(g.phoneMinTop=t,g.phoneMaxTop=t+v,g.phoneMinLeft=s,g.phoneMaxLeft=s+u),t<g.phoneMinTop&&(g.phoneMinTop=t),t+v>g.phoneMaxTop&&(g.phoneMaxTop=t+v),s<g.phoneMinLeft&&(g.phoneMinLeft=s),s+u>g.phoneMaxLeft&&(g.phoneMaxLeft=s+u),j[l].sessionList[m].eleList.splice(o,1);break}if(n+1>=b.length){for(var w=0;w<f.length;w++)f[w].position.left=parseInt(f[w].position.left)-g.minLeft+"px",f[w].position.top=parseInt(f[w].position.top)-g.minTop+"px",f[w].phoneStyle.position.left=f[w].position.left,f[w].phoneStyle.position.top=f[w].position.top;var x={ID:void 0!==e?e:d.createID(),type:"group",style:{},position:{left:g.minLeft+"px",top:g.minTop+"px"},border:{width:g.maxLeft-g.minLeft+"px","min-height":g.maxTop-g.minTop+"px"},eleList:f,eleTemplateType:"ele-group-default",phoneStyle:{style:{},position:{left:g.phoneMinLeft+"px",top:g.phoneMinTop+"px"},border:{width:g.maxLeft-g.minLeft+"px","min-height":g.maxTop-g.minTop+"px"},scale:.7}};this.calculateForGroup(x),j[l].sessionList[m].eleList.push(x),d.groupEle(x,k),a.pushHistoryLog(x,c,"group")}}return}},unGroupEle:function(b,c){void 0===c&&(c="default");for(var e=$("#"+b.ID+".position-box").parents(".ele-session-box").attr("id"),f=0;f<j.length;f++)if(j[f].ID===h.getActivePage().value)for(var g=0;g<j[f].sessionList.length;g++)if(j[f].sessionList[g].ID===e)for(var i=0;i<j[f].sessionList[g].eleList.length;i++)if(b.ID===j[f].sessionList[g].eleList[i].ID){var k=jQuery.extend(!0,[],j[f].sessionList[g].eleList[i].eleList),l=j[f].sessionList[g].eleList[i].phoneStyle.scale;j[f].sessionList[g].eleList.splice(i,1),d.deleteEle(b.ID),this.calculateForUnGroup(k,l);for(var m=parseInt(b.position.left),n=parseInt(b.position.top),o=[],p=0;p<k.length;p++){k[p].position.top=parseInt(k[p].position.top)+n,k[p].position.left=parseInt(k[p].position.left)+m,j[f].sessionList[g].eleList.push(k[p]),d.addEle(e,k[p]);var q={ID:k[p].ID,position:{left:parseInt(k[p].position.left),top:parseInt(k[p].position.top)},size:{width:parseInt(k[p].border.width),height:parseInt(k[p].border["min-height"])}};o.push(q)}var r={eleList:o,oldID:b.ID};a.pushHistoryLog(r,c,"unGroup")}},getFullDataForCache:function(){return k},getWebsiteData:function(){var a=f.defer();return e.get("data/data.json").success(function(b){for(var c=b.pageList,d=0;d<c.length;d++)for(var e=0;e<c[d].sessionList.length;e++)if("true"===c[d].sessionList[e].isPointer){for(var f=jQuery.extend(!0,[],c[d].sessionList[e].target),g=b,h=0;h<f.length;h++)g=g[f[d]];c[d].sessionList[e]=g;break}k=b,j=k.pageList,a.resolve(j)}),a.promise},addEle:function(b,c,e,f,g){""===f&&(f=l),void 0===g&&(g="default");for(var h=0;h<j.length;h++)if(j[h].ID===b)for(var i=0;i<j[h].sessionList.length;i++)if(j[h].sessionList[i].ID===c){j[h].sessionList[i].eleList.push(e);var k=d.addEle(c,e,f);return a.pushHistoryLog(e,g,"add"),k}},getEleForGroup:function(a,b){if(a.ID===b)return a;for(var c=0;c<a.eleList.length;c++){if(a.eleList[c].ID===b)return a.eleList[c];if("group"===a.eleList[c].type){var d=this.getEleForGroup(a.eleList[c],b);if(null!==d)return d}}return void 0===a.eleList?null:void 0},updateImageUrl:function(a,b,c){var e=m.getEle(a,b.ID);m.changeImageUrl(e,b.type,c.url).then(function(b){m.updateEle(a,b,"default"),d.updateEle(b)})},changeImageUrl:function(a,b,c){function d(a,b){a.url=b;var c=new Image;c.src=b,c.onload=function(){a.style.width=c.width+"px",a.style.height=c.height+"px",a.style.clip="rect(0px "+c.width+"px "+c.height+"px 0px)",a.border.width=c.width+"px",a.border["min-height"]=c.height+"px",a.imageSize.width=c.width+"px",a.imageSize.height=c.height+"px";var b=c.height*a.phoneStyle.scale,d=c.width*a.phoneStyle.scale;a.phoneStyle.style.width=d+"px",a.phoneStyle.style.height=b+"px",a.phoneStyle.style.clip="rect(0px "+d+"px "+b+"px 0px)",a.phoneStyle.border.width=d+"px",a.phoneStyle.border["min-height"]=b+"px",e.resolve(a)}}var e=f.defer();switch(b){case"image":d(a,c)}return e.promise},getEle:function(a,b){for(var c=0;c<j.length;c++)if(j[c].ID==a)for(var d=0;d<j[c].sessionList.length;d++){if(j[c].sessionList[d].ID==b)return j[c].sessionList[d];for(var e=0;e<j[c].sessionList[d].eleList.length;e++){if(j[c].sessionList[d].eleList[e].ID==b)return j[c].sessionList[d].eleList[e];if("group"==j[c].sessionList[d].eleList[e].type){var f=this.getEleForGroup(j[c].sessionList[d].eleList[e],b);if(f)return f}}}},deleteEle:function(b,c,e){for(var f=0;f<j.length;f++)if(j[f].ID===b)for(var g=0;g<j[f].sessionList.length;g++)for(var h=0;h<j[f].sessionList[g].eleList.length;h++){if(j[f].sessionList[g].eleList[h].ID===c){var i=jQuery.extend(!0,{},j[f].sessionList[g].eleList[h]);i.sessionId=j[f].sessionList[g].ID,a.pushHistoryLog(i,e,"delete");var k=j[f].sessionList[g].eleList.splice(h,1);return d.deleteEle(c),k}if("group"==j[f].sessionList[g].eleList[h].type){var k=m.deleteEleForGroup(j[f].sessionList[g].eleList[h],c);if(k)return a.pushHistoryLog(angular.copy(k),e,"delete"),d.deleteEle(k.ID),k}}},deleteEleForGroup:function(a,b){for(var c=0;c<a.eleList.length;c++){var d=a.eleList[c];if(d.ID==b)return a.eleList.splice(c,1)[0];if("group"==d.type)return m.deleteEleForGroup(d)}},updateEle:function(b,c,d){void 0===d&&(d="default");for(var e=0;e<j.length;e++)if(b===j[e].ID)for(var f=0;f<j[e].sessionList.length;f++)for(var g=0;g<j[e].sessionList[f].eleList.length;g++){var h=m.depthSearchEleGroup(j[e].sessionList[f].eleList[g],c);if(void 0!==h&&null!==h&&_.isEqual(c,h)!==!0)return a.pushHistoryLog(jQuery.extend(!0,{},h),d,"updateEle"),c=this.retainPhoneStyle(j[e].sessionList[f].eleList[g],c),c=this.saveOtherInfo(h,c,c.type),void m.coverData(h,c)}},depthSearchEleGroup:function(a,b){if(a.ID===b.ID)return a;if("group"==a.type)for(var c=null,d=0;d<a.eleList.length;d++)if(c=m.depthSearchEleGroup(a.eleList[d],b),void 0!==c&&null!==c)return c},coverUpdateEle:function(b,c,d){void 0===d&&(d="default");for(var e=0;e<j.length;e++)if(b===j[e].ID)for(var f=0;f<j[e].sessionList.length;f++)for(var g=0;g<j[e].sessionList[f].eleList.length;g++){var h=m.depthSearchEleGroup(j[e].sessionList[f].eleList[g],c);if(void 0!==h&&null!==h&&_.isEqual(c,h)!==!0)return a.pushHistoryLog(jQuery.extend(!0,{},h),d,"updateEle"),c=this.saveOtherInfo(h,c,c.type),void m.coverData(h,c)}},updatePhoneEle:function(a,c,d){void 0===d&&(d="default");for(var e=0;e<j.length;e++)if(a===j[e].ID)for(var f=0;f<j[e].sessionList.length;f++)for(var g=0;g<j[e].sessionList[f].eleList.length;g++)if(j[e].sessionList[f].eleList[g].ID===c.ID)return void(_.isEqual(c,j[e].sessionList[f].eleList[g])!==!0&&(b.pushHistoryLog(angular.copy(j[e].sessionList[f].eleList[g]),d,"updatePhoneEle"),j[e].sessionList[f].eleList[g]=this.savePhoneStyle(angular.copy(j[e].sessionList[f].eleList[g]),c)))},parsingClip:function(a,b,c){if("auto"==a)return a=[0,b,c,0];a=a.substring(5,a.length-1),a=a.split(" ");for(var d=0;d<a.length;d++)a[d]=parseInt(a[d]);return a},conversionScaleForPhone:function(a){function b(a){a.phoneStyle.border.width=a.border.width*a.phoneStyle.scale,a.phoneStyle.border["min-height"]=a.border["min-height"]*a.phoneStyle.scale,"auto"==a.style.width||void 0===a.style.width?a.phoneStyle.style.width="auto":a.phoneStyle.style.width=a.style.width*a.phoneStyle.scale,"auto"==a.style.height||void 0===a.style.width?a.phoneStyle.style.height="auto":a.phoneStyle.style.height=a.style.height*a.phoneStyle.scale,"auto"==a.style.left||void 0===a.style.width?a.phoneStyle.style.left="auto":a.phoneStyle.style.left=a.style.left*a.phoneStyle.scale,"auto"==a.style.top||void 0===a.style.width?a.phoneStyle.style.top="auto":a.phoneStyle.style.top=a.style.top*a.phoneStyle.scale,void 0===a.style.clip&&(a.style.clip="auto");var b=m.parsingClip(a.style.clip,a.style.width,a.style.height);return angular.forEach(b,function(c,d){b[d]=c*a.phoneStyle.scale}),a.phoneStyle.style.clip="rect("+b[0]+"px "+b[1]+"px "+b[2]+"px "+b[3]+"px )",a}var c=null;switch(a.type){case"image":c=b(a)}return c},saveOtherInfo:function(a,b,c){function d(a,b){return b.imageSize=a.imageSize,b.backgroundSize=a.backgroundSize,b}function e(a,b){return b}function f(a,b){return b}function g(a,b){return angular.forEach(a.eleList,function(a,c){angular.forEach(b.eleList,function(b,c){a.ID==b.ID&&m.saveOtherInfo(a,b,a.type)})}),b}var h=b;switch(void 0!==a.showState&&(h.showState=a.showState),
c){case"image":h=d(a,b);break;case"text":h=e(a,b);break;case"menu":h=f(a,b);break;case"group":h=g(a,b)}return h.eleTemplateType=a.eleTemplateType,h},savePhoneStyle:function(a,b){function c(a,b){a.phoneStyle.style.left=b.phoneStyle.style.left,a.phoneStyle.style.top=b.phoneStyle.style.top,a.phoneStyle.style.width=b.phoneStyle.style.width,a.phoneStyle.style.height=b.phoneStyle.style.height,a.phoneStyle.style.clip=b.phoneStyle.style.clip}function d(a,b){for(var c=0;c<b.eleList.length;c++)m.savePhoneStyle(a.eleList[c],b.eleList[c])}switch(a.phoneStyle.position.left=b.phoneStyle.position.left,a.phoneStyle.position.top=b.phoneStyle.position.top,a.phoneStyle.border.width=b.phoneStyle.border.width,a.phoneStyle.border["min-height"]=b.phoneStyle.border["min-height"],a.phoneStyle.scale=b.phoneStyle.scale,void 0!==b.phoneStyle.position.transform&&(a.phoneStyle.position.transform=b.phoneStyle.position.transform),b.type){case"image":c(a,b);break;case"group":d(a,b)}return a},retainPhoneStyle:function(a,b){if("group"===b.type){b.phoneStyle=angular.copy(a.phoneStyle);for(var c=0;c<b.eleList.length;c++)b.eleList[c]=this.retainPhoneStyle(a.eleList[c],b.eleList[c])}else b.phoneStyle=angular.copy(a.phoneStyle);return b},coverData:function(a,b){angular.forEach(b,function(b,c){a[c]=b})},updateSession:function(b,c){void 0===c&&(c="default");for(var e=this.searchSessionHandle(h.getActivePage().value),f=0;f<e.length;f++)if(e[f].ID==b.ID)return a.pushHistoryLog(angular.copy(e[f]),c,"updateSession"),m.coverData(e[f],b),void d.updateSession(e[f])},updateSessionBackground:function(a,b){function c(a){f.background.url=a.url,f.background.previewImage=a.image,f.background.type="video",f.background.color="",f.style["background-color"]="",f.style["background-image"]=""}function d(a,b){b.background.url=a.image,b.background.type="image",b.background.color="",b.style["background-color"]=""}function e(a){}var f=m.getSession(b);switch(a.type){case"image":d(a,f);break;case"video":c(a,f);break;case"color":e(a,f)}m.updateSession(f,"default")},getPage:function(a){for(var b=0;b<j.length;b++)if(j[b].ID===a)return j[b]}};return m}]),angular.module("creator",[]).directive("creator",["creatorServices","builderTool","websiteData","historyLog","textEditorService","colorPickService","shearPlate","multipleChoiceService","activeEleService","activeSessionService","rightClickMenuService","eleSettingService","sessionSettingService","shortcuts","activePageService","eleMenuServices","imageLibraryService","imageCropService",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){return{restrict:"A",scope:{websiteCode:"="},link:function(s,t){function u(a){function e(a,d){d.stopPropagation(),d.preventDefault();var e=0,f="left";switch(a){case"right":e=1,f="left";break;case"left":e=-1,f="left";break;case"top":e=-1,f="top";break;case"bottom":e=1,f="top"}var g=h.getEleList(),i={};if(g.value.length>0)for(var j=0;j<g.value.length;j++)g.value[j].state&&(i=b.getEle(g.value[j].ID,g.value[j].type),i.position[f]=parseInt(i.position[f])+e+"px",b.updateEle(i),c.updateEle(s.websiteCode.ID,i));else null!==s.activeEle&&(i=b.getEle(s.activeEle.ID,s.activeEle.type),i.position[f]=parseInt(i.position[f])+e+"px",b.updateEle(i),c.updateEle(s.websiteCode.ID,i))}function f(a){if(!($(":focus").length>0)){var b=h.getEleList();if(b.value.length>0){for(var d=[],e=0;e<b.value.length;e++)b.value[e].state&&d.push(c.getEle(s.websiteCode.ID,b.value[e].ID));g.setData(a,s.websiteCode.ID,d)}else null!==s.activeEle&&g.setData(a,s.websiteCode.ID,c.getEle(s.websiteCode.ID,s.activeEle.ID))}}function j(a,d){if(!($(":focus").length>0))if(d.value.length>0){for(var e=[],f=0;f<d.value.length;f++){d.value[f].position.top=parseInt(d.value[f].position.top)+20+"px",d.value[f].position.left=parseInt(d.value[f].position.left)+20+"px","cut"===a&&c.deleteEle(s.websiteCode.ID,d.value[f].ID),d.value[f]=b.changeEleId(d.value[f]),c.addEle(s.websiteCode.ID,w,d.value[f],s);var g=$("#"+d.value[f].ID+".position-box"),j={};j.x=g.offset().left+g.width()/2,j.y=g.offset().top+g.height()/2;var k={};k.left=parseInt(g.css("left")),k.top=parseInt(g.css("top")),e.push({ID:d.value[f].ID,center:j,position:k,type:d.value[f].type,state:!0})}h.setEleList(e)}else d.value.position.top=parseInt(d.value.position.top)+20+"px",d.value.position.left=parseInt(d.value.position.left)+20+"px","cut"===a&&c.deleteEle(s.websiteCode.ID,d.value.ID),d.value=b.changeEleId(d.value),c.addEle(s.websiteCode.ID,w,d.value,s),s.activeEle=d.value,i.setEle(jQuery.extend(!0,{},s.activeEle))}if(a[v.UNDO.ctrlKey]&&a.keyCode===v.UNDO.keyCode&&!a[v.REDO.shiftKey]){var k=d.retreatPop();if(void 0!==k){if("delete"===k.type&&c.addEle(s.websiteCode.ID,k.value.sessionId,k.value,s,"retreat"),"updateEle"===k.type&&(c.updateEle(s.websiteCode.ID,k.value,"retreat"),b.updateEle(k.value)),"add"===k.type&&c.deleteEle(s.websiteCode.ID,k.value.ID,"retreat"),"changeSession"===k.type&&c.changeSession(k.value.changeSession.endSession,k.value.changeSession.startSession,k.value,"forward"),"group"===k.type){var l=$("#"+k.value.ID+".position-box");k.value.position.left=l.css("left"),k.value.position.top=l.css("top"),c.unGroupEle(k.value,"retreat")}"unGroup"===k.type&&c.groupEle(k.value.eleList,"retreat",k.value.oldID),"deleteSession"===k.type&&c.reductionSession(k.value,"retreat"),"addSession"===k.type&&c.deleteSession(k.value.ID,"retreat"),"changeSessionHeight"===k.type&&c.changeSessionHeight(k.value.sessionID,k.value.height,"retreat"),"updateSession"===k.type&&s.$apply(function(){c.updateSession(k.value,"retreat");var a={};switch(k.value.background.type){case"image":a={image:k.value.background.url,color:k.value.background.color,video:"",type:k.value.background.type};break;case"video":a={image:k.value.background.previewImage,color:k.value.background.color,video:k.value.background.url,type:k.value.background.type}}m.updateOption(a)})}}if(a[v.REDO.ctrlKey]&&a.keyCode===v.REDO.keyCode&&a[v.REDO.shiftKey]){var k=d.forwardPop();if(void 0!==k){if("delete"===k.type&&c.addEle(s.websiteCode.ID,k.value.sessionId,k.value,s,"forward"),"updateEle"===k.type&&(c.updateEle(s.websiteCode.ID,k.value,"forward"),b.updateEle(k.value)),"add"===k.type&&c.deleteEle(s.websiteCode.ID,k.value.ID,"forward"),"changeSession"===k.type&&c.changeSession(k.value.changeSession.endSession,k.value.changeSession.startSession,k.value,"forward"),"group"===k.type){var l=$("#"+k.value.ID+".position-box");k.value.position.left=l.css("left"),k.value.position.top=l.css("top"),c.unGroupEle(k.value,"forward")}"unGroup"===k.type&&c.groupEle(k.value.eleList,"retreat",k.value.oldID),"deleteSession"===k.type&&c.reductionSession(k.value,"forward"),"addSession"===k.type&&c.deleteSession(k.value.ID,"forward"),"changeSessionHeight"===k.type&&c.changeSessionHeight(k.value.sessionID,k.value.height,"forward"),"updateSession"===k.type&&s.$apply(function(){c.updateSession(k.value,"forward");var a={};switch(k.value.background.type){case"image":a={image:k.value.background.url,color:k.value.background.color,video:"",type:k.value.background.type};break;case"video":a={image:k.value.background.previewImage,color:k.value.background.color,video:k.value.background.url,type:k.value.background.type}}m.updateOption(a)})}}if(a[v.CUT.ctrlKey]&&a.keyCode===v.CUT.keyCode&&f("cut"),a[v.COPY.ctrlKey]&&a.keyCode===v.COPY.keyCode&&f("copy"),a[v.PASTE.ctrlKey]&&a.keyCode===v.PASTE.keyCode){var k=jQuery.extend(!0,{},g.getData());if(null===k.value)return;j(k.type,k)}if(a.keyCode===v.MOVE_TOP.keyCode&&("edit"===s.activeEle.state||e("top",a)),a.keyCode===v.MOVE_DOWN.keyCode&&("edit"===s.activeEle.state||e("bottom",a)),a.keyCode===v.MOVE_LEFT.keyCode&&("edit"===s.activeEle.state||e("left",a)),a.keyCode===v.MOVE_RIGHT.keyCode&&("edit"===s.activeEle.state||e("right",a)),a.keyCode===v.DELETE.keyCode){var n=h.getEleList();if(n.value.length>0)for(var p=0;p<n.value.length;p++)n.value[p].state&&c.deleteEle(o.getActivePage().value,n.value[p].ID);else null!==s.activeEle&&c.deleteEle(o.getActivePage().value,s.activeEle.ID)}}p.init("web");var v=n.get();b.init(s),c.initScope(s),s.$on("refreshPage",function(a,c){b.refreshPage(c,s)}),s.$on("builderAddEle",function(a,b,d){c.addEle(s.websiteCode.ID,b,d,s)}),t.append(a.createPage(s.websiteCode,s));var w="";s.hoverSession=function(a,b){b!==w&&(w=b,j.setSession(w))},s.activeEle=null,i.clear(),s.activeGroup=null,s.editEleGroup=function(a,b){s.activeGroup=b,s.activeEle=null;var c=$(a.target);c.parent(".ele-box").parent(".position-box").addClass("group-active")},s.selectEle=function(a,b){if(a[v.ADD.ctrlKey]===!0&&a.buttons===v.ADD.keyCode)return null!==s.activeEle&&h.addEle(s.activeEle.ID),h.addEle(b),s.activeEle=null,void i.clear();k.hideDom();var d=$("#"+b+".position-box").attr("multiple-choice");"true"!==d&&(null===s.activeEle||void 0===s.activeEle?(h.removeEle(),s.activeEle=c.getEle(s.websiteCode.ID,b),i.setEle(jQuery.extend(!0,{},s.activeEle)),s.activeEle.state="select"):s.activeEle.ID!==b&&(s.activeEle=null,i.clear(),window.getSelection()?window.getSelection().removeAllRanges():document.getSelection().removeAllRanges(),e.hideDom(),f.hideBoxDom(),f.hideDom(),s.activeEle=c.getEle(s.websiteCode.ID,b),i.setEle(jQuery.extend(!0,{},s.activeEle)),s.activeEle.state="select"))},s.editEleText=function(a){var b=$("#"+a+".position-box"),d=b.attr("multiple-choice");"true"!==d&&(e.showDom(a),f.hideBoxDom(),f.hideDom(),s.activeEle=c.getEle(s.websiteCode.ID,a),s.activeEle.state="edit",i.setEle(jQuery.extend(!0,{},s.activeEle)),b.addClass("editing"))},s.editEleImage=function(a){s.activeEle=c.getEle(s.websiteCode.ID,a),i.setEle(jQuery.extend(!0,{},s.activeEle)),r.openCrop(angular.copy(s.activeEle))},s.editImage=function(a){},s.changeBackground=function(a,b){var d={};d=c.getSession(b);var e={color:d.background.color,video:d.background.videoUrl,type:d.background.type};switch(d.background.type){case"image":e.image=d.background.url;break;case"video":e.image=d.background.previewImage}m.showDom(a.clientX-180,a.clientY+20,d.ID,e,function(a){})},s.deleteSession=function(a){swal({title:"确定要删除该模块吗？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"删除",cancelButtonText:"取消",closeOnConfirm:!0,closeOnCancel:!0},function(b){b&&c.deleteSession(a)})},$(document).on("mousedown",function(a){if(m.hideDom(),null!==s.activeGroup&&1===a.buttons){$(t).find("#"+s.activeGroup+".position-box[ele-type=group]").removeClass("group-active");var d=$(a.target).parents(".position-box[ele-type=group]").eq(0).attr("id");void 0===d||(s.activeGroup=d)}null!==s.activeEle&&$(a.target).attr("id")!==s.activeEle.ID&&(s.$apply(function(){if($(a.target).parents(".position-box").attr("ID")!==s.activeEle.ID){if("edit"===s.activeEle.state){e.hideDom(),f.hideBoxDom(),f.hideDom(),s.activeEle.state="",$("#"+s.activeEle.ID+".position-box").removeClass("editing"),window.getSelection()?window.getSelection().removeAllRanges():document.getSelection().removeAllRanges();var d=b.getEle(s.activeEle.ID,s.activeEle.type);c.updateEle(s.websiteCode.ID,d)}s.activeEle=null,i.clear()}}),l.hideDom())}),$(document).on("keydown",u),s.$on("$destroy",function(){$(document).off("keydown",u),p.removePlugin(),q.removePlugin()})}}}]).directive("creatorPhone",["phoneCreatorServices","phoneBuilderTool","websiteData","phoneHistoryLog","activeEleService","activeSessionService","rightClickMenuService","shortcuts","eleMenuServices","multipleChoiceService",function(a,b,c,d,e,f,g,h,i,j){return{restrict:"A",scope:{websiteCode:"="},link:function(k,l){function m(a){function e(a,d){d.stopPropagation(),d.preventDefault();var e=0,f="left";switch(a){case"right":e=1,f="left";break;case"left":e=-1,f="left";break;case"top":e=-1,f="top";break;case"bottom":e=1,f="top"}if(null!==k.activeEle){var g=b.getEle(k.activeEle.ID,k.activeEle.type);g.phoneStyle.position[f]=parseInt(g.phoneStyle.position[f])+e+"px",b.moveEle(g.ID,f,e),c.updatePhoneEle(k.websiteCode.ID,g)}}if(a[n.UNDO.ctrlKey]&&a.keyCode===n.UNDO.keyCode&&!a[n.REDO.shiftKey]){var f=d.retreatPop();void 0!==f&&("updatePhoneEle"===f.type&&(c.updatePhoneEle(k.websiteCode.ID,f.value,"retreat"),b.updateEle(f.value)),"changeSessionHeight"===f.type&&c.changePhoneSessionHeight(f.value.sessionID,f.value.height,"retreat"),"hideSession"===f.type&&k.$apply(function(){c.showSession(f.value.sessionID,"retreat")}),"showSession"===f.type&&k.$apply(function(){c.hideSession(f.value.sessionID,"retreat")}),"hideEle"===f.type&&k.$apply(function(){c.showEle(f.value.ID,"retreat")}),"showEle"===f.type&&k.$apply(function(){c.hideEle(f.value.ID,"retreat")}))}if(a[n.REDO.ctrlKey]&&a.keyCode===n.REDO.keyCode&&a[n.REDO.shiftKey]){var f=d.forwardPop();void 0!==f&&("updatePhoneEle"===f.type&&(c.updatePhoneEle(k.websiteCode.ID,f.value,"forward"),b.updateEle(f.value)),"changeSessionHeight"===f.type&&c.changePhoneSessionHeight(f.value.sessionID,f.value.height,"forward"),"hideSession"===f.type&&k.$apply(function(){c.showSession(f.value.sessionID,"forward")}),"showSession"===f.type&&k.$apply(function(){c.hideSession(f.value.sessionID,"forward")}),"hideEle"===f.type&&k.$apply(function(){c.hideEle(f.value.ID,"retreat")}),"showEle"===f.type&&k.$apply(function(){c.hideEle(f.value.ID,"forward")}))}n.MOVE_TOP.keyCode===a.keyCode&&("edit"===k.activeEle.state||e("top",a)),n.MOVE_DOWN.keyCode===a.keyCode&&("edit"===k.activeEle.state||e("bottom",a)),n.MOVE_LEFT.keyCode===a.keyCode&&("edit"===k.activeEle.state||e("left",a)),n.MOVE_RIGHT.keyCode===a.keyCode&&("edit"===k.activeEle.state||e("right",a)),n.DELETE.keyCode===a.keyCode&&null!==k.activeEle&&c.hideEle(k.activeEle.ID)}i.init("phone");var n=h.get();b.init(k),c.initScope(k),k.$on("refreshPage",function(a,c){b.refreshPage(c,k)}),l.append(a.createPage(k.websiteCode,k));var o="";k.hoverSession=function(a,b){b!==o&&(o=b,f.setSession(o))},k.activeEle=null,e.clear(),k.activeGroup=null,k.editEleGroup=function(a,b){k.activeGroup=b,k.activeEle=null,e.clear();var c=$(a.target);c.parent(".ele-box").parent(".position-box").addClass("group-active")},k.selectEle=function(a,b){if(a[n.ADD.ctrlKey]===!0&&a.buttons===n.ADD.keyCode)return null!==k.activeEle&&j.addEle(k.activeEle.ID),j.addEle(b),k.activeEle=null,void e.clear();g.hidePhoneDom();var d=$("#"+b+".position-box").attr("multiple-choice");"true"!==d&&(null===k.activeEle?(k.activeEle=c.getEle(k.websiteCode.ID,b),e.setEle(jQuery.extend(!0,{},k.activeEle)),k.activeEle.state="select"):k.activeEle.ID!==b&&(k.activeEle=null,e.clear(),window.getSelection()?window.getSelection().removeAllRanges():document.getSelection().removeAllRanges(),k.activeEle=c.getEle(k.websiteCode.ID,b),e.setEle(jQuery.extend(!0,{},k.activeEle)),k.activeEle.state="select"))},k.deleteSession=function(a){swal({title:"确定要隐藏该模块吗？",type:"warning",showCancelButton:!0,confirmButtonColor:"#DD6B55",confirmButtonText:"隐藏",cancelButtonText:"取消",closeOnConfirm:!0,closeOnCancel:!0},function(b){b&&k.$apply(function(){c.hideSession(a)})})},$(document).on("mousedown",function(a){if(null!==k.activeGroup&&1===a.buttons){$(l).find("#"+k.activeGroup+".position-box[ele-type=group]").removeClass("group-active");var b=$(a.target).parents(".position-box[ele-type=group]").eq(0).attr("id");void 0===b||(k.activeGroup=b)}null!==k.activeEle&&$(a.target).attr("id")!==k.activeEle.ID&&k.$apply(function(){$(a.target).parents(".position-box").attr("ID")!==k.activeEle.ID&&(k.activeEle=null,e.clear())})}),$(document).on("keydown",m),k.$on("$destroy",function(){$(document).off("keydown",m),i.removePlugin()})}}}]).factory("creatorServices",["$compile",function(a){var b={createPage:function(b,c){for(var d=$("<div></div>"),e="",f=b.sessionList,g=0;g<f.length;g++)e=this.createSession(f[g]),e=a(e.get(0))(c),d.append(e);return d},createSession:function(a){var b="<div class='ele-session-box-container' "+a.eleTemplateType+"></div>";return b=$(b),b.get(0).eleConfig=a,b},createEle:function(a){var b=null;switch(a.type){case"text":b=this.createText(a);break;case"image":b=this.createImage(a);break;case"menu":b=this.createMenu(a);break;case"group":b=this.createGroup(a)}return b},createText:function(a){var b="<div class='position-box-parent' "+a.eleTemplateType+" template-type='"+a.eleTemplateType+"'></div>";return b=$(b),b.get(0).eleConfig=a,b},createGroup:function(a){var b="<div class='position-box-parent' "+a.eleTemplateType+" template-type='"+a.eleTemplateType+"'></div>";return b=$(b),b.get(0).eleConfig=a,b},createImage:function(a){var b="<div class='position-box-parent' "+a.eleTemplateType+" template-type='"+a.eleTemplateType+"'></div>";return b=$(b),b.get(0).eleConfig=a,b},createMenu:function(a){var b="<div class='position-box-parent' "+a.eleTemplateType+" template-type='"+a.eleTemplateType+"'></div>";return b=$(b),b.get(0).eleConfig=a,b}};return b}]).factory("phoneCreatorServices",["$compile",function(a){var b={createPage:function(b,c){for(var d=$("<div></div>"),e="",f=b.sessionList,g=0;g<f.length;g++)e=this.createSession(f[g]),e=a(e.get(0))(c),d.append(e),f[g].showState===!1&&e.css("display","none");return d},createSession:function(a){var b="<div class='ele-session-box-container' "+a.eleTemplateType+"-phone></div>";return b=$(b),b.get(0).eleConfig=a,b},createEle:function(a){var b=null;switch(a.type){case"text":b=this.createText(a);break;case"image":b=this.createImage(a);break;case"menu":b=this.createMenu(a);break;case"group":b=this.createGroup(a)}return b},createText:function(a){var b=a.eleTemplateType+"-phone",c="<div class='position-box-parent' "+b+" template-type='"+a.eleTemplateType+"'></div>";return c=$(c),c.get(0).eleConfig=a,c},scaleText:function(a,b){(void 0===b||null===b)&&(b=1);for(var c="";-1!==a.indexOf("font-size:");){c+=a.substring(0,a.indexOf("font-size:")+10),a=a.substring(a.indexOf("font-size:")+10,a.length);var d=a.substring(0,a.indexOf(";"));c+=parseInt(d)*b+"px",a=a.substring(a.indexOf(";"),a.length)}return c+=a},createGroup:function(a){var b=a.eleTemplateType+"-phone",c="<div class='position-box-parent' "+b+" template-type='"+a.eleTemplateType+"'></div>";return c=$(c),c.get(0).eleConfig=a,c},createImage:function(a){var b=a.eleTemplateType+"-phone",c="<div class='position-box-parent' "+b+" template-type='"+a.eleTemplateType+"'></div>";return c=$(c),c.get(0).eleConfig=a,c},createMenu:function(a){var b=a.eleTemplateType+"-phone",c="<div class='position-box-parent' "+b+" template-type='"+a.eleTemplateType+"'></div>";return c=$(c),c.get(0).eleConfig=a,c}};return b}]),angular.module("browserInfo",[]).factory("browserInfo",function(){var a=USERAGENT.analyze(navigator.userAgent),b={getOs:function(){return a.os}};return b}),angular.module("shortcuts",["browserInfo"]).factory("shortcuts",["browserInfo",function(a){var b={UNDO:{ctrlKey:"ctrlKey",keyCode:90},ADD:{ctrlKey:"ctrlKey",keyCode:1},REDO:{ctrlKey:"ctrlKey",keyCode:90,shiftKey:"shiftKey"},CUT:{ctrlKey:"ctrlKey",keyCode:88},COPY:{ctrlKey:"ctrlKey",keyCode:67},PASTE:{ctrlKey:"ctrlKey",keyCode:86},MOVE_TOP:{keyCode:38},MOVE_DOWN:{keyCode:40},MOVE_LEFT:{keyCode:37},MOVE_RIGHT:{keyCode:39},DELETE:{keyCode:46}},c={UNDO:{ctrlKey:"metaKey",keyCode:90},ADD:{ctrlKey:"metaKey",keyCode:1},REDO:{ctrlKey:"metaKey",keyCode:90,shiftKey:"shiftKey"},CUT:{ctrlKey:"metaKey",keyCode:88},COPY:{ctrlKey:"metaKey",keyCode:67},PASTE:{ctrlKey:"metaKey",keyCode:86},MOVE_TOP:{keyCode:38},MOVE_DOWN:{keyCode:40},MOVE_LEFT:{keyCode:37},MOVE_RIGHT:{keyCode:39},DELETE:{keyCode:8}},d=a.getOs(),e="",f={};d.windows===!0?(e="windows",f=b):d.name.indexOf("mac")&&(e="mac",f=c);var g={get:function(){return f}};return g}]),angular.module("insert.directive",[]).directive("insertEle",["$rootScope","LxNotificationService","websiteData","activeSessionService","activePageService","builderTool","$timeout","imageLibraryService",function(a,b,c,d,e,f,g,h){return{restrict:"A",scope:{insertEle:"=",insertConfig:"="},link:function(g,i,j){function k(a){n.flag=!0,n.cx=a.clientX,n.cy=a.clientY}function l(b){if(n.flag){var c=Math.abs(b.clientX-n.cx),d=Math.abs(b.clientY-n.cy);(c>5||d>5)&&n.moveFlag===!1&&(n.moveFlag=!0,g.$apply(function(){a.$broadcast("closeLeftMenu")}),$("body").append(q)),n.moveFlag&&q.css({left:b.clientX-o/2,top:b.clientY-p/2})}}function m(a){function i(b){var h=d.getSession().value,i=e.getActivePage().value;console.log(h);var j=$("#"+h+".ele-session-box .ele-session").offset();return b.position.left=a.clientX-j.left-parseInt(g.insertEle.border.width)/2,b.position.top=a.clientY-j.top-parseInt(g.insertEle.border["min-height"])/2,b.ID=f.createID(),c.addEle(i,h,b,"")}n.flag&&(n.flag=!1,n.moveFlag?(n.moveFlag=!1,q.remove(),"image"==g.insertEle.type?h.showDom(1,function(a){c.changeImageUrl(g.insertEle,g.insertEle.type,a[0].url).then(function(a){g.insertEle=a,i(g.insertEle)})}):i(g.insertEle)):b.info("拖动元素到页面上即可插入元素"))}void 0===g.insertConfig&&(g.insertConfig={});var n={flag:!1,moveFlag:!1,cx:0,cy:0},o=parseInt(g.insertEle.border.width),p=parseInt(g.insertEle.border["min-height"]),q=$("<div class='virtual-box'></div>");q.css({width:g.insertEle.border.width,height:g.insertEle.border["min-height"]}),$(i).on("mousedown",k),$(document).on("mousemove",l),$(document).on("mouseup",m)}}}]),angular.module("eleMenu",[]).directive("eleMenu",["$compile","eleSettingService","eleMenuServices","imageLibraryService","imageCropService","activeEleService","websiteData","activePageService","$timeout",function(a,b,c,d,e,f,g,h,i){return{restrict:"A",template:"<div class='ele-menu' onmousedown='event.stopPropagation()'><button class='btn btn--l btn--blue btn--fab z-depth-1 image-button' lx-ripple ng-click='changeImage();hitDocumenut();'><i class='mdi mdi-repeat'></i><span>更换</span></button><button class='btn btn--l btn--blue btn--fab z-depth-1 image-button' lx-ripple ng-click='openCrop();hitDocumenut();'><i class='mdi mdi-crop'></i><span>裁剪</span></button><button class='btn btn--l btn--blue btn--fab z-depth-1 text-button' lx-ripple ng-click='hitDocumenut();'><i class='mdi mdi-pencil'></i><span>编辑</span></button><button class='btn btn--l btn--blue btn--fab z-depth-1 group-button' lx-ripple ng-click='hitDocumenut();'><i class='mdi mdi-pencil'></i><span>编辑</span></button><button class='btn btn--l btn--blue btn--fab z-depth-1 all-button' lx-ripple ng-click=openSettingBox('design',$event)><i class='mdi mdi-checkerboard'></i><span>设计</span></button><button class='btn btn--l btn--blue btn--fab z-depth-1 all-button' lx-ripple ng-click=openSettingBox('layers',$event)><i class='mdi mdi-layers'></i><span>布局</span></button><button class='btn btn--l btn--blue btn--fab z-depth-1 all-button' lx-ripple ng-click=openSettingBox('animate',$event)><i class='mdi mdi-auto-fix'></i><span>动画</span></button><button class='btn btn--l btn--blue btn--fab z-depth-1 image-button' lx-ripple ng-click=openSettingBox('filter',$event)><i class='mdi mdi-image-multiple'></i><span>滤镜</span></button></div>",link:function(a,c,j){a.hitDocumenut=function(){i(function(){$(document).trigger("mousedown"),$(document).trigger("mouseup")})},a.changeImage=function(){var a=angular.copy(f.getEle());d.showDom(1,function(b){var c={ID:a.value.ID,type:a.value.type},d={url:b[0].url};g.updateImageUrl(h.getActivePage().value,c,d)})},a.openSettingBox=function(a,c){var d=f.getEle();"design"===a&&(a=d.value.type+a);var e=d.value.ID,g=c.clientX,h=c.clientY;b.showDom(g,h,a,e,d.value)},a.openCrop=function(){var a=f.getEle().value.ID;e.openCrop(angular.copy(g.getEle(h.getActivePage().value,a)))}}}}]).directive("phoneEleMenu",["$compile","eleSettingService","eleMenuServices",function(a,b,c){return{restrict:"A",template:"<div class='ele-menu' onmousedown='event.stopPropagation()'></div>",link:function(a,b,d){a.eleMenu=c.getType()}}}]).factory("eleMenuServices",["$rootScope","$compile","elePosition","$timeout","rotateEleCalculate",function(a,b,c,d,e){var f=null,g={},h="",i="",j="",k="",l="",m="",n="",o="",p="",q={ID:"",value:""},r={init:function(b){i=a.$on("deleteEle",function(){r.hideDom()}),j=a.$on("updateEle",function(){""!==g.ID&&r.showDom(g.ID,g.type)}),k=a.$on("eleDragStart",function(){r.hideDom()}),l=a.$on("eleDragEnd",function(){if(""!==g.ID)if("text"==g.type){var a=$("#"+g.ID+".position-box").find(".ele .ql-editor").attr("contenteditable");Boolean(a)===!1&&r.showDom(g.ID,g.type)}else r.showDom(g.ID,g.type)}),m=a.$on("levelScrollStart",function(){r.hideDom()}),n=a.$on("levelScrollEnd",function(){""!==g.ID&&r.showDom(g.ID,g.type)}),o=a.$on("addSessionOpenStart",function(){r.hideDom()}),p=a.$on("addSessionOpenEnd",function(){""!==g.ID&&r.showDom(g.ID,g.type)}),h=b},getType:function(){return q},setType:function(a){q.value=a},createDom:function(c,d){var e="";switch(h){case"web":e="<div class='ele-menu-box' ele-menu='"+d+"'></div>";break;case"phone":e="<div class='ele-menu-box' phone-ele-menu='"+d+"'></div>"}return e=b(e)(a),e.hide(),$("#main-editor-scroll").append(e),e},showDom:function(a,b){console.log(arguments),this.setType(b),g.ID=a,g.type=b;var h=$("#"+a),i={left:parseInt($(h).css("left")),top:parseInt($(h).css("top")),width:parseInt($(h).get(0).offsetWidth),height:parseInt($(h).get(0).offsetHeight)},j=e.getSizeAndPosition(i.left,i.top,i.width,i.height,e.getRotate(h)),k=j.left+(c.getLeft(h.get(0))-j.originalLeft),l=j.top+(c.getTop(h.get(0))-j.originalTop)+j.height;null===f&&(f=this.createDom(a,b)),f.css({left:k,top:l+10}),f.attr("ele-menu",b),f.find("button").css("display","none"),f.find("."+b+"-button").css("display","inline-block"),f.find(".all-button").css("display","inline-block"),f.show(),d(function(){f.addClass("active")})},hideDom:function(a){a&&(g.ID="",g.type=""),null!==f&&(f.hide(),f.removeClass("active"))},removePlugin:function(){null!==f&&(f.remove(),f=null,k(),l(),i(),j(),p(),o())}};return r}]),angular.module("addSession",[]).directive("addSessionBox",["websiteData","elePosition","levelScroll","builderTool",function(a,b,c,d){return{restrict:"A",scope:{closeHandle:"&",targetSession:"@"},templateUrl:"views/addSession/sessionList.html",link:function(e,f,g){var h=200,i=$("#main-editor-scroll"),j=($(f).find(".swiper-container").swiper({direction:"horizontal",slidesPerView:"auto"}),{ID:d.createID(),type:"session",name:"导航",background:{url:"images/website/headBg.jpg",type:"image"},"class":[],style:{"min-height":"650px","background-size":"cover","background-position-x":"center","background-position-y":"center","background-repeat":"no-repeat","background-color":"#fff",position:"relative"},phoneStyle:{"min-height":"300px"},eleList:[{ID:d.createID(),type:"text",textValue:'<div><span style="color: rgb(255, 255, 255);"><span style="font-family: Helvetica;"><span style="font-size: 60px;">Building bulletproof&nbsp;</span></span></span></div><div><span style="color: rgb(255, 255, 255);"><span style="font-family: Helvetica;"><span style="font-size: 60px;">fucghea apps</span></span></span></div>',position:{left:"473px",top:"247px"},border:{width:"543px","min-height":"114px"},style:{"margin-top":"-57px","line-height":"42px"},eleTemplateType:"ele-text-default",phoneStyle:{position:{left:"22px",top:"97px"},border:{width:"301px","min-height":"228px"},style:{},scale:"0.7"},state:"select",$$hashKey:"object:315"},{ID:d.createID(),type:"text",textValue:'<div><span style="color: rgb(255, 255, 255);"><span style="font-size: 14px;">Kickstarter umami Intelligentsia kogi. Try-hard flannel literally, chambray blog crucifix put a bird on it four dollar toast cardigan scenester aesthetic</span></span></div>',position:{left:"476px",top:"371px"},border:{width:"514px","min-height":"36px"},style:{"margin-top":"-18px","line-height":"17px"},eleTemplateType:"ele-text-default",phoneStyle:{position:{left:"75px",top:"81px"},border:{width:"245px","min-height":"90px"},style:{},scale:"0.7"},state:"select",$$hashKey:"object:309",showState:!1}],eleTemplateType:"session-default",$$hashKey:"object:137"}),k={ID:d.createID(),type:"session",name:"Banner",background:{url:"",type:"color",color:"#835fa8"},style:{"min-height":"500px","background-size":"cover","background-position-x":"center","background-position-y":"center","background-repeat":"no-repeat",position:"relative","background-color":"#835fa8"},phoneStyle:{"min-height":"430px"},eleList:[{ID:d.createID(),type:"image",position:{left:"522px",top:"-77px"},border:{width:"569px","min-height":"576px"},style:{"margin-top":"0px",width:"570px",height:"756px",clip:"rect(0px 566.643px 576px 0px)",top:"0px",left:"1.1787px"},url:"images/website/shouji.png",eleTemplateType:"ele-image-default",backgroundSize:"contain",phoneStyle:{position:{left:"29px",top:"203px"},border:{width:"224px","min-height":"226px"},style:{"margin-top":"0px",width:"223px",height:"297px",clip:"rect(0px 222.047px 226px 0px)",top:"0px",left:"0.976676px"},scale:"0.7"},imageSize:{width:"670px",height:"889px"},state:"select"},{ID:d.createID(),type:"group",position:{left:"-29px",top:"119px"},border:{width:"475px","min-height":"170px"},style:{"margin-top":"0px"},eleList:[{ID:d.createID(),type:"text",textValue:'<div><span style="color: rgb(255, 255, 255);"><span style="font-family: Helvetica;"><b><span style="font-size: 35px;">Super Duper &amp; such</span></b></span></span></div>',position:{left:"5px",top:"0px"},border:{width:"356px","min-height":"52px"},style:{"margin-top":"-26px"},eleTemplateType:"ele-text-default",phoneStyle:{position:{left:"0px",top:"0px"},border:{width:"356px","min-height":"52px"},style:{},scale:"0.7303370786516854"}},{ID:d.createID(),type:"image",position:{left:"0px",top:"135px"},border:{width:"129px","min-height":"33px"},style:{"margin-top":"0px",width:"126px",height:"33px",clip:"rect(0px 124.5px 33px 0px)",top:"0px",left:"2.25px"},url:"images/website/Button.png",eleTemplateType:"ele-image-default",backgroundSize:"contain",imageSize:{width:"167px",height:"44px"},phoneStyle:{position:{left:"0px",top:"98px"},border:{width:"129px","min-height":"33px"},style:{width:"119px",height:"31px",clip:"rect(0px 118.571px 31.4286px 0px)",left:"2.25px",top:"0px"},scale:"1"},state:"select"},{ID:d.createID(),type:"text",textValue:'<div><span style="color: rgb(255, 255, 255);"><span style="font-size: 8px;">Kickstarter umami Intelligentsia kogi. Try-hard flannel literally, chambray blog crucifix put a bird on it four dollar toast cardigan scenester aesthetic</span></span></div>',position:{left:"6px",top:"63px"},border:{width:"467px","min-height":"48px"},style:{"margin-top":"-24px"},eleTemplateType:"ele-text-default",phoneStyle:{position:{left:"0px",top:"51px"},border:{width:"467px","min-height":"48px"},style:{},scale:"0.556745182012848"},state:"select"}],eleTemplateType:"ele-group-default",phoneStyle:{style:{},position:{left:"10px",top:"17px"},border:{width:"260px","min-height":"133px"},scale:"0.7"},state:"select"}],eleTemplateType:"session-default",$$hashKey:"object:138"},l={ID:d.createID(),type:"session",name:"Banner",background:{url:"",type:"color",color:"#f4f8fb"},style:{"min-height":"500px","background-size":"cover","background-position-x":"center","background-position-y":"center","background-repeat":"no-repeat",position:"relative","background-color":"#f4f8fb"},phoneStyle:{"min-height":981},eleList:[{ID:d.createID(),type:"group",position:{left:"-77px",top:"100px"},border:{width:"341px","min-height":"292px"},style:{"margin-top":"0px"},eleList:[{ID:d.createID(),type:"text",textValue:'<div><span style="font-family: Helvetica;"><span style="font-size: 24px;">Design &amp; Features</span></span></div>',position:{left:"8px",top:"1px"},border:{width:"240px","min-height":"36px"},style:{"margin-top":"-18px"},eleTemplateType:"ele-text-default",phoneStyle:{position:{left:"8px",top:"11px"},border:{width:"227px","min-height":"36px"},style:{},scale:"0.7"},state:"select"},{ID:d.createID(),type:"text",textValue:'<div><span style="font-family: Candara;color:#7d7f84">Flannel ennui narwhal, craft beer twee Vice plaid authentic synth.</span></div>',position:{left:"8px",top:"59px"},border:{width:"308px","min-height":"48px"},style:{"margin-top":"-24px"},eleTemplateType:"ele-text-default",phoneStyle:{position:{left:"6px",top:"45.8118px"},border:{width:"239px","min-height":"72px"},style:{"margin-top":"-48px"}},state:"select"},{ID:d.createID(),type:"text",textValue:'<div><span style="font-size: 9px;">Kickstarter umami Intelligentsia Try-hard flannel literally, chambray blog crucifix put a bird on it four dollar toast cardigan  aesthetic sartorial chia messenger bag Pinterest.&nbsp;</span></div>',
position:{left:"6px",top:"131px"},border:{width:"333px","min-height":"96px"},style:{"margin-top":"-48px"},eleTemplateType:"ele-text-default",phoneStyle:{position:{left:"5px",top:"129px"},border:{width:"259px","min-height":"96px"},style:{"margin-top":"-48px"}},state:"select"},{ID:d.createID(),type:"image",position:{left:"0px",top:"257px"},border:{width:"129px","min-height":"33px"},style:{"margin-top":"0px",width:"126px",height:"33px",clip:"rect(0px 124.5px 33px 0px)",top:"0px",left:"2.25px"},url:"images/website/Button.png",eleTemplateType:"ele-image-default",backgroundSize:"contain",phoneStyle:{position:{left:"3px",top:"239px"},border:{width:"100px","min-height":"25.6235px"},style:{width:"98px",height:"26px",clip:"rect(0px 98.9677px 26px 0px)",left:"0.516129px",top:"0px"},scale:"1"},state:"select"}],eleTemplateType:"ele-group-default",phoneStyle:{style:{},position:{left:"6px",top:"42px"},border:{width:"267px","min-height":"267px"},scale:"0.7647058823529411"},state:"select"},{ID:d.createID(),type:"group",position:{left:"359px",top:"100px"},border:{width:"341px","min-height":"292px"},style:{"margin-top":"0px"},eleList:[{ID:d.createID(),type:"text",textValue:'<div><span style="font-family: Helvetica;"><span style="font-size: 24px;">Design &amp; Features</span></span></div>',position:{left:"8px",top:"1px"},border:{width:"240px","min-height":"36px"},style:{"margin-top":"-18px"},eleTemplateType:"ele-text-default",phoneStyle:{position:{left:"6px",top:"13px"},border:{width:"207px","min-height":"36px"},style:{},scale:"0.7"}},{ID:d.createID(),type:"text",textValue:'<div><span style="font-family: Candara;color:#7d7f84">Flannel ennui narwhal, craft beer twee Vice plaid authentic synth.</span></div>',position:{left:"8px",top:"59px"},border:{width:"308px","min-height":"48px"},style:{"margin-top":"-24px"},eleTemplateType:"ele-text-default",phoneStyle:{position:{left:"5.32787px",top:"44.7541px"},border:{width:"235px","min-height":"72px"},style:{"margin-top":"-48px"}}},{ID:d.createID(),type:"text",textValue:'<div><span style="font-size: 9px;">Kickstarter umami Intelligentsia Try-hard flannel literally, chambray blog crucifix put a bird on it four dollar toast cardigan  aesthetic sartorial chia messenger bag Pinterest.&nbsp;</span></div>',position:{left:"6px",top:"131px"},border:{width:"333px","min-height":"96px"},style:{"margin-top":"-48px"},eleTemplateType:"ele-text-default",phoneStyle:{position:{left:"3px",top:"124px"},border:{width:"255px","min-height":"120px"},style:{"margin-top":"-48px"}}},{ID:d.createID(),type:"image",position:{left:"0px",top:"257px"},border:{width:"129px","min-height":"33px"},style:{"margin-top":"0px",width:"126px",height:"33px",clip:"rect(0px 124.5px 33px 0px)",top:"0px",left:"2.25px"},url:"images/website/Button.png",eleTemplateType:"ele-image-default",backgroundSize:"contain",phoneStyle:{position:{left:"1px",top:"257px"},border:{width:"99px","min-height":"24.5082px"},style:{width:"95px",height:"25px",clip:"rect(0px 94.7917px 25px 0px)",left:"2.10417px",top:"0px"},scale:"1"}}],eleTemplateType:"ele-group-default",phoneStyle:{style:{},position:{left:"11px",top:"337px"},border:{width:"262px","min-height":"295px"},scale:"0.7647058823529411"}},{ID:d.createID(),type:"group",position:{left:"785px",top:"100px"},border:{width:"341px","min-height":"292px"},style:{"margin-top":"0px"},eleList:[{ID:d.createID(),type:"text",textValue:'<div><span style="font-family: Helvetica;"><span style="font-size: 24px;">Design &amp; Features</span></span></div>',position:{left:"8px",top:"1px"},border:{width:"240px","min-height":"36px"},style:{"margin-top":"-18px"},eleTemplateType:"ele-text-default",phoneStyle:{position:{left:"11px",top:"10px"},border:{width:"220px","min-height":"36px"},style:{},scale:"0.7"}},{ID:d.createID(),type:"text",textValue:'<div><span style="font-family: Candara;color:#7d7f84">Flannel ennui narwhal, craft beer twee Vice plaid authentic synth.</span></div>',position:{left:"8px",top:"59px"},border:{width:"308px","min-height":"48px"},style:{"margin-top":"-24px"},eleTemplateType:"ele-text-default",phoneStyle:{position:{left:"10px",top:"45.6382px"},border:{width:"238px","min-height":"72px"},style:{"margin-top":"-48px"}}},{ID:d.createID(),type:"text",textValue:'<div><span style="font-size: 9px;">Kickstarter umami Intelligentsia Try-hard flannel literally, chambray blog crucifix put a bird on it four dollar toast cardigan  aesthetic sartorial chia messenger bag Pinterest.&nbsp;</span></div>',position:{left:"6px",top:"131px"},border:{width:"333px","min-height":"96px"},style:{"margin-top":"-48px"},eleTemplateType:"ele-text-default",phoneStyle:{position:{left:"8px",top:"130px"},border:{width:"256px","min-height":"120px"},style:{"margin-top":"-48px"}}},{ID:d.createID(),type:"image",position:{left:"0px",top:"257px"},border:{width:"129px","min-height":"33px"},style:{"margin-top":"0px",width:"126px",height:"33px",clip:"rect(0px 124.5px 33px 0px)",top:"0px",left:"2.25px"},url:"images/website/Button.png",eleTemplateType:"ele-image-default",backgroundSize:"contain",phoneStyle:{position:{left:"5px",top:"260px"},border:{width:"100px","min-height":"25.5265px"},style:{width:"98px",height:"26px",clip:"rect(0px 98.9677px 26px 0px)",left:"0.516129px",top:"0px"},scale:"1"}}],eleTemplateType:"ele-group-default",phoneStyle:{style:{},position:{left:"4px",top:"654px"},border:{width:"268px","min-height":"288px"},scale:"0.7647058823529411"}}],eleTemplateType:"session-default",$$hashKey:"object:139"};e.sessionList=[{preview:"images/session/session6.png",sessionData:j},{preview:"images/session/session7.png",sessionData:k},{preview:"images/session/session8.png",sessionData:l}],e.addSession=function(d){var f=a.addSession(angular.copy(d.sessionData),e.targetSession,{isShow:!1});f.addClass("base-session-show-transition"),f.height(d.sessionData.style["min-height"]);var g=b.getTop(f[0]),j=(i.scrollTop(),0);j=g+parseInt(d.sessionData.style["min-height"])/2-h-50-$("body").height()/2,c.scrollTop(i,j),f.one("transitionend",function(){f.removeClass("base-session-show-transition"),f.height("auto")}),e.closeHandle().call(this,function(){})}}}}]).directive("addSessionHandle",["$compile","$timeout","elePosition","levelScroll","$rootScope",function(a,b,c,d,e){return{restrict:"A",scope:{},template:'<div class="add-session-handle bottom z-depth-2" ng-class="{true:\'open\'}[showFlag]"><i class="mdi mdi-plus"></i></div>',replace:!0,link:function(f,g,h){var i=$(g).parents(".ele-session-box").attr("id"),j=200,k="";f.show=function(){f.showFlag=!0,""===k&&(k=a(n)(f),m.after(k)),b(function(){var a=c.getTop(k[0]),b=(l.scrollTop(),0);b=a+j/2-$("body").height()/2,d.scrollTop(l,b),k.addClass("in")})},f.hide=function(a){b(function(){f.showFlag=!1},300),e.$emit("addSessionOpenStart"),k.removeClass("in"),k.one("transitionend",function(){e.$emit("addSessionOpenEnd"),void 0!==a&&a()})};var l=$("#main-editor-scroll"),m=$(g).parent(".ele-session-box");f.showFlag=!1;var n="<div class='add-session-box' add-session-box close-handle='hide' target-session='"+i+"'></div>",o=function(a){if(f.showFlag===!0){var c=a.target;c===k[0]||k[0]===$(c).parents(".add-session-box")[0]||c===g[0]||$(c).parents(".add-session-box")[0]===g[0]||b(function(){e.$emit("addSessionOpenStart"),k.removeClass("in"),k.one("transitionend",function(){e.$emit("addSessionOpenEnd")}),b(function(){f.showFlag=!1},300)},100)}};$("body").on("mousedown",o),$(g).on("click",function(a){f.showFlag?f.hide():f.show()}),f.$on("$destroy",function(){$("body").off("mousedown",o),""!==k&&k.remove()})}}}]),angular.module("kyle.imageLibrary",[]).directive("imageLibrary",["imageLibraryService",function(a){return{restrict:"A",templateUrl:"views/imageLibrary/main.html",link:function(b,c,d){b.typeList=[{ID:"MyImage",name:"我的图片"},{ID:"CloundImage",name:"云图片"}],b.comfirm=function(){a.comfirm(b.selectedList)},b.imageListLoadingFlag=!1,b.categoryList=[],b.activeCategory=b.categoryList[0],b.imageList=[],b.selectType=function(c){b.imageListLoadingFlag!==!0&&(b.activeType=c,a.getImageCategory(b.activeType).then(function(c){b.categoryList=c,b.activeCategory=c[0],b.imageListLoadingFlag=!0,a.getImageList().then(function(a){b.imageList=a,b.imageListLoadingFlag=!1},function(){})},function(){}))},b.activeType=b.typeList[0],b.selectType(b.activeType),b.maxSelectSize=a.getMaxSelectSize(),b.cancel=function(){a.hideDowm()},b.confirm=function(){a.hideDowm()},b.selectedList=[],b.selectCategory=function(c){b.imageListLoadingFlag!==!0&&(b.activeCategory=c,b.imageListLoadingFlag=!0,a.getImageList().then(function(a){b.imageList=a,b.imageListLoadingFlag=!1},function(){}))},$(c).on("click",function(b){c[0]===b.target&&a.hideDowm()})}}}]).directive("imageList",function(){return{restrict:"AE",template:'<div class="image-library-image-list"><div ng-repeat="rowData in listData" class="image-library-image-item"><div class="inner" ng-class="{true:\'active\'}[rowData.isSelect==true]" ng-click="selectImage(rowData)" ng-style="{\'background-image\':\'url(\'+rowData.url+\')\'}"><div class="select-flag"><i class="mdi mdi-check"></i></div></div></div></div>',scope:{listData:"=",selectedList:"=",maxSelectSize:"="},link:function(a,b,c){void 0===a.selectedList&&(a.selectedList=[]),a.selectImage=function(b){if(b.isSelect){b.isSelect=!1;var c=-1;angular.forEach(a.selectedList,function(a,d){a==b&&(c=d)}),-1!=c&&a.selectedList.splice(c,1)}else if(b.isSelect=!0,a.selectedList.push(b),a.selectedList.length>a.maxSelectSize){a.selectedList[0].isSelect=!1;a.selectedList.splice(0,1)}}}}}).factory("imageLibraryService",["$rootScope","$compile","$timeout","$q",function(a,b,c,d){var e="",f=1,g={createDom:function(){var c=b("<div class='my-modal-box' image-library></div>")(a);return c=$(c),$("body").append(c),c},showDom:function(a,b){this.callback=b,a&&(f=a),""===e&&(e=this.createDom()),c(function(){e.addClass("open")},100)},hideDowm:function(a){e.removeClass("open")},comfirm:function(a){e.removeClass("open"),null!==this.callback&&(this.callback(a),this.callback=null)},removePlugin:function(){""!==e&&e.remove()},getMaxSelectSize:function(){return f},getImageCategory:function(a){var b=d.defer();return c(function(){var a=[{id:"AllImage",name:"所有图片"},{id:"BG",name:"背景图"}];b.resolve(a)}),b.promise},getImageList:function(){var a=d.defer();return c(function(){var b=[{url:"images/website/bg1.jpg"},{url:"images/website/icon.png"}];a.resolve(b)},500),a.promise}};return g}]),angular.module("kyle.imageCrop",["dataService"]).directive("imageCrop",["imageCropService","$timeout","builderTool","websiteData","activePageService","elePosition",function(a,b,c,d,e,f){return{restrict:"A",scope:{},template:'<div class="menu z-depth-2" onmousedown="event.stopPropagation()"><div class="slide-box" ng-model="imageSlide.value" text-editor-slider max-value="400"><div class="slide-line z-depth-1"><div class="slide-point z-depth-1"></div></div></div><div class="confirm-button" ng-click="crop()"><lx-button lx-color="blue">裁 剪</lx-button></div></div><div class="cover" onmousedown="event.stopPropagation()"></div><div class="image-cover" onmousedown="event.stopPropagation()"></div><div class="crop-box" onmousedown="event.stopPropagation()"><div class="handle left" direction="left"></div><div class="handle right" direction="right"></div><div class="handle top" direction="top"></div><div class="handle bottom" direction="bottom"></div><div class="handle left-top" direction="left-top"><div class="vertical"></div><div class="horizontal"></div></div><div class="handle right-top" direction="right-top"><div class="vertical"></div><div class="horizontal"></div></div><div class="handle left-bottom" direction="left-bottom"><div class="vertical"></div><div class="horizontal"></div></div><div class="handle right-bottom" direction="right-bottom"><div class="vertical"></div><div class="horizontal"></div></div></div>',link:function(b,g,h){function i(a,b,c,d){var e=$(g).find(".image-cover");e.css({clip:"rect("+b+"px,"+(a+c)+"px,"+(b+d)+"px,"+a+"px)"})}function j(a,b,c,d){return 80>b&&80>c?!1:80>b?!1:80>c?!1:!0}function k(a,b,c,d,e,f,g){return 0>b&&0>c?(a.css({left:0,top:0}),i(0,0,d,e),"left-top"):0>b&&c+e>g?(a.css({left:0,top:g-e}),i(0,g-e,d,e),"left-bottom"):b+d>f&&0>c?(a.css({left:f-d,top:0}),i(f-d,0,d,e),"right-top"):b+d>f&&c+e>g?(a.css({left:f-d,top:g-e}),i(f-d,g-e,d,e),"right-bottom"):0>b?(a.css({left:0,top:c}),i(0,c,d,e),"left"):0>c?(a.css({left:b,top:0}),i(b,0,d,e),"top"):b+d>f?(a.css({left:f-d,top:c}),i(f-d,c,d,e),"right"):c+e>g?(a.css({left:b,top:g-e}),i(b,g-e,d,e),"bottom"):!0}function l(a,b,c){var d=a.get(0).offsetLeft,e=a.get(0).offsetTop,f=a.get(0).offsetWidth,g=a.get(0).offsetHeight;0>d&&(f+=d,d=0,a.css({width:f,left:d})),0>e&&(g+=e,e=0,a.css({height:g,top:e})),d+f>b&&(f=b+d,a.css({width:f})),e+g>c&&(g=c+e,a.css({height:g}));var h={left:d,top:e,width:f,height:g};return h}function m(a,b,c,d){function e(a,b,c){var d=0,e=0;if(!j(a,b.eleWidth-c.x,void 0,"left"))return!1;d=b.eleLeft+c.x,e=b.eleWidth-c.x,a.css({width:e}),a.css({left:d});var f=l(a,t,u);i(f.left,f.top,f.width,f.height)}function f(a,b,c){var d=0;if(!j(a,b.eleWidth+c.x,void 0,"right"))return!1;d=b.eleWidth+c.x,a.css({width:d});var e=l(a,t,u);i(e.left,e.top,e.width,e.height)}function g(a,b,c){var d=0,e=0;if(!j(a,void 0,b.eleHeight-c.y,"top"))return!1;d=b.eleHeight-c.y,e=b.eleTop+c.y,a.css({height:d}),a.css({top:e});var f=l(a,t,u);i(f.left,f.top,f.width,f.height)}function h(a,b,c){var d=0;if(!j(a,void 0,b.eleHeight+c.y,"bottom"))return!1;d=b.eleHeight+c.y,a.css({height:d});var e=l(a,t,u);i(e.left,e.top,e.width,e.height)}function k(a,b,c){var d={x:b.eleWidth/(b.eleWidth+b.eleHeight),y:b.eleHeight/(b.eleWidth+b.eleHeight)},e=-(c.x/b.eleWidth)*b.eleHeight*d.x,f=-c.x*d.x,g=-c.y*d.y,h=-(c.y/b.eleHeight)*b.eleWidth*d.y,k=f+h+b.eleWidth,l=e+g+b.eleHeight,m=-h-f+b.eleLeft,n=-g-e+b.eleTop,o=k/l;if(!j(a,k,l,"leftTop"))return!1;if(0>m){k+=m;var p=l-k*(1/o);l=k*(1/o),n+=p,m=0}else if(0>n){l+=n;var q=k-l*o;k=l*o,m+=q,n=0}a.css({height:l,width:k}),a.css({top:n,left:m}),i(m,n,k,l)}function m(a,b,c){var d={x:b.eleWidth/(b.eleWidth+b.eleHeight),y:b.eleHeight/(b.eleWidth+b.eleHeight)},e=-(c.x/b.eleWidth)*b.eleHeight*d.x,f=-c.x*d.x,g=c.y*d.y,h=c.y/b.eleHeight*b.eleWidth*d.y,k=f+h+b.eleWidth,l=e+g+b.eleHeight,m=-h-f+b.eleLeft,n=b.eleTop,o=k/l;if(!j(a,k,l,"leftBottom"))return!1;if(0>m){k+=m;var p=l-k*(1/o);l=k*(1/o),n=-n+p,m=0}else if(0>n){l-=n;var q=k-l*o;k=l*o,m+=q,n=0}a.css({height:l,width:k}),a.css({left:m}),i(m,n,k,l)}function n(a,b,c){var d={x:b.eleWidth/(b.eleWidth+b.eleHeight),y:b.eleHeight/(b.eleWidth+b.eleHeight)},e=c.x/b.eleWidth*b.eleHeight*d.x,f=c.x*d.x,g=-c.y*d.y,h=-(c.y/b.eleHeight)*b.eleWidth*d.y,k=f+h+b.eleWidth,l=e+g+b.eleHeight,m=b.eleLeft,n=-g-e+b.eleTop,o=k/l;if(!j(a,k,l,"rightTop"))return!1;if(m+k>t){k=t-m;var p=l-k*(1/o);l=k*(1/o),n=-n+p}else 0>n&&(l-=n,k=l*o,n=0);a.css({height:l,width:k}),a.css({top:n,left:m}),i(m,n,k,l)}function o(a,b,c){var d={x:b.eleWidth/(b.eleWidth+b.eleHeight),y:b.eleHeight/(b.eleWidth+b.eleHeight)},e=c.x/b.eleWidth*b.eleHeight*d.x,f=c.x*d.x,g=c.y*d.y,h=c.y/b.eleHeight*b.eleWidth*d.y,k=f+h+b.eleWidth,l=e+g+b.eleHeight,m=b.eleLeft,n=b.eleTop,o=k/l;return j(a,k,l,"rightBottom")?(m+k>t?(k=t-m,l=k*(1/o)):n+l>u&&(l-=n,k=l*o),a.css({height:l,width:k}),a.css({top:n,left:m}),void i(m,n,k,l)):!1}switch(d){case"left":e(a,b,c);break;case"right":f(a,b,c);break;case"top":g(a,b,c);break;case"bottom":h(a,b,c);break;case"left-top":k(a,b,c);break;case"left-bottom":m(a,b,c);break;case"right-top":n(a,b,c);break;case"right-bottom":o(a,b,c)}}function n(a){if(D.dragFlag){var b=a.clientX-D.x,c=a.clientY-D.y,d={eleWidth:D.eleWidth,eleHeight:D.eleHeight,eleLeft:D.eleLeft,eleTop:D.eleTop},e={x:b,y:c};m($(g).find(".crop-box"),d,e,D.direction)}if(D.moveFlag){var b=a.clientX-D.x,c=a.clientY-D.y;b+=D.eleLeft,c+=D.eleTop;var f=$(g).find(".crop-box"),h=k(f,b,c,D.eleWidth,D.eleHeight,t,u);if(h!==!0)return;f.css({left:b,top:c}),i(b,c,D.eleWidth,D.eleHeight)}}function o(a){D.dragFlag&&(D.dragFlag=!1),D.moveFlag&&(D.moveFlag=!1)}b.imageSlide={value:100};var p=$(g).find(".cover"),q=$(g).find(".image-cover"),r=$(g).find(".crop-box");b.$watch("imageSlide.value",function(){t=parseFloat(s.imageSize.width)*parseFloat(b.imageSlide.value)/100,u=parseFloat(s.imageSize.height)*parseFloat(b.imageSlide.value/100),t<r.get(0).offsetLeft+r.get(0).offsetWidth&&(t=r.get(0).offsetLeft+r.get(0).offsetWidth,b.imageSlide.value=100*t/parseFloat(s.imageSize.width)),u<r.get(0).offsetTop+r.get(0).offsetHeight&&(u=r.get(0).offsetTop+r.get(0).offsetHeight,b.imageSlide.value=100*u/parseFloat(s.imageSize.height)),$(g).css({width:t,height:u}),p.css({"background-size":t+"px "+u+"px"}),q.css({"background-size":t+"px "+u+"px"}),i(r.get(0).offsetLeft,r.get(0).offsetTop,r.get(0).offsetWidth,r.get(0).offsetHeight)});var s=a.getActiveEle(),t=parseFloat(s.style.width),u=parseFloat(s.style.height),v=parseFloat(s.border.width),w=parseFloat(s.border["min-height"]);v>t&&(v=t),w>u&&(w=u),b.imageSlide.value=t/parseFloat(s.imageSize.width)*100;var x=0,y=0;"auto"!=s.style.left&&void 0!==s.style.left&&(x=parseInt(s.style.left)),"auto"!=s.style.top&&void 0!==s.style.top&&(y=parseInt(s.style.top));var z=$("#"+s.ID),A=z.parents(".ele-session").get(0),B=f.getLeft(z.get(0),A),C=f.getTop(z.get(0),A);$(g).css({width:t,height:u,left:parseInt(B)+x,top:parseInt(C)+y}),p.css({width:"100%",height:"100%",left:"0px",top:"0px","background-image":'url("'+s.url+'")',"background-size":t+"px "+u+"px"}),q.css({width:"100%",height:"100%",left:"0px",top:"0px","background-image":'url("'+s.url+'")',"background-size":t+"px "+u+"px"}),r.css({width:v,height:w,left:-x,top:-y});var D={dragFlag:!1,moveFlag:!1,eleWidth:0,eleHeight:0,eleLeft:0,eleTop:0,x:0,y:0};$(g).find(".handle").on("mousedown",function(a){D.dragFlag=!0;var b=$(g).find(".crop-box");D.eleWidth=b.get(0).offsetWidth,D.eleHeight=b.get(0).offsetHeight,D.eleLeft=parseFloat(b.get(0).offsetLeft),D.eleTop=parseFloat(b.get(0).offsetTop),D.direction=$(a.currentTarget).attr("direction"),D.x=a.clientX,D.y=a.clientY}),r.on("mousedown",function(a){if(!$(a.target).hasClass("handle")&&!$(a.target.parentNode).hasClass("handle")){D.moveFlag=!0;var b=$(g).find(".crop-box");D.eleWidth=b.get(0).offsetWidth,D.eleHeight=b.get(0).offsetHeight,D.eleLeft=parseFloat(b.get(0).offsetLeft),D.eleTop=parseFloat(b.get(0).offsetTop),D.x=a.clientX,D.y=a.clientY}}),b.crop=function(){var b={borderSize:{width:r.get(0).offsetWidth,height:r.get(0).offsetHeight},eleSize:{width:q.get(0).offsetWidth,height:q.get(0).offsetHeight},clip:q.css("clip"),position:{left:parseInt(z.get(0).offsetLeft),top:parseInt(z.get(0).offsetTop)}},f=a.updateCrop(b),g=e.getActivePage().value;f=d.conversionScaleForPhone(f),d.coverUpdateEle(g,f),c.updateEle(f)},$("body").on("mousemove",n),$("body").on("mouseup",o);var E=function(a){void 0!==$(a.target).parents("[image-crop]").get(0)||a.target==g||b.$apply(function(){b.crop()})};$("body").on("mousedown",E),a.setRemoveCallBack(function(){$("body").off("mousemove",n),$("body").off("mouseup",o),$("body").off("mousedown",E)})}}}]).factory("imageCropService",["eleMenuServices","$compile","$rootScope",function(a,b,c){var d={},e="",f="",g={},h={openCrop:function(g){d=g,e=$("#"+d.ID).css({opacity:0,"pointer-events":"none"}),a.hideDom(),f='<div image-crop class="crop-image-box"></div>',f=b(f)(c),e.parents(".ele-session").eq(0).append(f)},removePlugin:function(){f.remove(),f={},e.css({opacity:1,"pointer-events":"auto"}),e={},d={},g(),g={}},setRemoveCallBack:function(a){g=a},resetImage:function(a,b,c,d,e,f,g){function i(a,b,c,d,e){var f=angular.copy(e),g=f[1]-f[3],h=f[2]-f[0],i=d*c/g;a.css({width:i,height:"auto"});var j=d/i;f[1]=f[1]/j,f[3]=f[3]/j,f[0]=f[0]/j,f[2]=f[2]/j,g=f[1]-f[3],h=f[2]-f[0],a.css({clip:"rect("+f[0]+"px "+f[1]+"px "+f[2]+"px "+f[3]+"px )"});var k=parseInt(b.get(0).offsetHeight),l=(parseInt(a.get(0).offsetHeight),-f[0]);l+=(k-h)/2,a.css({top:l,left:-f[3]})}function j(a,b,c,d,e){var f=angular.copy(e),g=f[1]-f[3],h=f[2]-f[0],i=d*c/h;a.css({height:i,width:"auto"});var j=d/i;f[1]=f[1]/j,f[3]=f[3]/j,f[0]=f[0]/j,f[2]=f[2]/j,g=f[1]-f[3],h=f[2]-f[0],a.css({clip:"rect("+f[0]+"px "+f[1]+"px "+f[2]+"px "+f[3]+"px )"});var k=parseInt(b.get(0).offsetWidth),l=(parseInt(a.get(0).offsetWidth),-f[3]);l+=(k-g)/2,a.css({top:-f[0],left:l})}var k=$(a),l=k.find("> .ele-box"),m=l.find("> .ele"),n=h.parsingClip(g,e,f),o=n[1]-n[3],p=n[2]-n[0],q=o/p,r=l.get(0).offsetWidth,s=l.get(0).offsetHeight;if("contain"===b.backgroundSize)if(s>r){var t=r,u=t/q;s>=u?i(m,l,t,e,n):(u=s,j(m,l,u,f,n))}else{var u=s,t=u*q;r>=t?j(m,l,u,f,n):(t=r,i(m,l,t,e,n))}else if("cover"===b.backgroundSize)if(s>r){var u=s,t=u*q;r>=t?(t=r,i(m,l,t,e,n)):j(m,l,u,f,n)}else{var t=r,u=t/q;s>=u?(u=s,j(m,l,u,f,n)):i(m,l,t,e,n)}},parsingClip:function(a,b,c){if("auto"==a)return a=[0,b,c,0];a=a.substring(5,a.length-1),a=a.split(" ");for(var d=0;d<a.length;d++)a[d]=parseInt(a[d]);return a},updateCrop:function(a){var b=h.parsingClip(a.clip,a.eleSize.width,a.eleSize.height);d.border.width=a.borderSize.width,d.style.width=a.eleSize.width,d.border["min-height"]=a.borderSize.height,d.style.height=a.eleSize.height,d.style.clip="rect("+b[0]+"px "+b[1]+"px "+b[2]+"px "+b[3]+"px )",d.position.left=a.position.left+b[3],d.position.top=a.position.top+b[0],d.style.left=-b[3],d.style.top=-b[0];var c=angular.copy(d);return h.removePlugin(),c},getActiveEle:function(){return d}};return h}]),angular.module("myBuilderApp").run(["$templateCache",function(a){a.put("views/addSession/sessionList.html",'<perfect-scrollbar wheel-propagation="false" class="scroller session-preview-scroll" wheel-speed="5" use-both-wheel-axes="true"> <div class="tc-white-1 session-preview" flex-container="row" flex-column="12" flex-gutter="24"> <div flex-item="1"></div> <div flex-item="3" ng-repeat="rowData in sessionList"> <div class="session-preview-box z-depth-2" ng-click="addSession(rowData)" ng-style="{&quot;background-image&quot;:&quot;url(&quot;+rowData.preview+&quot;)&quot;}"></div> </div> <div flex-item="1"></div> </div> </perfect-scrollbar>'),a.put("views/builder/workSpace.html",'<div class="work-space"> <div class="edit-space-box" ng-controller="editorCtrl" style="background-image: url(\'images/point.png\')"> <div ng-controller="leftMenuCtrl"> <div ng-if="modelState==\'web\'"> <div ng-include="\'views/leftMenu/menuList.html\'"></div> <div class="menu-content"> <div ng-include="\'views/leftMenu/content.html\'"></div> </div> </div> <div ng-if="modelState==\'phone\'"> <div ng-include="\'views/leftMenu/appMenuList.html\'"></div> <div class="menu-content"> <div ng-include="\'views/leftMenu/appContent.html\'"></div> </div> </div> </div> <div class="session-limit" ng-show="modelState==\'web\'"></div> <perfect-scrollbar id="main-editor-scroll" class="scroller-page" wheel-propagation="true" wheel-speed="3" ng-if="modelState==\'web\'"> <div id="edit-space" class="edit-space" creator website-code="websiteData" right-click-menu-init drag-select-ele="web"> </div> </perfect-scrollbar> <perfect-scrollbar class="scroller-page phone" wheel-propagation="true" wheel-speed="3" ng-if="modelState==\'phone\'"> <div class="phone-box z-depth-2"> <div class="phone-top"> <img src="images/phone_top.png"> </div> <div class="phone-edit-space-box" style="background-image: url(\'images/point.png\')"> <perfect-scrollbar id="main-editor-scroll" class="scroller-page" wheel-propagation="false" wheel-speed="3"> <div id="phone-edit-space" class="edit-space phone" creator-phone phone-right-click-menu-init drag-select-ele="phone" website-code="websiteData"></div> </perfect-scrollbar> </div> <div class="phone-bottom"> <img src="images/phone_bottom.png"> </div> </div> </perfect-scrollbar> </div> </div>'),a.put("views/common/top_nav.html",'<div class="top-nav-bar-box"> <div class="top-nav-bar z-depth-1"> <div class="left-bar"> <div class="logo" style="background-image: url(\'images/logo.png\')"> </div> <div class="page-option-box"> <div class="page-option" page-setting-tool-modal="0.8"> <button class="btn btn--m btn--black btn--flat" lx-ripple ng-click="toggleMenu()" onmousedown="event.stopPropagation()"> <div class="text-box"> <span class="text"> <i class="mdi mdi-file-multiple"></i> {{websiteData.name}} </span> <span class="icon"> <ul> <li><i class="mdi mdi-chevron-down"></i></li> </ul> </span> </div> </button> <div class="tool-modal" drag-ele="default" handle="handle" ng-show="pageMenuShow" onmousedown="event.stopPropagation()"> <div class="title handle"> 页面列表 <button class="btn btn--xs btn--white btn--icon right-button" lx-ripple="" ng-click="toggleMenu()" onmousedown="event.stopPropagation()"><i class="mdi mdi-close"></i></button> </div> <div class="content"> <div class="page-list"> <div class="page-item z-depth-1" ng-repeat="page in allData" ng-class="{true:\'active\'}[page.ID==websiteData.ID]"> <i class="mdi mdi-drag"></i><span>{{page.name}}</span> <lx-button lx-color="white" lx-type="fab" lx-size="xs"><i class="mdi mdi-dots-horizontal"></i></lx-button> </div> </div> </div> <div class="bottom z-depth-1"> <lx-button lx-color="blue"><i class="mdi mdi-plus"></i> 新增页面</lx-button> </div> </div> </div> </div> <div class="preview-option"> <ul> <li lx-ripple="white" ng-click="selectModel(\'web\')" ng-class="{true:\'active\'}[modelState==\'web\']"><i class="mdi mdi-monitor"></i></li> <li lx-ripple="white" ng-click="selectModel(\'phone\')" ng-class="{true:\'active\'}[modelState==\'phone\']"><i class="mdi mdi-cellphone-iphone"></i></li> </ul> </div> </div> <div class="right-bar"> <ul> <li lx-ripple="white" ng-click="retreat()"><i class="mdi mdi-reply"></i> </li> <li lx-ripple="white" ng-click="forward()"><i class="mdi mdi-reply rotateY180"></i> </li> <li lx-ripple="white"><i class="mdi mdi-eye"></i> <div class="text">预览</div> </li> <li lx-ripple="white" ng-click="save()"><i class="mdi mdi-content-save"></i> <div class="text">保存</div> </li> <li lx-ripple="white"><i class="mdi mdi-earth"></i> <div class="text">发布</div> </li> </ul> </div> </div> </div> <div class="work-space-box" ui-view=""></div>'),a.put("views/eleResource/image.html",'<div class="resource-box" ng-controller="imageResourceCtrl"> <div class="line-sub-title-box"> <div class="line-sub-title"> {{activeEleList.name}} </div> </div> <div class="resource-content"> <div class="preview-ele-item image-col col-4" ng-repeat="ele in activeEleList.eleList" insert-ele="ele.data" insert-config="ele.config"> <div class="preview-ele-item-box z-depth-1 bg-white" style="height:80px" ng-style="{\'background-image\':\'url(\'+ele.preview+\')\'}"> </div> </div> </div> </div>'),a.put("views/eleResource/text.html",'<div class="resource-box" ng-controller="textResourceCtrl"> <div class="line-sub-title-box"> <div class="line-sub-title"> 标题 </div> </div> <div class="preview-ele-item normal" ng-repeat="ele in activeEleList.eleList" insert-ele="ele" insert-config="{}"> <div class="preview-ele-item-box empty-bg"> <div class="over-shadow"><i class="mdi mdi-checkbox-marked-circle"></i></div> <div class="preview-ele" create-thumbnail="ele" type="web" ele-type="ele" layout="normal"></div> </div> </div> </div>'),a.put("views/eleSetting/imageSlide.html",'<div class="swiper-container ele-setting-slide"> <div class="swiper-wrapper"> <div class="swiper-slide"> <img src="images/imageDesign/2.png"> </div> <div class="swiper-slide"> <img src="images/imageDesign/1.png"> </div> <div class="swiper-slide"> <img src="images/imageDesign/3.png"> </div> <div class="swiper-slide"> <img src="images/imageDesign/4.png"> </div> </div> <div class="swiper-button-prev"><i class="mdi mdi-chevron-left"></i></div> <div class="swiper-button-next"><i class="mdi mdi-chevron-right"></i></div> </div>'),a.put("views/imageLibrary/loading.html",'<div class="vertical-outer"> <div class="vertical-middle"> <div class="page-state-alert no-image"> <img class="loading-image" src="images/loading.gif"> </div> </div> </div>'),a.put("views/imageLibrary/main.html",'<div class="my-modal z-depth-2 image-library"> <div class="modal-title"> <div class="title">图片库</div> <div class="option"> <lx-icon class="z-depth-1" lx-id="help" lx-size="xs" lx-color="blue" lx-type="circled"></lx-icon> <lx-icon class="z-depth-1" ng-click="cancel()" lx-id="close" lx-size="xs" lx-color="blue" lx-type="circled"></lx-icon> </div> </div> <div class="modal-content"> <div class="option-box"> <div class="option-list"> <div class="option-item" ng-click="selectType(rowData)" ng-class="{true:\'active\'}[rowData == activeType]" ng-repeat="rowData in typeList" lx-ripple="grey-300"> {{rowData.name}} </div> </div> <div class="right-button"> <div class="radius-button z-depth-1" lx-ripple="white"> <i class="mdi mdi-cloud"></i> 上传图片 </div> </div> </div> <div class="option-box"> <div class="title"> 点击或拖拽上传图片到图片库中。支持JPEG、JPG和GIF格式的图片，单次不能上传超过10MB的图片。 </div> <div class="right-option"> <div class="item"> <div class="border"></div> <lx-dropdown> <lx-dropdown-toggle> <lx-button lx-color="white" class="z-depth-1">排序:A-Z</lx-button> </lx-dropdown-toggle> <lx-dropdown-menu class="hover-theme z-depth-1 image-library-sort"> <ul> <li><a class="dropdown-link"><span>A-Z</span></a></li> <li><a class="dropdown-link"><span>Z-A</span></a></li> <li><a class="dropdown-link"><span>最新</span></a></li> <li><a class="dropdown-link"><span>最旧</span></a></li> </ul> </lx-dropdown-menu> </lx-dropdown> </div> <div class="item"> <div class="border"></div> <lx-text-field lx-label="搜索" lx-allow-clear="true"> <input type="text" ng-model="vm.textFields.floating.company"> </lx-text-field> </div> <div class="item"> <lx-dropdown> <lx-dropdown-toggle> <lx-button lx-color="white" class="z-depth-1"><i class="mdi mdi-apps"></i></lx-button> </lx-dropdown-toggle> <lx-dropdown-menu class="hover-theme z-depth-1 image-library-display-mode"> <ul> <li><a class="dropdown-link"><i class="mdi mdi-apps"></i></a></li> <li><a class="dropdown-link"><i class="mdi mdi-view-list"></i></a></li> </ul> </lx-dropdown-menu> </lx-dropdown> </div> </div> </div> <div class="content-box"> <div class="list"> <perfect-scrollbar class="scroller-page" wheel-propagation="true" wheel-speed="5"> <div ng-repeat="rowData in categoryList" ng-class="{true:\'active\'}[activeCategory==rowData]" class="item" ng-click="selectCategory(rowData)" lx-ripple="white">{{rowData.name}}</div> </perfect-scrollbar> <div class="item add"><i class="mdi mdi-plus-circle-outline"></i> 创建分类</div> </div> <div class="content"> <div ng-show="imageListLoadingFlag==true" class="page-state-loading-box" ng-include="\'views/imageLibrary/loading.html\'"></div> <image-list max-select-size="maxSelectSize" selected-list="selectedList" list-data="imageList" ng-if="imageList.length!=0 && imageListLoadingFlag!=true"></image-list> <div ng-if="imageList.length==0 && imageListLoadingFlag!=true" class="page-state-alert-box" ng-include="\'views/imageLibrary/noImage.html\'"></div> </div> </div> </div> <div class="modal-foot"> <div class="right-button"> <div class="radius-button z-depth-1" ng-click="comfirm()" ng-class="{true:\'un-active\'}[selectedList.length==0]" lx-ripple="white"> 选择 </div> </div> </div> </div>'),a.put("views/imageLibrary/noImage.html",'<div class="vertical-outer"> <div class="vertical-middle"> <div class="page-state-alert no-image"> <i class="mdi mdi-camera icon"></i> <div class="intro"> <div class="title"> 添加图片 </div> <div class="text"> <span>点击上方相机或拖拽图片</span><br> <span>即可批量上传图片（或一次只上传一张）</span> </div> </div> </div> </div> </div>'),a.put("views/leftMenu/appContent.html",'<div class="menu-content-item hideEle z-depth-2" ng-controller="previewBoxCtrl" ng-class="{true:\'active\',false:\'unActive\'}[activeMenu==\'hideEle\']"> <div class="line"></div> <div class="main-box"> <div class="left-menu"> <perfect-scrollbar class="scroller-page" wheel-propagation="true" wheel-speed="5"> <div class="preview-item z-depth-1" ng-class="{true:\'active\',false:\'\'}[activeSession==session.ID]" ng-repeat="session in websiteData.sessionList" ng-click="selectLayers(session.ID)"> <div class="preview-session-box"> <div class="over-shadow"><i class="mdi mdi-checkbox-marked-circle"></i></div> <div class="preview-session phone" create-thumbnail="session" type="phone" ele-type="session"> </div> </div> <div class="preview-menu"> <i class="mdi mdi-crosshairs-gps" ng-click="locateEleForPhone(session,\'session\')"></i> <i class="mdi mdi-eye" ng-class="{true:\'active mdi-eye-off\',false:\'mdi-eye\'}[session.showState==false]" ng-click="toggleSession(session.ID,session.showState)"></i> </div> </div> </perfect-scrollbar> </div> <div class="right-content"> <div class="title"> <div class="text">元素列表</div> <div class="title-button"><lx-icon class="z-depth-1" lx-id="help" lx-size="xs" lx-color="blue" lx-type="circled"></lx-icon></div> <div class="title-button" ng-click="closeMenu();"><lx-icon class="z-depth-1" lx-id="close" lx-size="xs" lx-color="blue" lx-type="circled"></lx-icon></div> </div> <div class="content scroll"> <perfect-scrollbar class="scroller-page" wheel-propagation="true" wheel-speed="5"> <div class="preview-ele-item z-depth-1" ng-repeat="ele in eleList track by ele.ID"> <div class="preview-ele-item-box"> <div class="over-shadow"><i class="mdi mdi-checkbox-marked-circle"></i></div> <div class="preview-ele" create-thumbnail="ele" preview-height="80" type="phone" ele-type="ele"></div> </div> <div class="preview-menu"> <i class="mdi mdi-crosshairs-gps" ng-click="locateEleForPhone(ele,\'ele\')"></i> <i class="mdi" ng-class="{true:\'active mdi-eye-off\',false:\'mdi-eye\'}[ele.showState==false]" ng-click="toggleEle(ele.ID,ele.showState)"></i> </div> </div> </perfect-scrollbar> </div> </div> </div> </div>'),
a.put("views/leftMenu/appMenuList.html",'<div class="menu-list" ng-class="{true:\'active\',false:\'unActive\'}[activeMenu!=\'\']"> <div class="menu-item-box" ng-click="openMenu(\'hideEle\')"> <div class="menu-item z-depth-2 hideEle" ng-class="{true:\'active\',false:\'unActive\'}[activeMenu==\'hideEle\']"> <div class="icon"> <i class="mdi mdi-layers"></i> </div> <div class="text"> 元素列表 </div> </div> <div class="svg" ng-class="{true:\'active\',false:\'unActive\'}[activeMenu==\'hideEle\']"> <svg class="symbol-leftBarButtonEarMiddle ear ear-middle" width="71px" height="89px" viewbox="0 0 75 89" version="1.1" data-reactid=".0.0.5.1.$=1$=01$leftBar=20:0.0.$addPanelInfra=1addPanel.$selectedSvg"> <defs> <filter x="-50%" y="-50%" width="200%" height="200%" filterunits="objectBoundingBox" id="leftBarButtonEarMdShadow"> <feoffset dx="0" dy="0" in="SourceAlpha" result="shadowOffsetOuter1"></feoffset> <fegaussianblur stddeviation="3.581" in="shadowOffsetOuter1" result="shadowBlurOuter1"></fegaussianblur> <fecolormatrix values="0 0 0 0 0.0862745098   0 0 0 0 0.176470588   0 0 0 0 0.239215686  0 0 0 0.266 0" in="shadowBlurOuter1" type="matrix" result="shadowMatrixOuter1"></fecolormatrix> <femerge> <femergenode in="SourceGraphic"></femergenode> </femerge> </filter> </defs> <path d="M66.998,3 C65.464,15.164 58.341,19.407 48.79,19.698 C48.462,19.687 30.836,19.685 30.836,19.685 L30.836,19.694 C17.657,19.789 6.999,30.783 6.999,43.955 C6.999,57.187 17.751,67.664 31.011,67.664 C26.69,67.664 45.65,67.707 45.65,67.707 C54.7,68.18 65.249,71.451 66.998,87.003 L66.998,3 L66.998,3 Z" fill="#3899EC" filter="url(#leftBarButtonEarMdShadow)"></path> </svg> </div> </div> </div>'),a.put("views/leftMenu/content.html",'<div class="menu-content-item hideEle z-depth-2" ng-controller="previewBoxCtrl" ng-class="{true:\'active\',false:\'unActive\'}[activeMenu==\'hideEle\']"> <div class="line"></div> <div class="main-box"> <div class="left-menu"> <perfect-scrollbar class="scroller-page" wheel-propagation="true" wheel-speed="5"> <div class="preview-item z-depth-1" ng-class="{true:\'active\',false:\'\'}[activeSession==session.ID]" ng-repeat="session in websiteData.sessionList" ng-click="selectLayers(session.ID)"> <div class="preview-session-box"> <div class="over-shadow"><i class="mdi mdi-checkbox-marked-circle"></i></div> <div class="preview-session web" create-thumbnail="session" type="web" ele-type="session"> </div> </div> <div class="preview-menu"> <i ng-click="locateEleForWeb(session,\'session\')" class="mdi mdi-crosshairs-gps"></i> </div> </div> </perfect-scrollbar> </div> <div class="right-content"> <div class="title"> <div class="text">元素列表</div> <div class="title-button"><lx-icon class="z-depth-1" lx-id="help" lx-size="xs" lx-color="blue" lx-type="circled"></lx-icon></div> <div class="title-button" ng-click="closeMenu();"><lx-icon class="z-depth-1" lx-id="close" lx-size="xs" lx-color="blue" lx-type="circled"></lx-icon></div> </div> <div class="content scroll"> <perfect-scrollbar class="scroller-page" wheel-propagation="true" wheel-speed="5"> <div class="preview-ele-item z-depth-1" ng-repeat="ele in eleList track by ele.ID"> <div class="preview-ele-item-box"> <div class="over-shadow"><i class="mdi mdi-checkbox-marked-circle"></i></div> <div class="preview-ele" create-thumbnail="ele" type="web" preview-height="80" ele-type="ele"></div> </div> <div class="preview-menu"> <i ng-click="locateEleForWeb(ele,\'ele\')" class="mdi mdi-crosshairs-gps"></i> </div> </div> </perfect-scrollbar> </div> </div> </div> </div> <div class="menu-content-item add z-depth-2" ng-class="{true:\'active\',false:\'unActive\'}[activeMenu==\'add\']" ng-controller="insertEleCtrl"> <div class="line"></div> <div class="main-box"> <div class="left-menu"> <perfect-scrollbar class="scroller-page" wheel-propagation="true" wheel-speed="5"> <ul class="text-list"> <li class="text-item" ng-repeat="ele in eleList"> <div class="text" ng-class="{true:\'active\'}[activeEle.ID==ele.ID]" ng-click="selectEleType(ele)">{{ele.name}}</div> </li> </ul> </perfect-scrollbar> </div> <div class="right-content"> <div class="title"> <div class="text">{{activeEle.name}}</div> <div class="title-button"><lx-icon class="z-depth-1" lx-id="help" lx-size="xs" lx-color="blue" lx-type="circled"></lx-icon></div> <div class="title-button" ng-click="closeMenu();"><lx-icon class="z-depth-1" lx-id="close" lx-size="xs" lx-color="blue" lx-type="circled"></lx-icon></div> </div> <div class="content scroll"> <perfect-scrollbar class="scroller-page" wheel-propagation="true" wheel-speed="5"> <div ng-include="activeEle.template"></div> </perfect-scrollbar> </div> </div> </div> </div> <div class="menu-content-item app z-depth-2" ng-class="{true:\'active\',false:\'unActive\'}[activeMenu==\'app\']"> <div class="line"></div> <div class="main-box"> <div class="title"> <div class="text">应用</div> <div class="title-button"><lx-icon class="z-depth-1" lx-id="help" lx-size="xs" lx-color="blue" lx-type="circled"></lx-icon></div> <div class="title-button" ng-click="closeMenu();"><lx-icon class="z-depth-1" lx-id="close" lx-size="xs" lx-color="blue" lx-type="circled"></lx-icon></div> </div> </div> </div> <div class="menu-content-item upload z-depth-2" ng-class="{true:\'active\',false:\'unActive\'}[activeMenu==\'upload\']"> <div class="line"></div> <div class="main-box"> <div class="title"> <div class="text">我的文件</div> <div class="title-button"><lx-icon class="z-depth-1" lx-id="help" lx-size="xs" lx-color="blue" lx-type="circled"></lx-icon></div> <div class="title-button" ng-click="closeMenu();"><lx-icon class="z-depth-1" lx-id="close" lx-size="xs" lx-color="blue" lx-type="circled"></lx-icon></div> </div> </div> </div>'),a.put("views/leftMenu/menuList.html",'<div class="menu-list" ng-class="{true:\'active\',false:\'unActive\'}[activeMenu!=\'\']"> <div class="menu-item-box" ng-click="openMenu(\'add\')"> <div class="menu-item z-depth-2 add" ng-class="{true:\'active\',false:\'unActive\'}[activeMenu==\'add\']"> <div class="icon"> <i class="mdi mdi-plus-circle"></i> </div> <div class="text"> 添加元素 </div> </div> <div class="svg mid" ng-class="{true:\'active\',false:\'unActive\'}[activeMenu==\'add\']"> <svg class="symbol-leftBarButtonEarMiddle ear ear-middle" width="71px" height="89px" viewbox="0 0 75 89" version="1.1" data-reactid=".0.0.5.1.$=1$=01$leftBar=20:0.0.$addPanelInfra=1addPanel.$selectedSvg"> <defs> <filter x="-50%" y="-50%" width="200%" height="200%" filterunits="objectBoundingBox" id="leftBarButtonEarMdShadow"> <feoffset dx="0" dy="0" in="SourceAlpha" result="shadowOffsetOuter1"></feoffset> <fegaussianblur stddeviation="3.581" in="shadowOffsetOuter1" result="shadowBlurOuter1"></fegaussianblur> <fecolormatrix values="0 0 0 0 0.0862745098   0 0 0 0 0.176470588   0 0 0 0 0.239215686  0 0 0 0.266 0" in="shadowBlurOuter1" type="matrix" result="shadowMatrixOuter1"></fecolormatrix> <femerge> <femergenode in="SourceGraphic"></femergenode> </femerge> </filter> </defs> <path d="M66.998,3 C65.464,15.164 58.341,19.407 48.79,19.698 C48.462,19.687 30.836,19.685 30.836,19.685 L30.836,19.694 C17.657,19.789 6.999,30.783 6.999,43.955 C6.999,57.187 17.751,67.664 31.011,67.664 C26.69,67.664 45.65,67.707 45.65,67.707 C54.7,68.18 65.249,71.451 66.998,87.003 L66.998,3 L66.998,3 Z" fill="#4FC1E9" filter="url(#leftBarButtonEarMdShadow)"></path> </svg> </div> </div> <div class="menu-item-box" ng-click="openMenu(\'hideEle\')"> <div class="menu-item z-depth-2 hideEle" ng-class="{true:\'active\',false:\'unActive\'}[activeMenu==\'hideEle\']"> <div class="icon"> <i class="mdi mdi-layers"></i> </div> <div class="text"> 元素列表 </div> </div> <div class="svg" ng-class="{true:\'active\',false:\'unActive\'}[activeMenu==\'hideEle\']"> <svg class="symbol-leftBarButtonEarMiddle ear ear-middle" width="71px" height="89px" viewbox="0 0 75 89" version="1.1" data-reactid=".0.0.5.1.$=1$=01$leftBar=20:0.0.$addPanelInfra=1addPanel.$selectedSvg"> <defs> <filter x="-50%" y="-50%" width="200%" height="200%" filterunits="objectBoundingBox" id="leftBarButtonEarMdShadow"> <feoffset dx="0" dy="0" in="SourceAlpha" result="shadowOffsetOuter1"></feoffset> <fegaussianblur stddeviation="3.581" in="shadowOffsetOuter1" result="shadowBlurOuter1"></fegaussianblur> <fecolormatrix values="0 0 0 0 0.0862745098   0 0 0 0 0.176470588   0 0 0 0 0.239215686  0 0 0 0.266 0" in="shadowBlurOuter1" type="matrix" result="shadowMatrixOuter1"></fecolormatrix> <femerge> <femergenode in="SourceGraphic"></femergenode> </femerge> </filter> </defs> <path d="M66.998,3 C65.464,15.164 58.341,19.407 48.79,19.698 C48.462,19.687 30.836,19.685 30.836,19.685 L30.836,19.694 C17.657,19.789 6.999,30.783 6.999,43.955 C6.999,57.187 17.751,67.664 31.011,67.664 C26.69,67.664 45.65,67.707 45.65,67.707 C54.7,68.18 65.249,71.451 66.998,87.003 L66.998,3 L66.998,3 Z" fill="#3899EC" filter="url(#leftBarButtonEarMdShadow)"></path> </svg> </div> </div> <div class="menu-item-box" ng-click="openMenu(\'app\')"> <div class="menu-item z-depth-2 app" ng-class="{true:\'active\',false:\'unActive\'}[activeMenu==\'app\']"> <div class="icon"> <i class="mdi mdi-store"></i> </div> <div class="text"> 应用 </div> </div> <div class="svg mid" ng-class="{true:\'active\',false:\'unActive\'}[activeMenu==\'app\']"> <svg class="symbol-leftBarButtonEarMiddle ear ear-middle" width="71px" height="89px" viewbox="0 0 75 89" version="1.1" data-reactid=".0.0.5.1.$=1$=01$leftBar=20:0.0.$addPanelInfra=1addPanel.$selectedSvg"> <defs> <filter x="-50%" y="-50%" width="200%" height="200%" filterunits="objectBoundingBox" id="leftBarButtonEarMdShadow"> <feoffset dx="0" dy="0" in="SourceAlpha" result="shadowOffsetOuter1"></feoffset> <fegaussianblur stddeviation="3.581" in="shadowOffsetOuter1" result="shadowBlurOuter1"></fegaussianblur> <fecolormatrix values="0 0 0 0 0.0862745098   0 0 0 0 0.176470588   0 0 0 0 0.239215686  0 0 0 0.266 0" in="shadowBlurOuter1" type="matrix" result="shadowMatrixOuter1"></fecolormatrix> <femerge> <femergenode in="SourceGraphic"></femergenode> </femerge> </filter> </defs> <path d="M66.998,3 C65.464,15.164 58.341,19.407 48.79,19.698 C48.462,19.687 30.836,19.685 30.836,19.685 L30.836,19.694 C17.657,19.789 6.999,30.783 6.999,43.955 C6.999,57.187 17.751,67.664 31.011,67.664 C26.69,67.664 45.65,67.707 45.65,67.707 C54.7,68.18 65.249,71.451 66.998,87.003 L66.998,3 L66.998,3 Z" fill="#D0427C" filter="url(#leftBarButtonEarMdShadow)"></path> </svg> </div> </div> <div class="menu-item-box" ng-click="openMenu(\'upload\')"> <div class="menu-item z-depth-2 upload" ng-class="{true:\'active\',false:\'unActive\'}[activeMenu==\'upload\']"> <div class="icon"> <i class="mdi mdi-cloud-upload"></i> </div> <div class="text"> 我的文件 </div> </div> <div class="svg mid" ng-class="{true:\'active\',false:\'unActive\'}[activeMenu==\'upload\']"> <svg class="symbol-leftBarButtonEarMiddle ear ear-middle" width="71px" height="89px" viewbox="0 0 75 89" version="1.1" data-reactid=".0.0.5.1.$=1$=01$leftBar=20:0.0.$addPanelInfra=1addPanel.$selectedSvg"> <defs> <filter x="-50%" y="-50%" width="200%" height="200%" filterunits="objectBoundingBox" id="leftBarButtonEarMdShadow"> <feoffset dx="0" dy="0" in="SourceAlpha" result="shadowOffsetOuter1"></feoffset> <fegaussianblur stddeviation="3.581" in="shadowOffsetOuter1" result="shadowBlurOuter1"></fegaussianblur> <fecolormatrix values="0 0 0 0 0.0862745098   0 0 0 0 0.176470588   0 0 0 0 0.239215686  0 0 0 0.266 0" in="shadowBlurOuter1" type="matrix" result="shadowMatrixOuter1"></fecolormatrix> <femerge> <femergenode in="SourceGraphic"></femergenode> </femerge> </filter> </defs> <path d="M66.998,3 C65.464,15.164 58.341,19.407 48.79,19.698 C48.462,19.687 30.836,19.685 30.836,19.685 L30.836,19.694 C17.657,19.789 6.999,30.783 6.999,43.955 C6.999,57.187 17.751,67.664 31.011,67.664 C26.69,67.664 45.65,67.707 45.65,67.707 C54.7,68.18 65.249,71.451 66.998,87.003 L66.998,3 L66.998,3 Z" fill="#FA7C33" filter="url(#leftBarButtonEarMdShadow)"></path> </svg> </div> </div> </div>')}]);